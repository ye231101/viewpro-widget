/*! For license information please see viewpro-widget.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("ViewProWidget",[],t):"object"==typeof exports?exports.ViewProWidget=t():e.ViewProWidget=t()}(this,()=>(()=>{"use strict";var e={56(e,t,n){e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72(e){var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var o={},a=[],s=0;s<e.length;s++){var c=e[s],l=i.base?c[0]+i.base:c[0],u=o[l]||0,d="".concat(l," ").concat(u);o[l]=u+1;var h=n(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=r(p,i);i.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}a.push(d)}return a}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=i(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<o.length;a++){var s=n(o[a]);t[s].references--}for(var c=i(e,r),l=0;l<o.length;l++){var u=n(o[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=c}}},113(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},159(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},221(e,t,n){var i=n(540);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var a={d:{f:o,r:function(){throw Error(r(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},s=Symbol.for("react.portal"),c=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(e,t){return"font"===e?"":"string"==typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=c.T,n=a.p;try{if(c.T=null,a.p=2,e)return e()}finally{c.T=t,a.p=n,a.d.f()}},t.preconnect=function(e,t){"string"==typeof e&&(t=t?"string"==typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:null,a.d.C(e,t))},t.prefetchDNS=function(e){"string"==typeof e&&a.d.D(e)},t.preinit=function(e,t){if("string"==typeof e&&t&&"string"==typeof t.as){var n=t.as,i=l(n,t.crossOrigin),r="string"==typeof t.integrity?t.integrity:void 0,o="string"==typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?a.d.S(e,"string"==typeof t.precedence?t.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:o}):"script"===n&&a.d.X(e,{crossOrigin:i,integrity:r,fetchPriority:o,nonce:"string"==typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"==typeof e)if("object"==typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=l(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:n,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0})}}else null==t&&a.d.M(e)},t.preload=function(e,t){if("string"==typeof e&&"object"==typeof t&&null!==t&&"string"==typeof t.as){var n=t.as,i=l(n,t.crossOrigin);a.d.L(e,n,{crossOrigin:i,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0,type:"string"==typeof t.type?t.type:void 0,fetchPriority:"string"==typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"==typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"==typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"==typeof t.imageSizes?t.imageSizes:void 0,media:"string"==typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"==typeof e)if(t){var n=l(t.as,t.crossOrigin);a.d.m(e,{as:"string"==typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"==typeof t.integrity?t.integrity:void 0})}else a.d.m(e)},t.requestFormReset=function(e){a.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return c.H.useFormState(e,t,n)},t.useFormStatus=function(){return c.H.useHostTransitionStatus()},t.version="19.2.3"},247(e,t,n){var i=n(982),r=n(540),o=n(961);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function l(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function u(e){if(s(e)!==e)throw Error(a(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),k=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),E=Symbol.for("react.lazy");Symbol.for("react.scope");var P=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var R=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var x=Symbol.iterator;function _(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=x&&e[x]||e["@@iterator"])?e:null}var O=Symbol.for("react.client.reference");function I(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===O?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case S:return"Suspense";case T:return"SuspenseList";case P:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case m:return"Portal";case k:return e.displayName||"Context";case b:return(e._context.displayName||"Context")+".Consumer";case w:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:I(e.type)||"Memo";case E:t=e._payload,e=e._init;try{return I(e(t))}catch(e){}}return null}var N=Array.isArray,A=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},M=[],U=-1;function j(e){return{current:e}}function F(e){0>U||(e.current=M[U],M[U]=null,U--)}function B(e,t){U++,M[U]=e.current,e.current=t}var z,q,V=j(null),H=j(null),W=j(null),K=j(null);function G(e,t){switch(B(W,t),B(H,e),B(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?gd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=vd(t=gd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}F(V),B(V,e)}function J(){F(V),F(H),F(W)}function $(e){null!==e.memoizedState&&B(K,e);var t=V.current,n=vd(t,e.type);t!==n&&(B(H,e),B(V,n))}function Q(e){H.current===e&&(F(V),F(H)),K.current===e&&(F(K),lh._currentValue=L)}function Y(e){if(void 0===z)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);z=t&&t[1]||"",q=-1<e.stack.indexOf("\n    at")?" (<anonymous>)":-1<e.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+z+e+q}var X=!1;function Z(e,t){if(!e||X)return"";X=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(e){var i=e}Reflect.construct(e,[],n)}else{try{n.call()}catch(e){i=e}e.call(n.prototype)}}else{try{throw Error()}catch(e){i=e}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(e){if(e&&i&&"string"==typeof e.stack)return[e.stack,i.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=i.DetermineComponentFrameRoot(),a=o[0],s=o[1];if(a&&s){var c=a.split("\n"),l=s.split("\n");for(r=i=0;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;for(;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;if(i===c.length||r===l.length)for(i=c.length-1,r=l.length-1;1<=i&&0<=r&&c[i]!==l[r];)r--;for(;1<=i&&0<=r;i--,r--)if(c[i]!==l[r]){if(1!==i||1!==r)do{if(i--,0>--r||c[i]!==l[r]){var u="\n"+c[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=i&&0<=r);break}}}finally{X=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Y(n):""}function ee(e,t){switch(e.tag){case 26:case 27:case 5:return Y(e.type);case 16:return Y("Lazy");case 13:return e.child!==t&&null!==t?Y("Suspense Fallback"):Y("Suspense");case 19:return Y("SuspenseList");case 0:case 15:return Z(e.type,!1);case 11:return Z(e.type.render,!1);case 1:return Z(e.type,!0);case 31:return Y("Activity");default:return""}}function te(e){try{var t="",n=null;do{t+=ee(e,n),n=e,e=e.return}while(e);return t}catch(e){return"\nError generating stack: "+e.message+"\n"+e.stack}}var ne=Object.prototype.hasOwnProperty,ie=i.unstable_scheduleCallback,re=i.unstable_cancelCallback,oe=i.unstable_shouldYield,ae=i.unstable_requestPaint,se=i.unstable_now,ce=i.unstable_getCurrentPriorityLevel,le=i.unstable_ImmediatePriority,ue=i.unstable_UserBlockingPriority,de=i.unstable_NormalPriority,he=i.unstable_LowPriority,pe=i.unstable_IdlePriority,fe=i.log,me=i.unstable_setDisableYieldValue,ge=null,ve=null;function ye(e){if("function"==typeof fe&&me(e),ve&&"function"==typeof ve.setStrictMode)try{ve.setStrictMode(ge,e)}catch(e){}}var be=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ke(e)/we|0)|0},ke=Math.log,we=Math.LN2,Se=256,Te=262144,Ce=4194304;function Ee(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Pe(e,t,n){var i=e.pendingLanes;if(0===i)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes;e=e.warmLanes;var s=134217727&i;return 0!==s?0!==(i=s&~o)?r=Ee(i):0!==(a&=s)?r=Ee(a):n||0!==(n=s&~e)&&(r=Ee(n)):0!==(s=i&~o)?r=Ee(s):0!==a?r=Ee(a):n||0!==(n=i&~e)&&(r=Ee(n)),0===r?0:0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(n=t&-t)||32===o&&4194048&n)?t:r}function Re(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function xe(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function _e(){var e=Ce;return!(62914560&(Ce<<=1))&&(Ce=4194304),e}function Oe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ie(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ne(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-be(t);e.entangledLanes|=t,e.entanglements[i]=1073741824|e.entanglements[i]|261930&n}function Ae(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-be(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}function De(e,t){var n=t&-t;return 0!==((n=42&n?1:Le(n))&(e.suspendedLanes|t))?0:n}function Le(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Me(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Ue(){var e=D.p;return 0!==e?e:void 0===(e=window.event)?32:Th(e.type)}function je(e,t){var n=D.p;try{return D.p=e,t()}finally{D.p=n}}var Fe=Math.random().toString(36).slice(2),Be="__reactFiber$"+Fe,ze="__reactProps$"+Fe,qe="__reactContainer$"+Fe,Ve="__reactEvents$"+Fe,He="__reactListeners$"+Fe,We="__reactHandles$"+Fe,Ke="__reactResources$"+Fe,Ge="__reactMarker$"+Fe;function Je(e){delete e[Be],delete e[ze],delete e[Ve],delete e[He],delete e[We]}function $e(e){var t=e[Be];if(t)return t;for(var n=e.parentNode;n;){if(t=n[qe]||n[Be]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Ld(e);null!==e;){if(n=e[Be])return n;e=Ld(e)}return t}n=(e=n).parentNode}return null}function Qe(e){if(e=e[Be]||e[qe]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Ye(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function Xe(e){var t=e[Ke];return t||(t=e[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ze(e){e[Ge]=!0}var et=new Set,tt={};function nt(e,t){it(e,t),it(e+"Capture",t)}function it(e,t){for(tt[e]=t,e=0;e<t.length;e++)et.add(t[e])}var rt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ot={},at={};function st(e,t,n){if(r=t,ne.call(at,r)||!ne.call(ot,r)&&(rt.test(r)?at[r]=!0:(ot[r]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var i=t.toLowerCase().slice(0,5);if("data-"!==i&&"aria-"!==i)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var r}function ct(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function lt(e,t,n,i){if(null===i)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+i)}}function ut(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function dt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){if(!e._valueTracker){var t=dt(e)?"checked":"value";e._valueTracker=function(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&void 0!==i&&"function"==typeof i.get&&"function"==typeof i.set){var r=i.get,o=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function pt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=dt(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function ft(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var mt=/[\n"\\]/g;function gt(e){return e.replace(mt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,n,i,r,o,a,s){e.name="",null!=a&&"function"!=typeof a&&"symbol"!=typeof a&&"boolean"!=typeof a?e.type=a:e.removeAttribute("type"),null!=t?"number"===a?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ut(t)):e.value!==""+ut(t)&&(e.value=""+ut(t)):"submit"!==a&&"reset"!==a||e.removeAttribute("value"),null!=t?bt(e,a,ut(t)):null!=n?bt(e,a,ut(n)):null!=i&&e.removeAttribute("value"),null==r&&null!=o&&(e.defaultChecked=!!o),null!=r&&(e.checked=r&&"function"!=typeof r&&"symbol"!=typeof r),null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.name=""+ut(s):e.removeAttribute("name")}function yt(e,t,n,i,r,o,a,s){if(null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.type=o),null!=t||null!=n){if(("submit"===o||"reset"===o)&&null==t)return void ht(e);n=null!=n?""+ut(n):"",t=null!=t?""+ut(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}i="function"!=typeof(i=null!=i?i:r)&&"symbol"!=typeof i&&!!i,e.checked=s?e.checked:!!i,e.defaultChecked=!!i,null!=a&&"function"!=typeof a&&"symbol"!=typeof a&&"boolean"!=typeof a&&(e.name=a),ht(e)}function bt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function kt(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+ut(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function wt(e,t,n){null==t||((t=""+ut(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ut(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function St(e,t,n,i){if(null==t){if(null!=i){if(null!=n)throw Error(a(92));if(N(i)){if(1<i.length)throw Error(a(93));i=i[0]}n=i}null==n&&(n=""),t=n}n=ut(t),e.defaultValue=n,(i=e.textContent)===n&&""!==i&&null!==i&&(e.value=i),ht(e)}function Tt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Ct=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Et(e,t,n){var i=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?i?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":i?e.setProperty(t,n):"number"!=typeof n||0===n||Ct.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Pt(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var i in n)!n.hasOwnProperty(i)||null!=t&&t.hasOwnProperty(i)||(0===i.indexOf("--")?e.setProperty(i,""):"float"===i?e.cssFloat="":e[i]="");for(var r in t)i=t[r],t.hasOwnProperty(r)&&n[r]!==i&&Et(e,r,i)}else for(var o in t)t.hasOwnProperty(o)&&Et(e,o,t[o])}function Rt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_t=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ot(e){return _t.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function It(){}var Nt=null;function At(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Dt=null,Lt=null;function Mt(e){var t=Qe(e);if(t&&(e=t.stateNode)){var n=e[ze]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+gt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=i[ze]||null;if(!r)throw Error(a(90));vt(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)(i=n[t]).form===e.form&&pt(i)}break e;case"textarea":wt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&kt(e,!!n.multiple,t,!1)}}}var Ut=!1;function jt(e,t,n){if(Ut)return e(t,n);Ut=!0;try{return e(t)}finally{if(Ut=!1,(null!==Dt||null!==Lt)&&(Xl(),Dt&&(t=Dt,e=Lt,Lt=Dt=null,Mt(t),e)))for(t=0;t<e.length;t++)Mt(e[t])}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var i=n[ze]||null;if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Bt=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),zt=!1;if(Bt)try{var qt={};Object.defineProperty(qt,"passive",{get:function(){zt=!0}}),window.addEventListener("test",qt,qt),window.removeEventListener("test",qt,qt)}catch(e){zt=!1}var Vt=null,Ht=null,Wt=null;function Kt(){if(Wt)return Wt;var e,t,n=Ht,i=n.length,r="value"in Vt?Vt.value:Vt.textContent,o=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[o-t];t++);return Wt=r.slice(e,1<t?1-t:void 0)}function Gt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Jt(){return!0}function $t(){return!1}function Qt(e){function t(t,n,i,r,o){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Jt:$t,this.isPropagationStopped=$t,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Jt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Jt)},persist:function(){},isPersistent:Jt}),t}var Yt,Xt,Zt,en={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tn=Qt(en),nn=h({},en,{view:0,detail:0}),rn=Qt(nn),on=h({},nn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zt&&(Zt&&"mousemove"===e.type?(Yt=e.screenX-Zt.screenX,Xt=e.screenY-Zt.screenY):Xt=Yt=0,Zt=e),Yt)},movementY:function(e){return"movementY"in e?e.movementY:Xt}}),an=Qt(on),sn=Qt(h({},on,{dataTransfer:0})),cn=Qt(h({},nn,{relatedTarget:0})),ln=Qt(h({},en,{animationName:0,elapsedTime:0,pseudoElement:0})),un=Qt(h({},en,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),dn=Qt(h({},en,{data:0})),hn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=fn[e])&&!!t[e]}function gn(){return mn}var vn=Qt(h({},nn,{key:function(e){if(e.key){var t=hn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Gt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?pn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gn,charCode:function(e){return"keypress"===e.type?Gt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Gt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),yn=Qt(h({},on,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),bn=Qt(h({},nn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gn})),kn=Qt(h({},en,{propertyName:0,elapsedTime:0,pseudoElement:0})),wn=Qt(h({},on,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Sn=Qt(h({},en,{newState:0,oldState:0})),Tn=[9,13,27,32],Cn=Bt&&"CompositionEvent"in window,En=null;Bt&&"documentMode"in document&&(En=document.documentMode);var Pn=Bt&&"TextEvent"in window&&!En,Rn=Bt&&(!Cn||En&&8<En&&11>=En),xn=String.fromCharCode(32),_n=!1;function On(e,t){switch(e){case"keyup":return-1!==Tn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function In(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Nn=!1,An={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!An[e.type]:"textarea"===t}function Ln(e,t,n,i){Dt?Lt?Lt.push(i):Lt=[i]:Dt=i,0<(t=nd(t,"onChange")).length&&(n=new tn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Mn=null,Un=null;function jn(e){Ju(e,0)}function Fn(e){if(pt(Ye(e)))return e}function Bn(e,t){if("change"===e)return t}var zn=!1;if(Bt){var qn;if(Bt){var Vn="oninput"in document;if(!Vn){var Hn=document.createElement("div");Hn.setAttribute("oninput","return;"),Vn="function"==typeof Hn.oninput}qn=Vn}else qn=!1;zn=qn&&(!document.documentMode||9<document.documentMode)}function Wn(){Mn&&(Mn.detachEvent("onpropertychange",Kn),Un=Mn=null)}function Kn(e){if("value"===e.propertyName&&Fn(Un)){var t=[];Ln(t,Un,e,At(e)),jt(jn,t)}}function Gn(e,t,n){"focusin"===e?(Wn(),Un=n,(Mn=t).attachEvent("onpropertychange",Kn)):"focusout"===e&&Wn()}function Jn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(Un)}function $n(e,t){if("click"===e)return Fn(t)}function Qn(e,t){if("input"===e||"change"===e)return Fn(t)}var Yn="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function Xn(e,t){if(Yn(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!ne.call(t,r)||!Yn(e[r],t[r]))return!1}return!0}function Zn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ei(e,t){var n,i=Zn(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Zn(i)}}function ti(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ti(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ni(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function ii(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ri=Bt&&"documentMode"in document&&11>=document.documentMode,oi=null,ai=null,si=null,ci=!1;function li(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ci||null==oi||oi!==ft(i)||(i="selectionStart"in(i=oi)&&ii(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},si&&Xn(si,i)||(si=i,0<(i=nd(ai,"onSelect")).length&&(t=new tn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=oi)))}function ui(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var di={animationend:ui("Animation","AnimationEnd"),animationiteration:ui("Animation","AnimationIteration"),animationstart:ui("Animation","AnimationStart"),transitionrun:ui("Transition","TransitionRun"),transitionstart:ui("Transition","TransitionStart"),transitioncancel:ui("Transition","TransitionCancel"),transitionend:ui("Transition","TransitionEnd")},hi={},pi={};function fi(e){if(hi[e])return hi[e];if(!di[e])return e;var t,n=di[e];for(t in n)if(n.hasOwnProperty(t)&&t in pi)return hi[e]=n[t];return e}Bt&&(pi=document.createElement("div").style,"AnimationEvent"in window||(delete di.animationend.animation,delete di.animationiteration.animation,delete di.animationstart.animation),"TransitionEvent"in window||delete di.transitionend.transition);var mi=fi("animationend"),gi=fi("animationiteration"),vi=fi("animationstart"),yi=fi("transitionrun"),bi=fi("transitionstart"),ki=fi("transitioncancel"),wi=fi("transitionend"),Si=new Map,Ti="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ci(e,t){Si.set(e,t),nt(t,[e])}Ti.push("scrollEnd");var Ei="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Pi=[],Ri=0,xi=0;function _i(){for(var e=Ri,t=xi=Ri=0;t<e;){var n=Pi[t];Pi[t++]=null;var i=Pi[t];Pi[t++]=null;var r=Pi[t];Pi[t++]=null;var o=Pi[t];if(Pi[t++]=null,null!==i&&null!==r){var a=i.pending;null===a?r.next=r:(r.next=a.next,a.next=r),i.pending=r}0!==o&&Ai(n,r,o)}}function Oi(e,t,n,i){Pi[Ri++]=e,Pi[Ri++]=t,Pi[Ri++]=n,Pi[Ri++]=i,xi|=i,e.lanes|=i,null!==(e=e.alternate)&&(e.lanes|=i)}function Ii(e,t,n,i){return Oi(e,t,n,i),Di(e)}function Ni(e,t){return Oi(e,null,null,t),Di(e)}function Ai(e,t,n){e.lanes|=n;var i=e.alternate;null!==i&&(i.lanes|=n);for(var r=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(i=o.alternate)&&(i.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(r=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,r&&null!==t&&(r=31-be(n),null===(i=(e=o.hiddenUpdates)[r])?e[r]=[t]:i.push(t),t.lane=536870912|n),o):null}function Di(e){if(50<Vl)throw Vl=0,Hl=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Li={};function Mi(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ui(e,t,n,i){return new Mi(e,t,n,i)}function ji(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fi(e,t){var n=e.alternate;return null===n?((n=Ui(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Bi(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function zi(e,t,n,i,r,o){var s=0;if(i=e,"function"==typeof e)ji(e)&&(s=1);else if("string"==typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case P:return(e=Ui(31,n,t,r)).elementType=P,e.lanes=o,e;case g:return qi(n.children,r,o,t);case v:s=8,r|=24;break;case y:return(e=Ui(12,n,t,2|r)).elementType=y,e.lanes=o,e;case S:return(e=Ui(13,n,t,r)).elementType=S,e.lanes=o,e;case T:return(e=Ui(19,n,t,r)).elementType=T,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case k:s=10;break e;case b:s=9;break e;case w:s=11;break e;case C:s=14;break e;case E:s=16,i=null;break e}s=29,n=Error(a(130,null===e?"null":typeof e,"")),i=null}return(t=Ui(s,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function qi(e,t,n,i){return(e=Ui(7,e,i,t)).lanes=n,e}function Vi(e,t,n){return(e=Ui(6,e,null,t)).lanes=n,e}function Hi(e){var t=Ui(18,null,null,0);return t.stateNode=e,t}function Wi(e,t,n){return(t=Ui(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Ki=new WeakMap;function Gi(e,t){if("object"==typeof e&&null!==e){var n=Ki.get(e);return void 0!==n?n:(t={value:e,source:t,stack:te(t)},Ki.set(e,t),t)}return{value:e,source:t,stack:te(t)}}var Ji=[],$i=0,Qi=null,Yi=0,Xi=[],Zi=0,er=null,tr=1,nr="";function ir(e,t){Ji[$i++]=Yi,Ji[$i++]=Qi,Qi=e,Yi=t}function rr(e,t,n){Xi[Zi++]=tr,Xi[Zi++]=nr,Xi[Zi++]=er,er=e;var i=tr;e=nr;var r=32-be(i)-1;i&=~(1<<r),n+=1;var o=32-be(t)+r;if(30<o){var a=r-r%5;o=(i&(1<<a)-1).toString(32),i>>=a,r-=a,tr=1<<32-be(t)+r|n<<r|i,nr=o+e}else tr=1<<o|n<<r|i,nr=e}function or(e){null!==e.return&&(ir(e,1),rr(e,1,0))}function ar(e){for(;e===Qi;)Qi=Ji[--$i],Ji[$i]=null,Yi=Ji[--$i],Ji[$i]=null;for(;e===er;)er=Xi[--Zi],Xi[Zi]=null,nr=Xi[--Zi],Xi[Zi]=null,tr=Xi[--Zi],Xi[Zi]=null}function sr(e,t){Xi[Zi++]=tr,Xi[Zi++]=nr,Xi[Zi++]=er,tr=t.id,nr=t.overflow,er=e}var cr=null,lr=null,ur=!1,dr=null,hr=!1,pr=Error(a(519));function fr(e){throw kr(Gi(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),pr}function mr(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[Be]=e,t[ze]=i,n){case"dialog":$u("cancel",t),$u("close",t);break;case"iframe":case"object":case"embed":$u("load",t);break;case"video":case"audio":for(n=0;n<Ku.length;n++)$u(Ku[n],t);break;case"source":$u("error",t);break;case"img":case"image":case"link":$u("error",t),$u("load",t);break;case"details":$u("toggle",t);break;case"input":$u("invalid",t),yt(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":$u("invalid",t);break;case"textarea":$u("invalid",t),St(t,i.value,i.defaultValue,i.children)}"string"!=typeof(n=i.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===i.suppressHydrationWarning||cd(t.textContent,n)?(null!=i.popover&&($u("beforetoggle",t),$u("toggle",t)),null!=i.onScroll&&$u("scroll",t),null!=i.onScrollEnd&&$u("scrollend",t),null!=i.onClick&&(t.onclick=It),t=!0):t=!1,t||fr(e,!0)}function gr(e){for(cr=e.return;cr;)switch(cr.tag){case 5:case 31:case 13:return void(hr=!1);case 27:case 3:return void(hr=!0);default:cr=cr.return}}function vr(e){if(e!==cr)return!1;if(!ur)return gr(e),ur=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||yd(e.type,e.memoizedProps)),t=!t),t&&lr&&fr(e),gr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));lr=Dd(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));lr=Dd(e)}else 27===n?(n=lr,Ed(e.type)?(e=Ad,Ad=null,lr=e):lr=n):lr=cr?Nd(e.stateNode.nextSibling):null;return!0}function yr(){lr=cr=null,ur=!1}function br(){var e=dr;return null!==e&&(null===_l?_l=e:_l.push.apply(_l,e),dr=null),e}function kr(e){null===dr?dr=[e]:dr.push(e)}var wr=j(null),Sr=null,Tr=null;function Cr(e,t,n){B(wr,t._currentValue),t._currentValue=n}function Er(e){e._currentValue=wr.current,F(wr)}function Pr(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Rr(e,t,n,i){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var o=r.dependencies;if(null!==o){var s=r.child;o=o.firstContext;e:for(;null!==o;){var c=o;o=r;for(var l=0;l<t.length;l++)if(c.context===t[l]){o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Pr(o.return,n,e),i||(s=null);break e}o=c.next}}else if(18===r.tag){if(null===(s=r.return))throw Error(a(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),Pr(s,n,e),s=null}else s=r.child;if(null!==s)s.return=r;else for(s=r;null!==s;){if(s===e){s=null;break}if(null!==(r=s.sibling)){r.return=s.return,s=r;break}s=s.return}r=s}}function xr(e,t,n,i){e=null;for(var r=t,o=!1;null!==r;){if(!o)if(524288&r.flags)o=!0;else if(262144&r.flags)break;if(10===r.tag){var s=r.alternate;if(null===s)throw Error(a(387));if(null!==(s=s.memoizedProps)){var c=r.type;Yn(r.pendingProps.value,s.value)||(null!==e?e.push(c):e=[c])}}else if(r===K.current){if(null===(s=r.alternate))throw Error(a(387));s.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(lh):e=[lh])}r=r.return}null!==e&&Rr(t,e,n,i),t.flags|=262144}function _r(e){for(e=e.firstContext;null!==e;){if(!Yn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Or(e){Sr=e,Tr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ir(e){return Ar(Sr,e)}function Nr(e,t){return null===Sr&&Or(e),Ar(e,t)}function Ar(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Tr){if(null===e)throw Error(a(308));Tr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Tr=Tr.next=t;return n}var Dr="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Lr=i.unstable_scheduleCallback,Mr=i.unstable_NormalPriority,Ur={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jr(){return{controller:new Dr,data:new Map,refCount:0}}function Fr(e){e.refCount--,0===e.refCount&&Lr(Mr,function(){e.controller.abort()})}var Br=null,zr=0,qr=0,Vr=null;function Hr(){if(0===--zr&&null!==Br){null!==Vr&&(Vr.status="fulfilled");var e=Br;Br=null,qr=0,Vr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Wr=A.S;A.S=function(e,t){Nl=se(),"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Br){var n=Br=[];zr=0,qr=zu(),Vr={status:"pending",value:void 0,then:function(e){n.push(e)}}}zr++,t.then(Hr,Hr)}(0,t),null!==Wr&&Wr(e,t)};var Kr=j(null);function Gr(){var e=Kr.current;return null!==e?e:pl.pooledCache}function Jr(e,t){B(Kr,null===t?Kr.current:t.pool)}function $r(){var e=Gr();return null===e?null:{parent:Ur._currentValue,pool:e}}var Qr=Error(a(460)),Yr=Error(a(474)),Xr=Error(a(542)),Zr={then:function(){}};function eo(e){return"fulfilled"===(e=e.status)||"rejected"===e}function to(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(It,It),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw oo(e=t.reason),e;default:if("string"==typeof t.status)t.then(It,It);else{if(null!==(e=pl)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw oo(e=t.reason),e}throw io=t,Qr}}function no(e){try{return(0,e._init)(e._payload)}catch(e){if(null!==e&&"object"==typeof e&&"function"==typeof e.then)throw io=e,Qr;throw e}}var io=null;function ro(){if(null===io)throw Error(a(459));var e=io;return io=null,e}function oo(e){if(e===Qr||e===Xr)throw Error(a(483))}var ao=null,so=0;function co(e){var t=so;return so+=1,null===ao&&(ao=[]),to(ao,e,t)}function lo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function uo(e,t){if(t.$$typeof===p)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ho(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=Fi(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=67108866,n):i:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function c(e,t,n,i){return null===t||6!==t.tag?((t=Vi(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function l(e,t,n,i){var o=n.type;return o===g?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===E&&no(o)===t.type)?(lo(t=r(t,n.props),n),t.return=e,t):(lo(t=zi(n.type,n.key,n.props,null,e.mode,i),n),t.return=e,t)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Wi(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,i,o){return null===t||7!==t.tag?((t=qi(n,e.mode,i,o)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Vi(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case f:return lo(n=zi(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Wi(t,e.mode,n)).return=e,t;case E:return h(e,t=no(t),n)}if(N(t)||_(t))return(t=qi(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return h(e,co(t),n);if(t.$$typeof===k)return h(e,Nr(e,t),n);uo(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==r?null:c(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case f:return n.key===r?l(e,t,n,i):null;case m:return n.key===r?u(e,t,n,i):null;case E:return p(e,t,n=no(n),i)}if(N(n)||_(n))return null!==r?null:d(e,t,n,i,null);if("function"==typeof n.then)return p(e,t,co(n),i);if(n.$$typeof===k)return p(e,t,Nr(e,n),i);uo(e,n)}return null}function v(e,t,n,i,r){if("string"==typeof i&&""!==i||"number"==typeof i||"bigint"==typeof i)return c(t,e=e.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case f:return l(t,e=e.get(null===i.key?n:i.key)||null,i,r);case m:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case E:return v(e,t,n,i=no(i),r)}if(N(i)||_(i))return d(t,e=e.get(n)||null,i,r,null);if("function"==typeof i.then)return v(e,t,n,co(i),r);if(i.$$typeof===k)return v(e,t,n,Nr(t,i),r);uo(t,i)}return null}function y(c,l,u,d){if("object"==typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case f:e:{for(var b=u.key;null!==l;){if(l.key===b){if((b=u.type)===g){if(7===l.tag){n(c,l.sibling),(d=r(l,u.props.children)).return=c,c=d;break e}}else if(l.elementType===b||"object"==typeof b&&null!==b&&b.$$typeof===E&&no(b)===l.type){n(c,l.sibling),lo(d=r(l,u.props),u),d.return=c,c=d;break e}n(c,l);break}t(c,l),l=l.sibling}u.type===g?((d=qi(u.props.children,c.mode,d,u.key)).return=c,c=d):(lo(d=zi(u.type,u.key,u.props,null,c.mode,d),u),d.return=c,c=d)}return s(c);case m:e:{for(b=u.key;null!==l;){if(l.key===b){if(4===l.tag&&l.stateNode.containerInfo===u.containerInfo&&l.stateNode.implementation===u.implementation){n(c,l.sibling),(d=r(l,u.children||[])).return=c,c=d;break e}n(c,l);break}t(c,l),l=l.sibling}(d=Wi(u,c.mode,d)).return=c,c=d}return s(c);case E:return y(c,l,u=no(u),d)}if(N(u))return function(r,a,s,c){for(var l=null,u=null,d=a,f=a=0,m=null;null!==d&&f<s.length;f++){d.index>f?(m=d,d=null):m=d.sibling;var g=p(r,d,s[f],c);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(r,d),a=o(g,a,f),null===u?l=g:u.sibling=g,u=g,d=m}if(f===s.length)return n(r,d),ur&&ir(r,f),l;if(null===d){for(;f<s.length;f++)null!==(d=h(r,s[f],c))&&(a=o(d,a,f),null===u?l=d:u.sibling=d,u=d);return ur&&ir(r,f),l}for(d=i(d);f<s.length;f++)null!==(m=v(d,r,f,s[f],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?f:m.key),a=o(m,a,f),null===u?l=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(r,e)}),ur&&ir(r,f),l}(c,l,u,d);if(_(u)){if("function"!=typeof(b=_(u)))throw Error(a(150));return function(r,s,c,l){if(null==c)throw Error(a(151));for(var u=null,d=null,f=s,m=s=0,g=null,y=c.next();null!==f&&!y.done;m++,y=c.next()){f.index>m?(g=f,f=null):g=f.sibling;var b=p(r,f,y.value,l);if(null===b){null===f&&(f=g);break}e&&f&&null===b.alternate&&t(r,f),s=o(b,s,m),null===d?u=b:d.sibling=b,d=b,f=g}if(y.done)return n(r,f),ur&&ir(r,m),u;if(null===f){for(;!y.done;m++,y=c.next())null!==(y=h(r,y.value,l))&&(s=o(y,s,m),null===d?u=y:d.sibling=y,d=y);return ur&&ir(r,m),u}for(f=i(f);!y.done;m++,y=c.next())null!==(y=v(f,r,m,y.value,l))&&(e&&null!==y.alternate&&f.delete(null===y.key?m:y.key),s=o(y,s,m),null===d?u=y:d.sibling=y,d=y);return e&&f.forEach(function(e){return t(r,e)}),ur&&ir(r,m),u}(c,l,u=b.call(u),d)}if("function"==typeof u.then)return y(c,l,co(u),d);if(u.$$typeof===k)return y(c,l,Nr(c,u),d);uo(c,u)}return"string"==typeof u&&""!==u||"number"==typeof u||"bigint"==typeof u?(u=""+u,null!==l&&6===l.tag?(n(c,l.sibling),(d=r(l,u)).return=c,c=d):(n(c,l),(d=Vi(u,c.mode,d)).return=c,c=d),s(c)):n(c,l)}return function(e,t,n,i){try{so=0;var r=y(e,t,n,i);return ao=null,r}catch(t){if(t===Qr||t===Xr)throw t;var o=Ui(29,t,null,e.mode);return o.lanes=i,o.return=e,o}}}var po=ho(!0),fo=ho(!1),mo=!1;function go(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function yo(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function bo(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,2&hl){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,t=Di(e),Ai(e,null,n),t}return Oi(e,i,t,n),Di(e)}function ko(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Ae(e,n)}}function wo(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?r=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,callbacks:i.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var So=!1;function To(){if(So&&null!==Vr)throw Vr}function Co(e,t,n,i){So=!1;var r=e.updateQueue;mo=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var c=s,l=c.next;c.next=null,null===a?o=l:a.next=l,a=c;var u=e.alternate;null!==u&&(s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c)}if(null!==o){var d=r.baseState;for(a=0,u=l=c=null,s=o;;){var p=-536870913&s.lane,f=p!==s.lane;if(f?(ml&p)===p:(i&p)===p){0!==p&&p===qr&&(So=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var m=e,g=s;p=t;var v=n;switch(g.tag){case 1:if("function"==typeof(m=g.payload)){d=m.call(v,d,p);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(p="function"==typeof(m=g.payload)?m.call(v,d,p):m))break e;d=h({},d,p);break e;case 2:mo=!0}}null!==(p=s.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=r.callbacks)?r.callbacks=[p]:f.push(p))}else f={lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=f,c=d):u=u.next=f,a|=p;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(f=s).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}null===u&&(c=d),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,null===o&&(r.shared.lanes=0),Tl|=a,e.lanes=a,e.memoizedState=d}}function Eo(e,t){if("function"!=typeof e)throw Error(a(191,e));e.call(t)}function Po(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Eo(n[e],t)}var Ro=j(null),xo=j(0);function _o(e,t){B(xo,e=wl),B(Ro,t),wl=e|t.baseLanes}function Oo(){B(xo,wl),B(Ro,Ro.current)}function Io(){wl=xo.current,F(Ro),F(xo)}var No=j(null),Ao=null;function Do(e){var t=e.alternate;B(Fo,1&Fo.current),B(No,e),null===Ao&&(null===t||null!==Ro.current||null!==t.memoizedState)&&(Ao=e)}function Lo(e){B(Fo,Fo.current),B(No,e),null===Ao&&(Ao=e)}function Mo(e){22===e.tag?(B(Fo,Fo.current),B(No,e),null===Ao&&(Ao=e)):Uo()}function Uo(){B(Fo,Fo.current),B(No,No.current)}function jo(e){F(No),Ao===e&&(Ao=null),F(Fo)}var Fo=j(0);function Bo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Od(n)||Id(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(128&t.flags)return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zo=0,qo=null,Vo=null,Ho=null,Wo=!1,Ko=!1,Go=!1,Jo=0,$o=0,Qo=null,Yo=0;function Xo(){throw Error(a(321))}function Zo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yn(e[n],t[n]))return!1;return!0}function ea(e,t,n,i,r,o){return zo=o,qo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,A.H=null===e||null===e.memoizedState?ms:gs,Go=!1,o=n(i,r),Go=!1,Ko&&(o=na(t,n,i,r)),ta(e),o}function ta(e){A.H=fs;var t=null!==Vo&&null!==Vo.next;if(zo=0,Ho=Vo=qo=null,Wo=!1,$o=0,Qo=null,t)throw Error(a(300));null===e||Ns||null!==(e=e.dependencies)&&_r(e)&&(Ns=!0)}function na(e,t,n,i){qo=e;var r=0;do{if(Ko&&(Qo=null),$o=0,Ko=!1,25<=r)throw Error(a(301));if(r+=1,Ho=Vo=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}A.H=vs,o=t(n,i)}while(Ko);return o}function ia(){var e=A.H,t=e.useState()[0];return t="function"==typeof t.then?la(t):t,e=e.useState()[0],(null!==Vo?Vo.memoizedState:null)!==e&&(qo.flags|=1024),t}function ra(){var e=0!==Jo;return Jo=0,e}function oa(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function aa(e){if(Wo){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Wo=!1}zo=0,Ho=Vo=qo=null,Ko=!1,$o=Jo=0,Qo=null}function sa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ho?qo.memoizedState=Ho=e:Ho=Ho.next=e,Ho}function ca(){if(null===Vo){var e=qo.alternate;e=null!==e?e.memoizedState:null}else e=Vo.next;var t=null===Ho?qo.memoizedState:Ho.next;if(null!==t)Ho=t,Vo=e;else{if(null===e){if(null===qo.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(Vo=e).memoizedState,baseState:Vo.baseState,baseQueue:Vo.baseQueue,queue:Vo.queue,next:null},null===Ho?qo.memoizedState=Ho=e:Ho=Ho.next=e}return Ho}function la(e){var t=$o;return $o+=1,null===Qo&&(Qo=[]),e=to(Qo,e,t),t=qo,null===(null===Ho?t.memoizedState:Ho.next)&&(t=t.alternate,A.H=null===t||null===t.memoizedState?ms:gs),e}function ua(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return la(e);if(e.$$typeof===k)return Ir(e)}throw Error(a(438,String(e)))}function da(e){var t=null,n=qo.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var i=qo.alternate;null!==i&&null!==(i=i.updateQueue)&&null!=(i=i.memoCache)&&(t={data:i.data.map(function(e){return e.slice()}),index:0})}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},qo.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=R;return t.index++,n}function ha(e,t){return"function"==typeof t?t(e):t}function pa(e){return fa(ca(),Vo,e)}function fa(e,t,n){var i=e.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=n;var r=e.baseQueue,o=i.pending;if(null!==o){if(null!==r){var s=r.next;r.next=o.next,o.next=s}t.baseQueue=r=o,i.pending=null}if(o=e.baseState,null===r)e.memoizedState=o;else{var c=s=null,l=null,u=t=r.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(ml&h)===h:(zo&h)===h){var p=u.revertLane;if(0===p)null!==l&&(l=l.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===qr&&(d=!0);else{if((zo&p)===p){u=u.next,p===qr&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===l?(c=l=h,s=o):l=l.next=h,qo.lanes|=p,Tl|=p}h=u.action,Go&&n(o,h),o=u.hasEagerState?u.eagerState:n(o,h)}else p={lane:h,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===l?(c=l=p,s=o):l=l.next=p,qo.lanes|=h,Tl|=h;u=u.next}while(null!==u&&u!==t);if(null===l?s=o:l.next=c,!Yn(o,e.memoizedState)&&(Ns=!0,d&&null!==(n=Vr)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=l,i.lastRenderedState=o}return null===r&&(i.lanes=0),[e.memoizedState,i.dispatch]}function ma(e){var t=ca(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{o=e(o,s.action),s=s.next}while(s!==r);Yn(o,t.memoizedState)||(Ns=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function ga(e,t,n){var i=qo,r=ca(),o=ur;if(o){if(void 0===n)throw Error(a(407));n=n()}else n=t();var s=!Yn((Vo||r).memoizedState,n);if(s&&(r.memoizedState=n,Ns=!0),r=r.queue,za(ba.bind(null,i,r,e),[e]),r.getSnapshot!==t||s||null!==Ho&&1&Ho.memoizedState.tag){if(i.flags|=2048,Ma(9,{destroy:void 0},ya.bind(null,i,r,n,t),null),null===pl)throw Error(a(349));o||127&zo||va(i,t,n)}return n}function va(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=qo.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},qo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ya(e,t,n,i){t.value=n,t.getSnapshot=i,ka(t)&&wa(e)}function ba(e,t,n){return n(function(){ka(t)&&wa(e)})}function ka(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Yn(e,n)}catch(e){return!0}}function wa(e){var t=Ni(e,2);null!==t&&Gl(t,0,2)}function Sa(e){var t=sa();if("function"==typeof e){var n=e;if(e=n(),Go){ye(!0);try{n()}finally{ye(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:e},t}function Ta(e,t,n,i){return e.baseState=n,fa(e,Vo,"function"==typeof i?i:ha)}function Ca(e,t,n,i,r){if(ds(e))throw Error(a(485));if(null!==(e=t.action)){var o={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==A.T?n(!0):o.isTransition=!1,i(o),null===(n=t.pending)?(o.next=t.pending=o,Ea(t,o)):(o.next=n.next,t.pending=n.next=o)}}function Ea(e,t){var n=t.action,i=t.payload,r=e.state;if(t.isTransition){var o=A.T,a={};A.T=a;try{var s=n(r,i),c=A.S;null!==c&&c(a,s),Pa(e,t,s)}catch(n){xa(e,t,n)}finally{null!==o&&null!==a.types&&(o.types=a.types),A.T=o}}else try{Pa(e,t,o=n(r,i))}catch(n){xa(e,t,n)}}function Pa(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){Ra(e,t,n)},function(n){return xa(e,t,n)}):Ra(e,t,n)}function Ra(e,t,n){t.status="fulfilled",t.value=n,_a(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Ea(e,n)))}function xa(e,t,n){var i=e.pending;if(e.pending=null,null!==i){i=i.next;do{t.status="rejected",t.reason=n,_a(t),t=t.next}while(t!==i)}e.action=null}function _a(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Oa(e,t){return t}function Ia(e,t){if(ur){var n=pl.formState;if(null!==n){e:{var i=qo;if(ur){if(lr){t:{for(var r=lr,o=hr;8!==r.nodeType;){if(!o){r=null;break t}if(null===(r=Nd(r.nextSibling))){r=null;break t}}r="F!"===(o=r.data)||"F"===o?r:null}if(r){lr=Nd(r.nextSibling),i="F!"===r.data;break e}}fr(i)}i=!1}i&&(t=n[0])}}return(n=sa()).memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:t},n.queue=i,n=cs.bind(null,qo,i),i.dispatch=n,i=Sa(!1),o=us.bind(null,qo,!1,i.queue),r={state:t,dispatch:null,action:e,pending:null},(i=sa()).queue=r,n=Ca.bind(null,qo,r,o,n),r.dispatch=n,i.memoizedState=e,[t,n,!1]}function Na(e){return Aa(ca(),Vo,e)}function Aa(e,t,n){if(t=fa(e,t,Oa)[0],e=pa(ha)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var i=la(t)}catch(e){if(e===Qr)throw Xr;throw e}else i=t;var r=(t=ca()).queue,o=r.dispatch;return n!==t.memoizedState&&(qo.flags|=2048,Ma(9,{destroy:void 0},Da.bind(null,r,n),null)),[i,o,e]}function Da(e,t){e.action=t}function La(e){var t=ca(),n=Vo;if(null!==n)return Aa(t,n,e);ca(),t=t.memoizedState;var i=(n=ca()).queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Ma(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},null===(t=qo.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},qo.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Ua(){return ca().memoizedState}function ja(e,t,n,i){var r=sa();qo.flags|=e,r.memoizedState=Ma(1|t,{destroy:void 0},n,void 0===i?null:i)}function Fa(e,t,n,i){var r=ca();i=void 0===i?null:i;var o=r.memoizedState.inst;null!==Vo&&null!==i&&Zo(i,Vo.memoizedState.deps)?r.memoizedState=Ma(t,o,n,i):(qo.flags|=e,r.memoizedState=Ma(1|t,o,n,i))}function Ba(e,t){ja(8390656,8,e,t)}function za(e,t){Fa(2048,8,e,t)}function qa(e){var t=ca().memoizedState;return function(e){qo.flags|=4;var t=qo.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},qo.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(2&hl)throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Va(e,t){return Fa(4,2,e,t)}function Ha(e,t){return Fa(4,4,e,t)}function Wa(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Ka(e,t,n){n=null!=n?n.concat([e]):null,Fa(4,4,Wa.bind(null,t,e),n)}function Ga(){}function Ja(e,t){var n=ca();t=void 0===t?null:t;var i=n.memoizedState;return null!==t&&Zo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function $a(e,t){var n=ca();t=void 0===t?null:t;var i=n.memoizedState;if(null!==t&&Zo(t,i[1]))return i[0];if(i=e(),Go){ye(!0);try{e()}finally{ye(!1)}}return n.memoizedState=[i,t],i}function Qa(e,t,n){return void 0===n||1073741824&zo&&!(261930&ml)?e.memoizedState=t:(e.memoizedState=n,e=Kl(),qo.lanes|=e,Tl|=e,n)}function Ya(e,t,n,i){return Yn(n,t)?n:null!==Ro.current?(e=Qa(e,n,i),Yn(e,t)||(Ns=!0),e):42&zo&&(!(1073741824&zo)||261930&ml)?(e=Kl(),qo.lanes|=e,Tl|=e,t):(Ns=!0,e.memoizedState=n)}function Xa(e,t,n,i,r){var o=D.p;D.p=0!==o&&8>o?o:8;var a,s,c,l=A.T,u={};A.T=u,us(e,!1,t,n);try{var d=r(),h=A.S;null!==h&&h(u,d),null!==d&&"object"==typeof d&&"function"==typeof d.then?ls(e,t,(a=i,s=[],c={status:"pending",value:null,reason:null,then:function(e){s.push(e)}},d.then(function(){c.status="fulfilled",c.value=a;for(var e=0;e<s.length;e++)(0,s[e])(a)},function(e){for(c.status="rejected",c.reason=e,e=0;e<s.length;e++)(0,s[e])(void 0)}),c),Wl()):ls(e,t,i,Wl())}catch(n){ls(e,t,{then:function(){},status:"rejected",reason:n},Wl())}finally{D.p=o,null!==l&&null!==u.types&&(l.types=u.types),A.T=l}}function Za(){}function es(e,t,n,i){if(5!==e.tag)throw Error(a(476));var r=ts(e).queue;Xa(e,r,t,L,null===n?Za:function(){return ns(e),n(i)})}function ts(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:L},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ns(e){var t=ts(e);null===t.next&&(t=e.alternate.memoizedState),ls(e,t.next.queue,{},Wl())}function is(){return Ir(lh)}function rs(){return ca().memoizedState}function os(){return ca().memoizedState}function as(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Wl(),i=bo(t,e=yo(n),n);return null!==i&&(Gl(i,0,n),ko(i,t,n)),t={cache:jr()},void(e.payload=t)}t=t.return}}function ss(e,t,n){var i=Wl();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ds(e)?hs(t,n):null!==(n=Ii(e,t,n,i))&&(Gl(n,0,i),ps(n,t,i))}function cs(e,t,n){ls(e,t,n,Wl())}function ls(e,t,n,i){var r={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(ds(e))hs(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(r.hasEagerState=!0,r.eagerState=s,Yn(s,a))return Oi(e,t,r,0),null===pl&&_i(),!1}catch(e){}if(null!==(n=Ii(e,t,r,i)))return Gl(n,0,i),ps(n,t,i),!0}return!1}function us(e,t,n,i){if(i={lane:2,revertLane:zu(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},ds(e)){if(t)throw Error(a(479))}else null!==(t=Ii(e,n,i,2))&&Gl(t,0,2)}function ds(e){var t=e.alternate;return e===qo||null!==t&&t===qo}function hs(e,t){Ko=Wo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ps(e,t,n){if(4194048&n){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Ae(e,n)}}var fs={readContext:Ir,use:ua,useCallback:Xo,useContext:Xo,useEffect:Xo,useImperativeHandle:Xo,useLayoutEffect:Xo,useInsertionEffect:Xo,useMemo:Xo,useReducer:Xo,useRef:Xo,useState:Xo,useDebugValue:Xo,useDeferredValue:Xo,useTransition:Xo,useSyncExternalStore:Xo,useId:Xo,useHostTransitionStatus:Xo,useFormState:Xo,useActionState:Xo,useOptimistic:Xo,useMemoCache:Xo,useCacheRefresh:Xo};fs.useEffectEvent=Xo;var ms={readContext:Ir,use:ua,useCallback:function(e,t){return sa().memoizedState=[e,void 0===t?null:t],e},useContext:Ir,useEffect:Ba,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,ja(4194308,4,Wa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ja(4194308,4,e,t)},useInsertionEffect:function(e,t){ja(4,2,e,t)},useMemo:function(e,t){var n=sa();t=void 0===t?null:t;var i=e();if(Go){ye(!0);try{e()}finally{ye(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=sa();if(void 0!==n){var r=n(t);if(Go){ye(!0);try{n(t)}finally{ye(!1)}}}else r=t;return i.memoizedState=i.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},i.queue=e,e=e.dispatch=ss.bind(null,qo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},sa().memoizedState=e},useState:function(e){var t=(e=Sa(e)).queue,n=cs.bind(null,qo,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ga,useDeferredValue:function(e,t){return Qa(sa(),e,t)},useTransition:function(){var e=Sa(!1);return e=Xa.bind(null,qo,e.queue,!0,!1),sa().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=qo,r=sa();if(ur){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===pl)throw Error(a(349));127&ml||va(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Ba(ba.bind(null,i,o,e),[e]),i.flags|=2048,Ma(9,{destroy:void 0},ya.bind(null,i,o,n,t),null),n},useId:function(){var e=sa(),t=pl.identifierPrefix;if(ur){var n=nr;t="_"+t+"R_"+(n=(tr&~(1<<32-be(tr)-1)).toString(32)+n),0<(n=Jo++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Yo++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:is,useFormState:Ia,useActionState:Ia,useOptimistic:function(e){var t=sa();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=us.bind(null,qo,!0,n),n.dispatch=t,[e,t]},useMemoCache:da,useCacheRefresh:function(){return sa().memoizedState=as.bind(null,qo)},useEffectEvent:function(e){var t=sa(),n={impl:e};return t.memoizedState=n,function(){if(2&hl)throw Error(a(440));return n.impl.apply(void 0,arguments)}}},gs={readContext:Ir,use:ua,useCallback:Ja,useContext:Ir,useEffect:za,useImperativeHandle:Ka,useInsertionEffect:Va,useLayoutEffect:Ha,useMemo:$a,useReducer:pa,useRef:Ua,useState:function(){return pa(ha)},useDebugValue:Ga,useDeferredValue:function(e,t){return Ya(ca(),Vo.memoizedState,e,t)},useTransition:function(){var e=pa(ha)[0],t=ca().memoizedState;return["boolean"==typeof e?e:la(e),t]},useSyncExternalStore:ga,useId:rs,useHostTransitionStatus:is,useFormState:Na,useActionState:Na,useOptimistic:function(e,t){return Ta(ca(),0,e,t)},useMemoCache:da,useCacheRefresh:os};gs.useEffectEvent=qa;var vs={readContext:Ir,use:ua,useCallback:Ja,useContext:Ir,useEffect:za,useImperativeHandle:Ka,useInsertionEffect:Va,useLayoutEffect:Ha,useMemo:$a,useReducer:ma,useRef:Ua,useState:function(){return ma(ha)},useDebugValue:Ga,useDeferredValue:function(e,t){var n=ca();return null===Vo?Qa(n,e,t):Ya(n,Vo.memoizedState,e,t)},useTransition:function(){var e=ma(ha)[0],t=ca().memoizedState;return["boolean"==typeof e?e:la(e),t]},useSyncExternalStore:ga,useId:rs,useHostTransitionStatus:is,useFormState:La,useActionState:La,useOptimistic:function(e,t){var n=ca();return null!==Vo?Ta(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:da,useCacheRefresh:os};function ys(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:h({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}vs.useEffectEvent=qa;var bs={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Wl(),r=yo(i);r.payload=t,null!=n&&(r.callback=n),null!==(t=bo(e,r,i))&&(Gl(t,0,i),ko(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Wl(),r=yo(i);r.tag=1,r.payload=t,null!=n&&(r.callback=n),null!==(t=bo(e,r,i))&&(Gl(t,0,i),ko(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Wl(),i=yo(n);i.tag=2,null!=t&&(i.callback=t),null!==(t=bo(e,i,n))&&(Gl(t,0,n),ko(t,e,n))}};function ks(e,t,n,i,r,o,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,a):!(t.prototype&&t.prototype.isPureReactComponent&&Xn(n,i)&&Xn(r,o))}function ws(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&bs.enqueueReplaceState(t,t.state,null)}function Ss(e,t){var n=t;if("ref"in t)for(var i in n={},t)"ref"!==i&&(n[i]=t[i]);if(e=e.defaultProps)for(var r in n===t&&(n=h({},n)),e)void 0===n[r]&&(n[r]=e[r]);return n}function Ts(e){Ei(e)}function Cs(e){console.error(e)}function Es(e){Ei(e)}function Ps(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(e){setTimeout(function(){throw e})}}function Rs(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(e){setTimeout(function(){throw e})}}function xs(e,t,n){return(n=yo(n)).tag=3,n.payload={element:null},n.callback=function(){Ps(e,t)},n}function _s(e){return(e=yo(e)).tag=3,e}function Os(e,t,n,i){var r=n.type.getDerivedStateFromError;if("function"==typeof r){var o=i.value;e.payload=function(){return r(o)},e.callback=function(){Rs(t,n,i)}}var a=n.stateNode;null!==a&&"function"==typeof a.componentDidCatch&&(e.callback=function(){Rs(t,n,i),"function"!=typeof r&&(null===Ll?Ll=new Set([this]):Ll.add(this));var e=i.stack;this.componentDidCatch(i.value,{componentStack:null!==e?e:""})})}var Is=Error(a(461)),Ns=!1;function As(e,t,n,i){t.child=null===e?fo(t,null,n,i):po(t,e.child,n,i)}function Ds(e,t,n,i,r){n=n.render;var o=t.ref;if("ref"in i){var a={};for(var s in i)"ref"!==s&&(a[s]=i[s])}else a=i;return Or(t),i=ea(e,t,n,a,o,r),s=ra(),null===e||Ns?(ur&&s&&or(t),t.flags|=1,As(e,t,i,r),t.child):(oa(e,t,r),ic(e,t,r))}function Ls(e,t,n,i,r){if(null===e){var o=n.type;return"function"!=typeof o||ji(o)||void 0!==o.defaultProps||null!==n.compare?((e=zi(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ms(e,t,o,i,r))}if(o=e.child,!rc(e,r)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:Xn)(a,i)&&e.ref===t.ref)return ic(e,t,r)}return t.flags|=1,(e=Fi(o,i)).ref=t.ref,e.return=t,t.child=e}function Ms(e,t,n,i,r){if(null!==e){var o=e.memoizedProps;if(Xn(o,i)&&e.ref===t.ref){if(Ns=!1,t.pendingProps=i=o,!rc(e,r))return t.lanes=e.lanes,ic(e,t,r);131072&e.flags&&(Ns=!0)}}return Vs(e,t,n,i,r)}function Us(e,t,n,i){var r=i.children,o=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===i.mode){if(128&t.flags){if(o=null!==o?o.baseLanes|n:n,null!==e){for(i=t.child=e.child,r=0;null!==i;)r=r|i.lanes|i.childLanes,i=i.sibling;i=r&~o}else i=0,t.child=null;return Fs(e,t,o,n,i)}if(!(536870912&n))return i=t.lanes=536870912,Fs(e,t,null!==o?o.baseLanes|n:n,n,i);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Jr(0,null!==o?o.cachePool:null),null!==o?_o(t,o):Oo(),Mo(t)}else null!==o?(Jr(0,o.cachePool),_o(t,o),Uo(),t.memoizedState=null):(null!==e&&Jr(0,null),Oo(),Uo());return As(e,t,r,n),t.child}function js(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Fs(e,t,n,i,r){var o=Gr();return o=null===o?null:{parent:Ur._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},null!==e&&Jr(0,null),Oo(),Mo(t),null!==e&&xr(e,t,i,!0),t.childLanes=r,null}function Bs(e,t){return(t=Xs({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function zs(e,t,n){return po(t,e.child,null,n),(e=Bs(t,t.pendingProps)).flags|=2,jo(t),t.memoizedState=null,e}function qs(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Vs(e,t,n,i,r){return Or(t),n=ea(e,t,n,i,void 0,r),i=ra(),null===e||Ns?(ur&&i&&or(t),t.flags|=1,As(e,t,n,r),t.child):(oa(e,t,r),ic(e,t,r))}function Hs(e,t,n,i,r,o){return Or(t),t.updateQueue=null,n=na(t,i,n,r),ta(e),i=ra(),null===e||Ns?(ur&&i&&or(t),t.flags|=1,As(e,t,n,o),t.child):(oa(e,t,o),ic(e,t,o))}function Ws(e,t,n,i,r){if(Or(t),null===t.stateNode){var o=Li,a=n.contextType;"object"==typeof a&&null!==a&&(o=Ir(a)),o=new n(i,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=bs,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=i,o.state=t.memoizedState,o.refs={},go(t),a=n.contextType,o.context="object"==typeof a&&null!==a?Ir(a):Li,o.state=t.memoizedState,"function"==typeof(a=n.getDerivedStateFromProps)&&(ys(t,n,a,i),o.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(a=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),a!==o.state&&bs.enqueueReplaceState(o,o.state,null),Co(t,i,o,r),To(),o.state=t.memoizedState),"function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!0}else if(null===e){o=t.stateNode;var s=t.memoizedProps,c=Ss(n,s);o.props=c;var l=o.context,u=n.contextType;a=Li,"object"==typeof u&&null!==u&&(a=Ir(u));var d=n.getDerivedStateFromProps;u="function"==typeof d||"function"==typeof o.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s||l!==a)&&ws(t,o,i,a),mo=!1;var h=t.memoizedState;o.state=h,Co(t,i,o,r),To(),l=t.memoizedState,s||h!==l||mo?("function"==typeof d&&(ys(t,n,d,i),l=t.memoizedState),(c=mo||ks(t,n,c,i,h,l,a))?(u||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=a,i=c):("function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,vo(e,t),u=Ss(n,a=t.memoizedProps),o.props=u,d=t.pendingProps,h=o.context,l=n.contextType,c=Li,"object"==typeof l&&null!==l&&(c=Ir(l)),(l="function"==typeof(s=n.getDerivedStateFromProps)||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==d||h!==c)&&ws(t,o,i,c),mo=!1,h=t.memoizedState,o.state=h,Co(t,i,o,r),To();var p=t.memoizedState;a!==d||h!==p||mo||null!==e&&null!==e.dependencies&&_r(e.dependencies)?("function"==typeof s&&(ys(t,n,s,i),p=t.memoizedState),(u=mo||ks(t,n,u,i,h,p,c)||null!==e&&null!==e.dependencies&&_r(e.dependencies))?(l||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,p,c),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,p,c)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),o.props=i,o.state=p,o.context=c,i=u):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return o=i,qs(e,t),i=!!(128&t.flags),o||i?(o=t.stateNode,n=i&&"function"!=typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&i?(t.child=po(t,e.child,null,r),t.child=po(t,null,n,r)):As(e,t,n,r),t.memoizedState=o.state,e=t.child):e=ic(e,t,r),e}function Ks(e,t,n,i){return yr(),t.flags|=256,As(e,t,n,i),t.child}var Gs={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Js(e){return{baseLanes:e,cachePool:$r()}}function $s(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Pl),e}function Qs(e,t,n){var i,r=t.pendingProps,o=!1,s=!!(128&t.flags);if((i=s)||(i=(null===e||null!==e.memoizedState)&&!!(2&Fo.current)),i&&(o=!0,t.flags&=-129),i=!!(32&t.flags),t.flags&=-33,null===e){if(ur){if(o?Do(t):Uo(),(e=lr)?null!==(e=null!==(e=_d(e,hr))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==er?{id:tr,overflow:nr}:null,retryLane:536870912,hydrationErrors:null},(n=Hi(e)).return=t,t.child=n,cr=t,lr=null):e=null,null===e)throw fr(t);return Id(e)?t.lanes=32:t.lanes=536870912,null}var c=r.children;return r=r.fallback,o?(Uo(),c=Xs({mode:"hidden",children:c},o=t.mode),r=qi(r,o,n,null),c.return=t,r.return=t,c.sibling=r,t.child=c,(r=t.child).memoizedState=Js(n),r.childLanes=$s(e,i,n),t.memoizedState=Gs,js(null,r)):(Do(t),Ys(t,c))}var l=e.memoizedState;if(null!==l&&null!==(c=l.dehydrated)){if(s)256&t.flags?(Do(t),t.flags&=-257,t=Zs(e,t,n)):null!==t.memoizedState?(Uo(),t.child=e.child,t.flags|=128,t=null):(Uo(),c=r.fallback,o=t.mode,r=Xs({mode:"visible",children:r.children},o),(c=qi(c,o,n,null)).flags|=2,r.return=t,c.return=t,r.sibling=c,t.child=r,po(t,e.child,null,n),(r=t.child).memoizedState=Js(n),r.childLanes=$s(e,i,n),t.memoizedState=Gs,t=js(null,r));else if(Do(t),Id(c)){if(i=c.nextSibling&&c.nextSibling.dataset)var u=i.dgst;i=u,(r=Error(a(419))).stack="",r.digest=i,kr({value:r,source:null,stack:null}),t=Zs(e,t,n)}else if(Ns||xr(e,t,n,!1),i=0!==(n&e.childLanes),Ns||i){if(null!==(i=pl)&&0!==(r=De(i,n))&&r!==l.retryLane)throw l.retryLane=r,Ni(e,r),Gl(i,0,r),Is;Od(c)||ou(),t=Zs(e,t,n)}else Od(c)?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,lr=Nd(c.nextSibling),cr=t,ur=!0,dr=null,hr=!1,null!==e&&sr(t,e),(t=Ys(t,r.children)).flags|=4096);return t}return o?(Uo(),c=r.fallback,o=t.mode,u=(l=e.child).sibling,(r=Fi(l,{mode:"hidden",children:r.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?c=Fi(u,c):(c=qi(c,o,n,null)).flags|=2,c.return=t,r.return=t,r.sibling=c,t.child=r,js(null,r),r=t.child,null===(c=e.child.memoizedState)?c=Js(n):(null!==(o=c.cachePool)?(l=Ur._currentValue,o=o.parent!==l?{parent:l,pool:l}:o):o=$r(),c={baseLanes:c.baseLanes|n,cachePool:o}),r.memoizedState=c,r.childLanes=$s(e,i,n),t.memoizedState=Gs,js(e.child,r)):(Do(t),e=(n=e.child).sibling,(n=Fi(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function Ys(e,t){return(t=Xs({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Xs(e,t){return(e=Ui(22,e,null,t)).lanes=0,e}function Zs(e,t,n){return po(t,e.child,null,n),(e=Ys(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ec(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Pr(e.return,t,n)}function tc(e,t,n,i,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r,treeForkCount:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r,a.treeForkCount=o)}function nc(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;i=i.children;var a=Fo.current,s=!!(2&a);if(s?(a=1&a|2,t.flags|=128):a&=1,B(Fo,a),As(e,t,i,n),i=ur?Yi:0,!s&&null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ec(e,n,t);else if(19===e.tag)ec(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===Bo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),tc(t,!1,r,n,o,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===Bo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}tc(t,!0,n,null,o,i);break;case"together":tc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function ic(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Tl|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(xr(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Fi(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fi(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function rc(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!_r(e))}function oc(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ns=!0;else{if(!(rc(e,n)||128&t.flags))return Ns=!1,function(e,t,n){switch(t.tag){case 3:G(t,t.stateNode.containerInfo),Cr(0,Ur,e.memoizedState.cache),yr();break;case 27:case 5:$(t);break;case 4:G(t,t.stateNode.containerInfo);break;case 10:Cr(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Lo(t),null;break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(Do(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Qs(e,t,n):(Do(t),null!==(e=ic(e,t,n))?e.sibling:null);Do(t);break;case 19:var r=!!(128&e.flags);if((i=0!==(n&t.childLanes))||(xr(e,t,n,!1),i=0!==(n&t.childLanes)),r){if(i)return nc(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),B(Fo,Fo.current),i)break;return null;case 22:return t.lanes=0,Us(e,t,n,t.pendingProps);case 24:Cr(0,Ur,e.memoizedState.cache)}return ic(e,t,n)}(e,t,n);Ns=!!(131072&e.flags)}else Ns=!1,ur&&1048576&t.flags&&rr(t,Yi,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=no(t.elementType),t.type=e,"function"!=typeof e){if(null!=e){var r=e.$$typeof;if(r===w){t.tag=11,t=Ds(null,t,e,i,n);break e}if(r===C){t.tag=14,t=Ls(null,t,e,i,n);break e}}throw t=I(e)||e,Error(a(306,t,""))}ji(e)?(i=Ss(e,i),t.tag=1,t=Ws(null,t,e,i,n)):(t.tag=0,t=Vs(null,t,e,i,n))}return t;case 0:return Vs(e,t,t.type,t.pendingProps,n);case 1:return Ws(e,t,i=t.type,r=Ss(i,t.pendingProps),n);case 3:e:{if(G(t,t.stateNode.containerInfo),null===e)throw Error(a(387));i=t.pendingProps;var o=t.memoizedState;r=o.element,vo(e,t),Co(t,i,null,n);var s=t.memoizedState;if(i=s.cache,Cr(0,Ur,i),i!==o.cache&&Rr(t,[Ur],n,!0),To(),i=s.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ks(e,t,i,n);break e}if(i!==r){kr(r=Gi(Error(a(424)),t)),t=Ks(e,t,i,n);break e}for(e=9===(e=t.stateNode.containerInfo).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,lr=Nd(e.firstChild),cr=t,ur=!0,dr=null,hr=!0,n=fo(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(yr(),i===r){t=ic(e,t,n);break e}As(e,t,i,n)}t=t.child}return t;case 26:return qs(e,t),null===e?(n=Hd(t.type,null,t.pendingProps,null))?t.memoizedState=n:ur||(n=t.type,e=t.pendingProps,(i=md(W.current).createElement(n))[Be]=t,i[ze]=e,dd(i,n,e),Ze(i),t.stateNode=i):t.memoizedState=Hd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&ur&&(i=t.stateNode=Md(t.type,t.pendingProps,W.current),cr=t,hr=!0,r=lr,Ed(t.type)?(Ad=r,lr=Nd(i.firstChild)):lr=r),As(e,t,t.pendingProps.children,n),qs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ur&&((r=i=lr)&&(null!==(i=function(e,t,n,i){for(;1===e.nodeType;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(i){if(!e[Ge])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===o)return e}if(null===(e=Nd(e.nextSibling)))break}return null}(i,t.type,t.pendingProps,hr))?(t.stateNode=i,cr=t,lr=Nd(i.firstChild),hr=!1,r=!0):r=!1),r||fr(t)),$(t),r=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,i=o.children,yd(r,o)?i=null:null!==s&&yd(r,s)&&(t.flags|=32),null!==t.memoizedState&&(r=ea(e,t,ia,null,null,n),lh._currentValue=r),qs(e,t),As(e,t,i,n),t.child;case 6:return null===e&&ur&&((e=n=lr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Nd(e.nextSibling)))return null}return e}(n,t.pendingProps,hr))?(t.stateNode=n,cr=t,lr=null,e=!0):e=!1),e||fr(t)),null;case 13:return Qs(e,t,n);case 4:return G(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=po(t,null,i,n):As(e,t,i,n),t.child;case 11:return Ds(e,t,t.type,t.pendingProps,n);case 7:return As(e,t,t.pendingProps,n),t.child;case 8:case 12:return As(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,Cr(0,t.type,i.value),As(e,t,i.children,n),t.child;case 9:return r=t.type._context,i=t.pendingProps.children,Or(t),i=i(r=Ir(r)),t.flags|=1,As(e,t,i,n),t.child;case 14:return Ls(e,t,t.type,t.pendingProps,n);case 15:return Ms(e,t,t.type,t.pendingProps,n);case 19:return nc(e,t,n);case 31:return function(e,t,n){var i=t.pendingProps,r=!!(128&t.flags);if(t.flags&=-129,null===e){if(ur){if("hidden"===i.mode)return e=Bs(t,i),t.lanes=536870912,js(null,e);if(Lo(t),(e=lr)?null!==(e=null!==(e=_d(e,hr))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==er?{id:tr,overflow:nr}:null,retryLane:536870912,hydrationErrors:null},(n=Hi(e)).return=t,t.child=n,cr=t,lr=null):e=null,null===e)throw fr(t);return t.lanes=536870912,null}return Bs(t,i)}var o=e.memoizedState;if(null!==o){var s=o.dehydrated;if(Lo(t),r)if(256&t.flags)t.flags&=-257,t=zs(e,t,n);else{if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null}else if(Ns||xr(e,t,n,!1),r=0!==(n&e.childLanes),Ns||r){if(null!==(i=pl)&&0!==(s=De(i,n))&&s!==o.retryLane)throw o.retryLane=s,Ni(e,s),Gl(i,0,s),Is;ou(),t=zs(e,t,n)}else e=o.treeContext,lr=Nd(s.nextSibling),cr=t,ur=!0,dr=null,hr=!1,null!==e&&sr(t,e),(t=Bs(t,i)).flags|=4096;return t}return(e=Fi(e.child,{mode:i.mode,children:i.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Us(e,t,n,t.pendingProps);case 24:return Or(t),i=Ir(Ur),null===e?(null===(r=Gr())&&(r=pl,o=jr(),r.pooledCache=o,o.refCount++,null!==o&&(r.pooledCacheLanes|=n),r=o),t.memoizedState={parent:i,cache:r},go(t),Cr(0,Ur,r)):(0!==(e.lanes&n)&&(vo(e,t),Co(t,null,null,n),To()),r=e.memoizedState,o=t.memoizedState,r.parent!==i?(r={parent:i,cache:i},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),Cr(0,Ur,i)):(i=o.cache,Cr(0,Ur,i),i!==r.cache&&Rr(t,[Ur],n,!0))),As(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function ac(e){e.flags|=4}function sc(e,t,n,i,r){if((t=!!(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&r)===r)if(e.stateNode.complete)e.flags|=8192;else{if(!nu())throw io=Zr,Yr;e.flags|=8192}}else e.flags&=-16777217}function cc(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!ih(t)){if(!nu())throw io=Zr,Yr;e.flags|=8192}}function lc(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?_e():536870912,e.lanes|=t,Rl|=t)}function uc(e,t){if(!ur)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function dc(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=65011712&r.subtreeFlags,i|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function hc(e,t,n){var i=t.pendingProps;switch(ar(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return dc(t),null;case 3:return n=t.stateNode,i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Er(Ur),J(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(vr(t)?ac(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,br())),dc(t),null;case 26:var r=t.type,o=t.memoizedState;return null===e?(ac(t),null!==o?(dc(t),cc(t,o)):(dc(t),sc(t,r,0,0,n))):o?o!==e.memoizedState?(ac(t),dc(t),cc(t,o)):(dc(t),t.flags&=-16777217):((e=e.memoizedProps)!==i&&ac(t),dc(t),sc(t,r,0,0,n)),null;case 27:if(Q(t),n=W.current,r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&ac(t);else{if(!i){if(null===t.stateNode)throw Error(a(166));return dc(t),null}e=V.current,vr(t)?mr(t):(e=Md(r,i,n),t.stateNode=e,ac(t))}return dc(t),null;case 5:if(Q(t),r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&ac(t);else{if(!i){if(null===t.stateNode)throw Error(a(166));return dc(t),null}if(o=V.current,vr(t))mr(t);else{var s=md(W.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":(o=s.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"==typeof i.is?s.createElement("select",{is:i.is}):s.createElement("select"),i.multiple?o.multiple=!0:i.size&&(o.size=i.size);break;default:o="string"==typeof i.is?s.createElement(r,{is:i.is}):s.createElement(r)}}o[Be]=t,o[ze]=i;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)o.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;e:switch(dd(o,r,i),r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&ac(t)}}return dc(t),sc(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==i&&ac(t);else{if("string"!=typeof i&&null===t.stateNode)throw Error(a(166));if(e=W.current,vr(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,null!==(r=cr))switch(r.tag){case 27:case 5:i=r.memoizedProps}e[Be]=t,(e=!!(e.nodeValue===n||null!==i&&!0===i.suppressHydrationWarning||cd(e.nodeValue,n)))||fr(t,!0)}else(e=md(e).createTextNode(i))[Be]=t,t.stateNode=e}return dc(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(i=vr(t),null!==n){if(null===e){if(!i)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[Be]=t}else yr(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;dc(t),e=!1}else n=br(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(jo(t),t):(jo(t),null);if(128&t.flags)throw Error(a(558))}return dc(t),null;case 13:if(i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=vr(t),null!==i&&null!==i.dehydrated){if(null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[Be]=t}else yr(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;dc(t),r=!1}else r=br(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(jo(t),t):(jo(t),null)}return jo(t),128&t.flags?(t.lanes=n,t):(n=null!==i,e=null!==e&&null!==e.memoizedState,n&&(r=null,null!==(i=t.child).alternate&&null!==i.alternate.memoizedState&&null!==i.alternate.memoizedState.cachePool&&(r=i.alternate.memoizedState.cachePool.pool),o=null,null!==i.memoizedState&&null!==i.memoizedState.cachePool&&(o=i.memoizedState.cachePool.pool),o!==r&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),lc(t,t.updateQueue),dc(t),null);case 4:return J(),null===e&&Xu(t.stateNode.containerInfo),dc(t),null;case 10:return Er(t.type),dc(t),null;case 19:if(F(Fo),null===(i=t.memoizedState))return dc(t),null;if(r=!!(128&t.flags),null===(o=i.rendering))if(r)uc(i,!1);else{if(0!==Sl||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(o=Bo(e))){for(t.flags|=128,uc(i,!1),e=o.updateQueue,t.updateQueue=e,lc(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Bi(n,e),n=n.sibling;return B(Fo,1&Fo.current|2),ur&&ir(t,i.treeForkCount),t.child}e=e.sibling}null!==i.tail&&se()>Al&&(t.flags|=128,r=!0,uc(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=Bo(o))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,lc(t,e),uc(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!ur)return dc(t),null}else 2*se()-i.renderingStartTime>Al&&536870912!==n&&(t.flags|=128,r=!0,uc(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=i.last)?e.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=se(),e.sibling=null,n=Fo.current,B(Fo,r?1&n|2:1&n),ur&&ir(t,i.treeForkCount),e):(dc(t),null);case 22:case 23:return jo(t),Io(),i=null!==t.memoizedState,null!==e?null!==e.memoizedState!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?!!(536870912&n)&&!(128&t.flags)&&(dc(t),6&t.subtreeFlags&&(t.flags|=8192)):dc(t),null!==(n=t.updateQueue)&&lc(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),i=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),null!==e&&F(Kr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Er(Ur),dc(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function pc(e,t){switch(ar(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Er(Ur),J(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Q(t),null;case 31:if(null!==t.memoizedState){if(jo(t),null===t.alternate)throw Error(a(340));yr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(jo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));yr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return F(Fo),null;case 4:return J(),null;case 10:return Er(t.type),null;case 22:case 23:return jo(t),Io(),null!==e&&F(Kr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Er(Ur),null;default:return null}}function fc(e,t){switch(ar(t),t.tag){case 3:Er(Ur),J();break;case 26:case 27:case 5:Q(t);break;case 4:J();break;case 31:null!==t.memoizedState&&jo(t);break;case 13:jo(t);break;case 19:F(Fo);break;case 10:Er(t.type);break;case 22:case 23:jo(t),Io(),null!==e&&F(Kr);break;case 24:Er(Ur)}}function mc(e,t){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var r=i.next;n=r;do{if((n.tag&e)===e){i=void 0;var o=n.create,a=n.inst;i=o(),a.destroy=i}n=n.next}while(n!==r)}}catch(e){Su(t,t.return,e)}}function gc(e,t,n){try{var i=t.updateQueue,r=null!==i?i.lastEffect:null;if(null!==r){var o=r.next;i=o;do{if((i.tag&e)===e){var a=i.inst,s=a.destroy;if(void 0!==s){a.destroy=void 0,r=t;var c=n,l=s;try{l()}catch(e){Su(r,c,e)}}}i=i.next}while(i!==o)}}catch(e){Su(t,t.return,e)}}function vc(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Po(t,n)}catch(t){Su(e,e.return,t)}}}function yc(e,t,n){n.props=Ss(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(n){Su(e,t,n)}}function bc(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;default:i=e.stateNode}"function"==typeof n?e.refCleanup=n(i):n.current=i}}catch(n){Su(e,t,n)}}function kc(e,t){var n=e.ref,i=e.refCleanup;if(null!==n)if("function"==typeof i)try{i()}catch(n){Su(e,t,n)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(n){Su(e,t,n)}else n.current=null}function wc(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(t){Su(e,e.return,t)}}function Sc(e,t,n){try{var i=e.stateNode;!function(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,o=null,s=null,c=null,l=null,u=null,d=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&null!=h)switch(f){case"checked":case"value":break;case"defaultValue":l=h;default:i.hasOwnProperty(f)||ld(e,t,f,null,i,h)}}for(var p in i){var f=i[p];if(h=n[p],i.hasOwnProperty(p)&&(null!=f||null!=h))switch(p){case"type":o=f;break;case"name":r=f;break;case"checked":u=f;break;case"defaultChecked":d=f;break;case"value":s=f;break;case"defaultValue":c=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:f!==h&&ld(e,t,p,f,i,h)}}return void vt(e,s,c,l,u,d,o,r);case"select":for(o in f=s=c=p=null,n)if(l=n[o],n.hasOwnProperty(o)&&null!=l)switch(o){case"value":break;case"multiple":f=l;default:i.hasOwnProperty(o)||ld(e,t,o,null,i,l)}for(r in i)if(o=i[r],l=n[r],i.hasOwnProperty(r)&&(null!=o||null!=l))switch(r){case"value":p=o;break;case"defaultValue":c=o;break;case"multiple":s=o;default:o!==l&&ld(e,t,r,o,i,l)}return t=c,n=s,i=f,void(null!=p?kt(e,!!n,p,!1):!!i!=!!n&&(null!=t?kt(e,!!n,t,!0):kt(e,!!n,n?[]:"",!1)));case"textarea":for(c in f=p=null,n)if(r=n[c],n.hasOwnProperty(c)&&null!=r&&!i.hasOwnProperty(c))switch(c){case"value":case"children":break;default:ld(e,t,c,null,i,r)}for(s in i)if(r=i[s],o=n[s],i.hasOwnProperty(s)&&(null!=r||null!=o))switch(s){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(a(91));break;default:r!==o&&ld(e,t,s,r,i,o)}return void wt(e,p,f);case"option":for(var m in n)p=n[m],n.hasOwnProperty(m)&&null!=p&&!i.hasOwnProperty(m)&&("selected"===m?e.selected=!1:ld(e,t,m,null,i,p));for(l in i)p=i[l],f=n[l],!i.hasOwnProperty(l)||p===f||null==p&&null==f||("selected"===l?e.selected=p&&"function"!=typeof p&&"symbol"!=typeof p:ld(e,t,l,p,i,f));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!i.hasOwnProperty(g)&&ld(e,t,g,null,i,p);for(u in i)if(p=i[u],f=n[u],i.hasOwnProperty(u)&&p!==f&&(null!=p||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:ld(e,t,u,p,i,f)}return;default:if(Rt(t)){for(var v in n)p=n[v],n.hasOwnProperty(v)&&void 0!==p&&!i.hasOwnProperty(v)&&ud(e,t,v,void 0,i,p);for(d in i)p=i[d],f=n[d],!i.hasOwnProperty(d)||p===f||void 0===p&&void 0===f||ud(e,t,d,p,i,f);return}}for(var y in n)p=n[y],n.hasOwnProperty(y)&&null!=p&&!i.hasOwnProperty(y)&&ld(e,t,y,null,i,p);for(h in i)p=i[h],f=n[h],!i.hasOwnProperty(h)||p===f||null==p&&null==f||ld(e,t,h,p,i,f)}(i,e.type,n,t),i[ze]=t}catch(t){Su(e,e.return,t)}}function Tc(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Ed(e.type)||4===e.tag}function Cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Tc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Ed(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Ec(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=It));else if(4!==i&&(27===i&&Ed(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Ec(e,t,n),e=e.sibling;null!==e;)Ec(e,t,n),e=e.sibling}function Pc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&(27===i&&Ed(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Pc(e,t,n),e=e.sibling;null!==e;)Pc(e,t,n),e=e.sibling}function Rc(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);dd(t,i,n),t[Be]=e,t[ze]=n}catch(t){Su(e,e.return,t)}}var xc=!1,_c=!1,Oc=!1,Ic="function"==typeof WeakSet?WeakSet:Set,Nc=null;function Ac(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Gc(e,n),4&i&&mc(5,n);break;case 1:if(Gc(e,n),4&i)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(e){Su(n,n.return,e)}else{var r=Ss(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(e){Su(n,n.return,e)}}64&i&&vc(n),512&i&&bc(n,n.return);break;case 3:if(Gc(e,n),64&i&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Po(e,t)}catch(e){Su(n,n.return,e)}}break;case 27:null===t&&4&i&&Rc(n);case 26:case 5:Gc(e,n),null===t&&4&i&&wc(n),512&i&&bc(n,n.return);break;case 12:Gc(e,n);break;case 31:Gc(e,n),4&i&&Fc(e,n);break;case 13:Gc(e,n),4&i&&Bc(e,n),64&i&&null!==(e=n.memoizedState)&&null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}(e,n=Pu.bind(null,n));break;case 22:if(!(i=null!==n.memoizedState||xc)){t=null!==t&&null!==t.memoizedState||_c,r=xc;var o=_c;xc=i,(_c=t)&&!o?$c(e,n,!!(8772&n.subtreeFlags)):Gc(e,n),xc=r,_c=o}break;case 30:break;default:Gc(e,n)}}function Dc(e){var t=e.alternate;null!==t&&(e.alternate=null,Dc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&Je(t),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Lc=null,Mc=!1;function Uc(e,t,n){for(n=n.child;null!==n;)jc(e,t,n),n=n.sibling}function jc(e,t,n){if(ve&&"function"==typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(ge,n)}catch(e){}switch(n.tag){case 26:_c||kc(n,t),Uc(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:_c||kc(n,t);var i=Lc,r=Mc;Ed(n.type)&&(Lc=n.stateNode,Mc=!1),Uc(e,t,n),Ud(n.stateNode),Lc=i,Mc=r;break;case 5:_c||kc(n,t);case 6:if(i=Lc,r=Mc,Lc=null,Uc(e,t,n),Mc=r,null!==(Lc=i))if(Mc)try{(9===Lc.nodeType?Lc.body:"HTML"===Lc.nodeName?Lc.ownerDocument.body:Lc).removeChild(n.stateNode)}catch(e){Su(n,t,e)}else try{Lc.removeChild(n.stateNode)}catch(e){Su(n,t,e)}break;case 18:null!==Lc&&(Mc?(Pd(9===(e=Lc).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),zh(e)):Pd(Lc,n.stateNode));break;case 4:i=Lc,r=Mc,Lc=n.stateNode.containerInfo,Mc=!0,Uc(e,t,n),Lc=i,Mc=r;break;case 0:case 11:case 14:case 15:gc(2,n,t),_c||gc(4,n,t),Uc(e,t,n);break;case 1:_c||(kc(n,t),"function"==typeof(i=n.stateNode).componentWillUnmount&&yc(n,t,i)),Uc(e,t,n);break;case 21:Uc(e,t,n);break;case 22:_c=(i=_c)||null!==n.memoizedState,Uc(e,t,n),_c=i;break;default:Uc(e,t,n)}}function Fc(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)){e=e.dehydrated;try{zh(e)}catch(e){Su(t,t.return,e)}}}function Bc(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))try{zh(e)}catch(e){Su(t,t.return,e)}}function zc(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Ic),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Ic),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var i=Ru.bind(null,e,t);t.then(i,i)}})}function qc(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i],o=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 27:if(Ed(c.type)){Lc=c.stateNode,Mc=!1;break e}break;case 5:Lc=c.stateNode,Mc=!1;break e;case 3:case 4:Lc=c.stateNode.containerInfo,Mc=!0;break e}c=c.return}if(null===Lc)throw Error(a(160));jc(o,s,r),Lc=null,Mc=!1,null!==(o=r.alternate)&&(o.return=null),r.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Hc(t,e),t=t.sibling}var Vc=null;function Hc(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:qc(t,e),Wc(e),4&i&&(gc(3,e,e.return),mc(3,e),gc(5,e,e.return));break;case 1:qc(t,e),Wc(e),512&i&&(_c||null===n||kc(n,n.return)),64&i&&xc&&null!==(e=e.updateQueue)&&null!==(i=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?i:n.concat(i));break;case 26:var r=Vc;if(qc(t,e),Wc(e),512&i&&(_c||null===n||kc(n,n.return)),4&i){var o=null!==n?n.memoizedState:null;if(i=e.memoizedState,null===n)if(null===i)if(null===e.stateNode){e:{i=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":(!(o=r.getElementsByTagName("title")[0])||o[Ge]||o[Be]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=r.createElement(i),r.head.insertBefore(o,r.querySelector("head > title"))),dd(o,i,n),o[Be]=e,Ze(o),i=o;break e;case"link":var s=th("link","href",r).get(i+(n.href||""));if(s)for(var c=0;c<s.length;c++)if((o=s[c]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(c,1);break t}dd(o=r.createElement(i),i,n),r.head.appendChild(o);break;case"meta":if(s=th("meta","content",r).get(i+(n.content||"")))for(c=0;c<s.length;c++)if((o=s[c]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(c,1);break t}dd(o=r.createElement(i),i,n),r.head.appendChild(o);break;default:throw Error(a(468,i))}o[Be]=e,Ze(o),i=o}e.stateNode=i}else nh(r,e.type,e.stateNode);else e.stateNode=Qd(r,i,e.memoizedProps);else o!==i?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===i?nh(r,e.type,e.stateNode):Qd(r,i,e.memoizedProps)):null===i&&null!==e.stateNode&&Sc(e,e.memoizedProps,n.memoizedProps)}break;case 27:qc(t,e),Wc(e),512&i&&(_c||null===n||kc(n,n.return)),null!==n&&4&i&&Sc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(qc(t,e),Wc(e),512&i&&(_c||null===n||kc(n,n.return)),32&e.flags){r=e.stateNode;try{Tt(r,"")}catch(t){Su(e,e.return,t)}}4&i&&null!=e.stateNode&&Sc(e,r=e.memoizedProps,null!==n?n.memoizedProps:r),1024&i&&(Oc=!0);break;case 6:if(qc(t,e),Wc(e),4&i){if(null===e.stateNode)throw Error(a(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(t){Su(e,e.return,t)}}break;case 3:if(eh=null,r=Vc,Vc=Bd(t.containerInfo),qc(t,e),Vc=r,Wc(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{zh(t.containerInfo)}catch(t){Su(e,e.return,t)}Oc&&(Oc=!1,Kc(e));break;case 4:i=Vc,Vc=Bd(e.stateNode.containerInfo),qc(t,e),Wc(e),Vc=i;break;case 12:default:qc(t,e),Wc(e);break;case 31:case 19:qc(t,e),Wc(e),4&i&&null!==(i=e.updateQueue)&&(e.updateQueue=null,zc(e,i));break;case 13:qc(t,e),Wc(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Il=se()),4&i&&null!==(i=e.updateQueue)&&(e.updateQueue=null,zc(e,i));break;case 22:r=null!==e.memoizedState;var l=null!==n&&null!==n.memoizedState,u=xc,d=_c;if(xc=u||r,_c=d||l,qc(t,e),_c=d,xc=u,Wc(e),8192&i)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===n||l||xc||_c||Jc(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){l=n=t;try{if(o=l.stateNode,r)"function"==typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{c=l.stateNode;var h=l.memoizedProps.style,p=null!=h&&h.hasOwnProperty("display")?h.display:null;c.style.display=null==p||"boolean"==typeof p?"":(""+p).trim()}}catch(e){Su(l,l.return,e)}}}else if(6===t.tag){if(null===n){l=t;try{l.stateNode.nodeValue=r?"":l.memoizedProps}catch(e){Su(l,l.return,e)}}}else if(18===t.tag){if(null===n){l=t;try{var f=l.stateNode;r?Rd(f,!0):Rd(l.stateNode,!1)}catch(e){Su(l,l.return,e)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&i&&null!==(i=e.updateQueue)&&null!==(n=i.retryQueue)&&(i.retryQueue=null,zc(e,n));case 30:case 21:}}function Wc(e){var t=e.flags;if(2&t){try{for(var n,i=e.return;null!==i;){if(Tc(i)){n=i;break}i=i.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var r=n.stateNode;Pc(e,Cc(e),r);break;case 5:var o=n.stateNode;32&n.flags&&(Tt(o,""),n.flags&=-33),Pc(e,Cc(e),o);break;case 3:case 4:var s=n.stateNode.containerInfo;Ec(e,Cc(e),s);break;default:throw Error(a(161))}}catch(t){Su(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kc(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kc(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Gc(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ac(e,t.alternate,t),t=t.sibling}function Jc(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:gc(4,t,t.return),Jc(t);break;case 1:kc(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&yc(t,t.return,n),Jc(t);break;case 27:Ud(t.stateNode);case 26:case 5:kc(t,t.return),Jc(t);break;case 22:null===t.memoizedState&&Jc(t);break;default:Jc(t)}e=e.sibling}}function $c(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var i=t.alternate,r=e,o=t,a=o.flags;switch(o.tag){case 0:case 11:case 15:$c(r,o,n),mc(4,o);break;case 1:if($c(r,o,n),"function"==typeof(r=(i=o).stateNode).componentDidMount)try{r.componentDidMount()}catch(e){Su(i,i.return,e)}if(null!==(r=(i=o).updateQueue)){var s=i.stateNode;try{var c=r.shared.hiddenCallbacks;if(null!==c)for(r.shared.hiddenCallbacks=null,r=0;r<c.length;r++)Eo(c[r],s)}catch(e){Su(i,i.return,e)}}n&&64&a&&vc(o),bc(o,o.return);break;case 27:Rc(o);case 26:case 5:$c(r,o,n),n&&null===i&&4&a&&wc(o),bc(o,o.return);break;case 12:$c(r,o,n);break;case 31:$c(r,o,n),n&&4&a&&Fc(r,o);break;case 13:$c(r,o,n),n&&4&a&&Bc(r,o);break;case 22:null===o.memoizedState&&$c(r,o,n),bc(o,o.return);break;case 30:break;default:$c(r,o,n)}t=t.sibling}}function Qc(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Fr(n))}function Yc(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Fr(e))}function Xc(e,t,n,i){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Zc(e,t,n,i),t=t.sibling}function Zc(e,t,n,i){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Xc(e,t,n,i),2048&r&&mc(9,t);break;case 1:case 31:case 13:default:Xc(e,t,n,i);break;case 3:Xc(e,t,n,i),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Fr(e)));break;case 12:if(2048&r){Xc(e,t,n,i),e=t.stateNode;try{var o=t.memoizedProps,a=o.id,s=o.onPostCommit;"function"==typeof s&&s(a,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(e){Su(t,t.return,e)}}else Xc(e,t,n,i);break;case 23:break;case 22:o=t.stateNode,a=t.alternate,null!==t.memoizedState?2&o._visibility?Xc(e,t,n,i):tl(e,t):2&o._visibility?Xc(e,t,n,i):(o._visibility|=2,el(e,t,n,i,!!(10256&t.subtreeFlags)||!1)),2048&r&&Qc(a,t);break;case 24:Xc(e,t,n,i),2048&r&&Yc(t.alternate,t)}}function el(e,t,n,i,r){for(r=r&&(!!(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var o=e,a=t,s=n,c=i,l=a.flags;switch(a.tag){case 0:case 11:case 15:el(o,a,s,c,r),mc(8,a);break;case 23:break;case 22:var u=a.stateNode;null!==a.memoizedState?2&u._visibility?el(o,a,s,c,r):tl(o,a):(u._visibility|=2,el(o,a,s,c,r)),r&&2048&l&&Qc(a.alternate,a);break;case 24:el(o,a,s,c,r),r&&2048&l&&Yc(a.alternate,a);break;default:el(o,a,s,c,r)}t=t.sibling}}function tl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,i=t,r=i.flags;switch(i.tag){case 22:tl(n,i),2048&r&&Qc(i.alternate,i);break;case 24:tl(n,i),2048&r&&Yc(i.alternate,i);break;default:tl(n,i)}t=t.sibling}}var nl=8192;function il(e,t,n){if(e.subtreeFlags&nl)for(e=e.child;null!==e;)rl(e,t,n),e=e.sibling}function rl(e,t,n){switch(e.tag){case 26:il(e,t,n),e.flags&nl&&null!==e.memoizedState&&function(e,t,n,i){if(!("stylesheet"!==n.type||"string"==typeof i.media&&!1===matchMedia(i.media).matches||4&n.state.loading)){if(null===n.instance){var r=Wd(i.href),o=t.querySelector(Kd(r));if(o)return null!==(t=o._p)&&"object"==typeof t&&"function"==typeof t.then&&(e.count++,e=oh.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=o,void Ze(o);o=t.ownerDocument||t,i=Gd(i),(r=jd.get(r))&&Xd(i,r),Ze(o=o.createElement("link"));var a=o;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),dd(o,"link",i),n.instance=o}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&!(3&n.state.loading)&&(e.count++,n=oh.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Vc,e.memoizedState,e.memoizedProps);break;case 5:default:il(e,t,n);break;case 3:case 4:var i=Vc;Vc=Bd(e.stateNode.containerInfo),il(e,t,n),Vc=i;break;case 22:null===e.memoizedState&&(null!==(i=e.alternate)&&null!==i.memoizedState?(i=nl,nl=16777216,il(e,t,n),nl=i):il(e,t,n))}}function ol(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function al(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Nc=i,ll(i,e)}ol(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)sl(e),e=e.sibling}function sl(e){switch(e.tag){case 0:case 11:case 15:al(e),2048&e.flags&&gc(9,e,e.return);break;case 3:case 12:default:al(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cl(e)):al(e)}}function cl(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Nc=i,ll(i,e)}ol(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:gc(8,t,t.return),cl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,cl(t));break;default:cl(t)}e=e.sibling}}function ll(e,t){for(;null!==Nc;){var n=Nc;switch(n.tag){case 0:case 11:case 15:gc(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var i=n.memoizedState.cachePool.pool;null!=i&&i.refCount++}break;case 24:Fr(n.memoizedState.cache)}if(null!==(i=n.child))i.return=n,Nc=i;else e:for(n=e;null!==Nc;){var r=(i=Nc).sibling,o=i.return;if(Dc(i),i===n){Nc=null;break e}if(null!==r){r.return=o,Nc=r;break e}Nc=o}}}var ul={getCacheForType:function(e){var t=Ir(Ur),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Ir(Ur).controller.signal}},dl="function"==typeof WeakMap?WeakMap:Map,hl=0,pl=null,fl=null,ml=0,gl=0,vl=null,yl=!1,bl=!1,kl=!1,wl=0,Sl=0,Tl=0,Cl=0,El=0,Pl=0,Rl=0,xl=null,_l=null,Ol=!1,Il=0,Nl=0,Al=1/0,Dl=null,Ll=null,Ml=0,Ul=null,jl=null,Fl=0,Bl=0,zl=null,ql=null,Vl=0,Hl=null;function Wl(){return 2&hl&&0!==ml?ml&-ml:null!==A.T?zu():Ue()}function Kl(){if(0===Pl)if(536870912&ml&&!ur)Pl=536870912;else{var e=Te;!(3932160&(Te<<=1))&&(Te=262144),Pl=e}return null!==(e=No.current)&&(e.flags|=32),Pl}function Gl(e,t,n){(e!==pl||2!==gl&&9!==gl)&&null===e.cancelPendingCommit||(eu(e,0),Yl(e,ml,Pl,!1)),Ie(e,n),2&hl&&e===pl||(e===pl&&(!(2&hl)&&(Cl|=n),4===Sl&&Yl(e,ml,Pl,!1)),Du(e))}function Jl(e,t,n){if(6&hl)throw Error(a(327));for(var i=!n&&!(127&t)&&0===(t&e.expiredLanes)||Re(e,t),r=i?function(e,t){var n=hl;hl|=2;var i=iu(),r=ru();pl!==e||ml!==t?(Dl=null,Al=se()+500,eu(e,t)):bl=Re(e,t);e:for(;;)try{if(0!==gl&&null!==fl){t=fl;var o=vl;t:switch(gl){case 1:gl=0,vl=null,du(e,t,o,1);break;case 2:case 9:if(eo(o)){gl=0,vl=null,uu(t);break}t=function(){2!==gl&&9!==gl||pl!==e||(gl=7),Du(e)},o.then(t,t);break e;case 3:gl=7;break e;case 4:gl=5;break e;case 7:eo(o)?(gl=0,vl=null,uu(t)):(gl=0,vl=null,du(e,t,o,7));break;case 5:var s=null;switch(fl.tag){case 26:s=fl.memoizedState;case 5:case 27:var c=fl;if(s?ih(s):c.stateNode.complete){gl=0,vl=null;var l=c.sibling;if(null!==l)fl=l;else{var u=c.return;null!==u?(fl=u,hu(u)):fl=null}break t}}gl=0,vl=null,du(e,t,o,5);break;case 6:gl=0,vl=null,du(e,t,o,6);break;case 8:Zl(),Sl=6;break e;default:throw Error(a(462))}}cu();break}catch(t){tu(e,t)}return Tr=Sr=null,A.H=i,A.A=r,hl=n,null!==fl?0:(pl=null,ml=0,_i(),Sl)}(e,t):au(e,t,!0),o=i;;){if(0===r){bl&&!i&&Yl(e,t,0,!1);break}if(n=e.current.alternate,!o||Ql(n)){if(2===r){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!=(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var c=e;r=xl;var l=c.current.memoizedState.isDehydrated;if(l&&(eu(c,s).flags|=256),2!==(s=au(c,s,!1))){if(kl&&!l){c.errorRecoveryDisabledLanes|=o,Cl|=o,r=4;break e}o=_l,_l=r,null!==o&&(null===_l?_l=o:_l.push.apply(_l,o))}r=s}if(o=!1,2!==r)continue}}if(1===r){eu(e,0),Yl(e,t,0,!0);break}e:{switch(i=e,o=r){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:Yl(i,t,Pl,!yl);break e;case 2:_l=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(r=Il+300-se())){if(Yl(i,t,Pl,!yl),0!==Pe(i,0,!0))break e;Fl=t,i.timeoutHandle=kd($l.bind(null,i,n,_l,Dl,Ol,t,Pl,Cl,Rl,yl,o,"Throttled",-0,0),r)}else $l(i,n,_l,Dl,Ol,t,Pl,Cl,Rl,yl,o,null,-0,0)}break}r=au(e,t,!1),o=!1}Du(e)}function $l(e,t,n,i,r,o,a,s,c,l,u,d,h,p){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||!(16785408&~d)){rl(t,o,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:It});var f=(62914560&o)===o?Il-se():(4194048&o)===o?Nl-se():0;if(null!==(f=function(e,t){return e.stylesheets&&0===e.count&&sh(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&sh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===rh&&(rh=62500*function(){if("function"==typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var r=n[i],o=r.transferSize,a=r.initiatorType,s=r.duration;if(o&&s&&hd(a)){for(a=0,s=r.responseEnd,i+=1;i<n.length;i++){var c=n[i],l=c.startTime;if(l>s)break;var u=c.transferSize,d=c.initiatorType;u&&hd(d)&&(a+=u*((c=c.responseEnd)<s?1:(s-l)/(c-l)))}if(--i,t+=8*(o+a)/(r.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"==typeof(e=navigator.connection.downlink)?e:5}());var r=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&sh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>rh?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(r)}}:null}(d,f)))return Fl=o,e.cancelPendingCommit=f(fu.bind(null,e,t,o,n,i,r,a,s,c,u,d,null,h,p)),void Yl(e,o,a,!l)}fu(e,t,o,n,i,r,a,s,c)}function Ql(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&null!==(n=t.updateQueue)&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!Yn(o(),r))return!1}catch(e){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Yl(e,t,n,i){t&=~El,t&=~Cl,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var r=t;0<r;){var o=31-be(r),a=1<<o;i[o]=-1,r&=~a}0!==n&&Ne(e,n,t)}function Xl(){return!!(6&hl)||(Lu(0,!1),!1)}function Zl(){if(null!==fl){if(0===gl)var e=fl.return;else Tr=Sr=null,aa(e=fl),ao=null,so=0,e=fl;for(;null!==e;)fc(e.alternate,e),e=e.return;fl=null}}function eu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,wd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Fl=0,Zl(),pl=e,fl=n=Fi(e.current,null),ml=t,gl=0,vl=null,yl=!1,bl=Re(e,t),kl=!1,Rl=Pl=El=Cl=Tl=Sl=0,_l=xl=null,Ol=!1,8&t&&(t|=32&t);var i=e.entangledLanes;if(0!==i)for(e=e.entanglements,i&=t;0<i;){var r=31-be(i),o=1<<r;t|=e[r],i&=~o}return wl=t,_i(),n}function tu(e,t){qo=null,A.H=fs,t===Qr||t===Xr?(t=ro(),gl=3):t===Yr?(t=ro(),gl=4):gl=t===Is?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,vl=t,null===fl&&(Sl=1,Ps(e,Gi(t,e.current)))}function nu(){var e=No.current;return null===e||((4194048&ml)===ml?null===Ao:!!((62914560&ml)===ml||536870912&ml)&&e===Ao)}function iu(){var e=A.H;return A.H=fs,null===e?fs:e}function ru(){var e=A.A;return A.A=ul,e}function ou(){Sl=4,yl||(4194048&ml)!==ml&&null!==No.current||(bl=!0),!(134217727&Tl)&&!(134217727&Cl)||null===pl||Yl(pl,ml,Pl,!1)}function au(e,t,n){var i=hl;hl|=2;var r=iu(),o=ru();pl===e&&ml===t||(Dl=null,eu(e,t)),t=!1;var a=Sl;e:for(;;)try{if(0!==gl&&null!==fl){var s=fl,c=vl;switch(gl){case 8:Zl(),a=6;break e;case 3:case 2:case 9:case 6:null===No.current&&(t=!0);var l=gl;if(gl=0,vl=null,du(e,s,c,l),n&&bl){a=0;break e}break;default:l=gl,gl=0,vl=null,du(e,s,c,l)}}su(),a=Sl;break}catch(t){tu(e,t)}return t&&e.shellSuspendCounter++,Tr=Sr=null,hl=i,A.H=r,A.A=o,null===fl&&(pl=null,ml=0,_i()),a}function su(){for(;null!==fl;)lu(fl)}function cu(){for(;null!==fl&&!oe();)lu(fl)}function lu(e){var t=oc(e.alternate,e,wl);e.memoizedProps=e.pendingProps,null===t?hu(e):fl=t}function uu(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Hs(n,t,t.pendingProps,t.type,void 0,ml);break;case 11:t=Hs(n,t,t.pendingProps,t.type.render,t.ref,ml);break;case 5:aa(t);default:fc(n,t),t=oc(n,t=fl=Bi(t,wl),wl)}e.memoizedProps=e.pendingProps,null===t?hu(e):fl=t}function du(e,t,n,i){Tr=Sr=null,aa(t),ao=null,so=0;var r=t.return;try{if(function(e,t,n,i,r){if(n.flags|=32768,null!==i&&"object"==typeof i&&"function"==typeof i.then){if(null!==(t=n.alternate)&&xr(t,n,r,!0),null!==(n=No.current)){switch(n.tag){case 31:case 13:return null===Ao?ou():null===n.alternate&&0===Sl&&(Sl=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===Zr?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([i]):t.add(i),Tu(e,i,r)),!1;case 22:return n.flags|=65536,i===Zr?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([i]):n.add(i),Tu(e,i,r)),!1}throw Error(a(435,n.tag))}return Tu(e,i,r),ou(),!1}if(ur)return null!==(t=No.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,i!==pr&&kr(Gi(e=Error(a(422),{cause:i}),n))):(i!==pr&&kr(Gi(t=Error(a(423),{cause:i}),n)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,i=Gi(i,n),wo(e,r=xs(e.stateNode,i,r)),4!==Sl&&(Sl=2)),!1;var o=Error(a(520),{cause:i});if(o=Gi(o,n),null===xl?xl=[o]:xl.push(o),4!==Sl&&(Sl=2),null===t)return!0;i=Gi(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,wo(n,e=xs(n.stateNode,i,e)),!1;case 1:if(t=n.type,o=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===o||"function"!=typeof o.componentDidCatch||null!==Ll&&Ll.has(o))))return n.flags|=65536,r&=-r,n.lanes|=r,Os(r=_s(r),e,n,i),wo(n,r),!1}n=n.return}while(null!==n);return!1}(e,r,t,n,ml))return Sl=1,Ps(e,Gi(n,e.current)),void(fl=null)}catch(t){if(null!==r)throw fl=r,t;return Sl=1,Ps(e,Gi(n,e.current)),void(fl=null)}32768&t.flags?(ur||1===i?e=!0:bl||536870912&ml?e=!1:(yl=e=!0,(2===i||9===i||3===i||6===i)&&null!==(i=No.current)&&13===i.tag&&(i.flags|=16384)),pu(t,e)):hu(t)}function hu(e){var t=e;do{if(32768&t.flags)return void pu(t,yl);e=t.return;var n=hc(t.alternate,t,wl);if(null!==n)return void(fl=n);if(null!==(t=t.sibling))return void(fl=t);fl=t=e}while(null!==t);0===Sl&&(Sl=5)}function pu(e,t){do{var n=pc(e.alternate,e);if(null!==n)return n.flags&=32767,void(fl=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(fl=e);fl=e=n}while(null!==e);Sl=6,fl=null}function fu(e,t,n,i,r,o,s,c,l){e.cancelPendingCommit=null;do{bu()}while(0!==Ml);if(6&hl)throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(o=t.lanes|t.childLanes,function(e,t,n,i,r,o){var a=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,c=e.expirationTimes,l=e.hiddenUpdates;for(n=a&~n;0<n;){var u=31-be(n),d=1<<u;s[u]=0,c[u]=-1;var h=l[u];if(null!==h)for(l[u]=null,u=0;u<h.length;u++){var p=h[u];null!==p&&(p.lane&=-536870913)}n&=~d}0!==i&&Ne(e,i,0),0!==o&&0===r&&0!==e.tag&&(e.suspendedLanes|=o&~(a&~t))}(e,n,o|=xi,s,c,l),e===pl&&(fl=pl=null,ml=0),jl=t,Ul=e,Fl=n,Bl=o,zl=r,ql=i,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,ie(de,function(){return ku(),null})):(e.callbackNode=null,e.callbackPriority=0),i=!!(13878&t.flags),13878&t.subtreeFlags||i){i=A.T,A.T=null,r=D.p,D.p=2,s=hl,hl|=4;try{!function(e,t){if(e=e.containerInfo,pd=gh,ii(e=ni(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(e){n=null;break e}var s=0,c=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(c=s+r),h!==o||0!==i&&3!==h.nodeType||(l=s+i),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===r&&(c=s),p===o&&++d===i&&(l=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(fd={focusedElem:e,selectionRange:n},gh=!1,Nc=t;null!==Nc;)if(e=(t=Nc).child,1028&t.subtreeFlags&&null!==e)e.return=t,Nc=e;else for(;null!==Nc;){switch(o=(t=Nc).alternate,e=t.flags,t.tag){case 0:if(4&e&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(r=e[n]).ref.impl=r.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==o){e=void 0,n=t,r=o.memoizedProps,o=o.memoizedState,i=n.stateNode;try{var m=Ss(n.type,r);e=i.getSnapshotBeforeUpdate(m,o),i.__reactInternalSnapshotBeforeUpdate=e}catch(e){Su(n,n.return,e)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))xd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":xd(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Nc=e;break}Nc=t.return}}(e,t)}finally{hl=s,D.p=r,A.T=i}}Ml=1,mu(),gu(),vu()}}function mu(){if(1===Ml){Ml=0;var e=Ul,t=jl,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=A.T,A.T=null;var i=D.p;D.p=2;var r=hl;hl|=4;try{Hc(t,e);var o=fd,a=ni(e.containerInfo),s=o.focusedElem,c=o.selectionRange;if(a!==s&&s&&s.ownerDocument&&ti(s.ownerDocument.documentElement,s)){if(null!==c&&ii(s)){var l=c.start,u=c.end;if(void 0===u&&(u=l),"selectionStart"in s)s.selectionStart=l,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var p=h.getSelection(),f=s.textContent.length,m=Math.min(c.start,f),g=void 0===c.end?m:Math.min(c.end,f);!p.extend&&m>g&&(a=g,g=m,m=a);var v=ei(s,m),y=ei(s,g);if(v&&y&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),p.removeAllRanges(),m>g?(p.addRange(b),p.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),p.addRange(b))}}}}for(d=[],p=s;p=p.parentNode;)1===p.nodeType&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"==typeof s.focus&&s.focus(),s=0;s<d.length;s++){var k=d[s];k.element.scrollLeft=k.left,k.element.scrollTop=k.top}}gh=!!pd,fd=pd=null}finally{hl=r,D.p=i,A.T=n}}e.current=t,Ml=2}}function gu(){if(2===Ml){Ml=0;var e=Ul,t=jl,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=A.T,A.T=null;var i=D.p;D.p=2;var r=hl;hl|=4;try{Ac(e,t.alternate,t)}finally{hl=r,D.p=i,A.T=n}}Ml=3}}function vu(){if(4===Ml||3===Ml){Ml=0,ae();var e=Ul,t=jl,n=Fl,i=ql;10256&t.subtreeFlags||10256&t.flags?Ml=5:(Ml=0,jl=Ul=null,yu(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(Ll=null),Me(n),t=t.stateNode,ve&&"function"==typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(ge,t,void 0,!(128&~t.current.flags))}catch(e){}if(null!==i){t=A.T,r=D.p,D.p=2,A.T=null;try{for(var o=e.onRecoverableError,a=0;a<i.length;a++){var s=i[a];o(s.value,{componentStack:s.stack})}}finally{A.T=t,D.p=r}}3&Fl&&bu(),Du(e),r=e.pendingLanes,261930&n&&42&r?e===Hl?Vl++:(Vl=0,Hl=e):Vl=0,Lu(0,!1)}}function yu(e,t){0===(e.pooledCacheLanes&=t)&&null!=(t=e.pooledCache)&&(e.pooledCache=null,Fr(t))}function bu(){return mu(),gu(),vu(),ku()}function ku(){if(5!==Ml)return!1;var e=Ul,t=Bl;Bl=0;var n=Me(Fl),i=A.T,r=D.p;try{D.p=32>n?32:n,A.T=null,n=zl,zl=null;var o=Ul,s=Fl;if(Ml=0,jl=Ul=null,Fl=0,6&hl)throw Error(a(331));var c=hl;if(hl|=4,sl(o.current),Zc(o,o.current,s,n),hl=c,Lu(0,!1),ve&&"function"==typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(ge,o)}catch(e){}return!0}finally{D.p=r,A.T=i,yu(e,t)}}function wu(e,t,n){t=Gi(n,t),null!==(e=bo(e,t=xs(e.stateNode,t,2),2))&&(Ie(e,2),Du(e))}function Su(e,t,n){if(3===e.tag)wu(e,e,n);else for(;null!==t;){if(3===t.tag){wu(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Ll||!Ll.has(i))){e=Gi(n,e),null!==(i=bo(t,n=_s(2),2))&&(Os(n,i,t,e),Ie(i,2),Du(i));break}}t=t.return}}function Tu(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new dl;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(kl=!0,r.add(n),e=Cu.bind(null,e,t,n),t.then(e,e))}function Cu(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,pl===e&&(ml&n)===n&&(4===Sl||3===Sl&&(62914560&ml)===ml&&300>se()-Il?!(2&hl)&&eu(e,0):El|=n,Rl===ml&&(Rl=0)),Du(e)}function Eu(e,t){0===t&&(t=_e()),null!==(e=Ni(e,t))&&(Ie(e,t),Du(e))}function Pu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Eu(e,n)}function Ru(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==i&&i.delete(t),Eu(e,n)}var xu=null,_u=null,Ou=!1,Iu=!1,Nu=!1,Au=0;function Du(e){e!==_u&&null===e.next&&(null===_u?xu=_u=e:_u=_u.next=e),Iu=!0,Ou||(Ou=!0,Td(function(){6&hl?ie(le,Mu):Uu()}))}function Lu(e,t){if(!Nu&&Iu){Nu=!0;do{for(var n=!1,i=xu;null!==i;){if(!t)if(0!==e){var r=i.pendingLanes;if(0===r)var o=0;else{var a=i.suspendedLanes,s=i.pingedLanes;o=(1<<31-be(42|e)+1)-1,o=201326741&(o&=r&~(a&~s))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,Bu(i,o))}else o=ml,!(3&(o=Pe(i,i===pl?o:0,null!==i.cancelPendingCommit||-1!==i.timeoutHandle)))||Re(i,o)||(n=!0,Bu(i,o));i=i.next}}while(n);Nu=!1}}function Mu(){Uu()}function Uu(){Iu=Ou=!1;var e,t=0;0!==Au&&((e=window.event)&&"popstate"===e.type?e!==bd&&(bd=e,1):(bd=null,0))&&(t=Au);for(var n=se(),i=null,r=xu;null!==r;){var o=r.next,a=ju(r,n);0===a?(r.next=null,null===i?xu=o:i.next=o,null===o&&(_u=i)):(i=r,(0!==t||3&a)&&(Iu=!0)),r=o}0!==Ml&&5!==Ml||Lu(t,!1),0!==Au&&(Au=0)}function ju(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var a=31-be(o),s=1<<a,c=r[a];-1===c?0!==(s&n)&&0===(s&i)||(r[a]=xe(s,t)):c<=t&&(e.expiredLanes|=s),o&=~s}if(n=ml,n=Pe(e,e===(t=pl)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),i=e.callbackNode,0===n||e===t&&(2===gl||9===gl)||null!==e.cancelPendingCommit)return null!==i&&null!==i&&re(i),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||Re(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==i&&re(i),Me(n)){case 2:case 8:n=ue;break;case 32:default:n=de;break;case 268435456:n=pe}return i=Fu.bind(null,e),n=ie(n,i),e.callbackPriority=t,e.callbackNode=n,t}return null!==i&&null!==i&&re(i),e.callbackPriority=2,e.callbackNode=null,2}function Fu(e,t){if(0!==Ml&&5!==Ml)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(bu()&&e.callbackNode!==n)return null;var i=ml;return 0===(i=Pe(e,e===pl?i:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Jl(e,i,t),ju(e,se()),null!=e.callbackNode&&e.callbackNode===n?Fu.bind(null,e):null)}function Bu(e,t){if(bu())return null;Jl(e,t,!0)}function zu(){if(0===Au){var e=qr;0===e&&(e=Se,!(261888&(Se<<=1))&&(Se=256)),Au=e}return Au}function qu(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Ot(""+e)}function Vu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Hu=0;Hu<Ti.length;Hu++){var Wu=Ti[Hu];Ci(Wu.toLowerCase(),"on"+(Wu[0].toUpperCase()+Wu.slice(1)))}Ci(mi,"onAnimationEnd"),Ci(gi,"onAnimationIteration"),Ci(vi,"onAnimationStart"),Ci("dblclick","onDoubleClick"),Ci("focusin","onFocus"),Ci("focusout","onBlur"),Ci(yi,"onTransitionRun"),Ci(bi,"onTransitionStart"),Ci(ki,"onTransitionCancel"),Ci(wi,"onTransitionEnd"),it("onMouseEnter",["mouseout","mouseover"]),it("onMouseLeave",["mouseout","mouseover"]),it("onPointerEnter",["pointerout","pointerover"]),it("onPointerLeave",["pointerout","pointerover"]),nt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nt("onBeforeInput",["compositionend","keypress","textInput","paste"]),nt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ku));function Ju(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var a=i.length-1;0<=a;a--){var s=i[a],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==o&&r.isPropagationStopped())break e;o=s,r.currentTarget=l;try{o(r)}catch(e){Ei(e)}r.currentTarget=null,o=c}else for(a=0;a<i.length;a++){if(c=(s=i[a]).instance,l=s.currentTarget,s=s.listener,c!==o&&r.isPropagationStopped())break e;o=s,r.currentTarget=l;try{o(r)}catch(e){Ei(e)}r.currentTarget=null,o=c}}}}function $u(e,t){var n=t[Ve];void 0===n&&(n=t[Ve]=new Set);var i=e+"__bubble";n.has(i)||(Zu(t,e,2,!1),n.add(i))}function Qu(e,t,n){var i=0;t&&(i|=4),Zu(n,e,i,t)}var Yu="_reactListening"+Math.random().toString(36).slice(2);function Xu(e){if(!e[Yu]){e[Yu]=!0,et.forEach(function(t){"selectionchange"!==t&&(Gu.has(t)||Qu(t,!1,e),Qu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Yu]||(t[Yu]=!0,Qu("selectionchange",!1,t))}}function Zu(e,t,n,i){switch(Th(t)){case 2:var r=vh;break;case 8:r=yh;break;default:r=bh}n=r.bind(null,t,n,e),r=void 0,!zt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function ed(e,t,n,i,r){var o=i;if(!(1&t||2&t||null===i))e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var c=i.stateNode.containerInfo;if(c===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&a.stateNode.containerInfo===r)return;a=a.return}for(;null!==c;){if(null===(a=$e(c)))return;if(5===(l=a.tag)||6===l||26===l||27===l){i=o=a;continue e}c=c.parentNode}}i=i.return}jt(function(){var i=o,r=At(n),a=[];e:{var c=Si.get(e);if(void 0!==c){var l=tn,u=e;switch(e){case"keypress":if(0===Gt(n))break e;case"keydown":case"keyup":l=vn;break;case"focusin":u="focus",l=cn;break;case"focusout":u="blur",l=cn;break;case"beforeblur":case"afterblur":l=cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=an;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=sn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=bn;break;case mi:case gi:case vi:l=ln;break;case wi:l=kn;break;case"scroll":case"scrollend":l=rn;break;case"wheel":l=wn;break;case"copy":case"cut":case"paste":l=un;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=yn;break;case"toggle":case"beforetoggle":l=Sn}var d=!!(4&t),h=!d&&("scroll"===e||"scrollend"===e),p=d?null!==c?c+"Capture":null:c;d=[];for(var f,m=i;null!==m;){var g=m;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===p||null!=(g=Ft(m,p))&&d.push(td(m,g,f)),h)break;m=m.return}0<d.length&&(c=new l(c,u,null,n,r),a.push({event:c,listeners:d}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(c="mouseover"===e||"pointerover"===e)||n===Nt||!(u=n.relatedTarget||n.fromElement)||!$e(u)&&!u[qe])&&(l||c)&&(c=r.window===r?r:(c=r.ownerDocument)?c.defaultView||c.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?$e(u):null)&&(h=s(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(l=null,u=i),l!==u)){if(d=an,g="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=yn,g="onPointerLeave",p="onPointerEnter",m="pointer"),h=null==l?c:Ye(l),f=null==u?c:Ye(u),(c=new d(g,m+"leave",l,n,r)).target=h,c.relatedTarget=f,g=null,$e(r)===i&&((d=new d(p,m+"enter",u,n,r)).target=f,d.relatedTarget=h,g=d),h=g,l&&u)e:{for(d=id,m=u,f=0,g=p=l;g;g=d(g))f++;g=0;for(var v=m;v;v=d(v))g++;for(;0<f-g;)p=d(p),f--;for(;0<g-f;)m=d(m),g--;for(;f--;){if(p===m||null!==m&&p===m.alternate){d=p;break e}p=d(p),m=d(m)}d=null}else d=null;null!==l&&rd(a,c,l,d,!1),null!==u&&null!==h&&rd(a,h,u,d,!0)}if("select"===(l=(c=i?Ye(i):window).nodeName&&c.nodeName.toLowerCase())||"input"===l&&"file"===c.type)var y=Bn;else if(Dn(c))if(zn)y=Qn;else{y=Jn;var b=Gn}else!(l=c.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==c.type&&"radio"!==c.type?i&&Rt(i.elementType)&&(y=Bn):y=$n;switch(y&&(y=y(e,i))?Ln(a,y,n,r):(b&&b(e,c,i),"focusout"===e&&i&&"number"===c.type&&null!=i.memoizedProps.value&&bt(c,"number",c.value)),b=i?Ye(i):window,e){case"focusin":(Dn(b)||"true"===b.contentEditable)&&(oi=b,ai=i,si=null);break;case"focusout":si=ai=oi=null;break;case"mousedown":ci=!0;break;case"contextmenu":case"mouseup":case"dragend":ci=!1,li(a,n,r);break;case"selectionchange":if(ri)break;case"keydown":case"keyup":li(a,n,r)}var k;if(Cn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Nn?On(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Rn&&"ko"!==n.locale&&(Nn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Nn&&(k=Kt()):(Ht="value"in(Vt=r)?Vt.value:Vt.textContent,Nn=!0)),0<(b=nd(i,w)).length&&(w=new dn(w,e,null,n,r),a.push({event:w,listeners:b}),(k||null!==(k=In(n)))&&(w.data=k))),(k=Pn?function(e,t){switch(e){case"compositionend":return In(t);case"keypress":return 32!==t.which?null:(_n=!0,xn);case"textInput":return(e=t.data)===xn&&_n?null:e;default:return null}}(e,n):function(e,t){if(Nn)return"compositionend"===e||!Cn&&On(e,t)?(e=Kt(),Wt=Ht=Vt=null,Nn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Rn&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(w=nd(i,"onBeforeInput")).length&&(b=new dn("onBeforeInput","beforeinput",null,n,r),a.push({event:b,listeners:w}),b.data=k),function(e,t,n,i,r){if("submit"===t&&n&&n.stateNode===r){var o=qu((r[ze]||null).action),a=i.submitter;a&&null!==(t=(t=a[ze]||null)?qu(t.formAction):a.getAttribute("formAction"))&&(o=t,a=null);var s=new tn("action","action",null,i,r);e.push({event:s,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(0!==Au){var e=a?Vu(r,a):new FormData(r);es(n,{pending:!0,data:e,method:r.method,action:o},null,e)}}else"function"==typeof o&&(s.preventDefault(),e=a?Vu(r,a):new FormData(r),es(n,{pending:!0,data:e,method:r.method,action:o},o,e))},currentTarget:r}]})}}(a,e,i,n,r)}Ju(a,t)})}function td(e,t,n){return{instance:e,listener:t,currentTarget:n}}function nd(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,o=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===o||(null!=(r=Ft(e,n))&&i.unshift(td(e,r,o)),null!=(r=Ft(e,t))&&i.push(td(e,r,o))),3===e.tag)return i;e=e.return}return[]}function id(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function rd(e,t,n,i,r){for(var o=t._reactName,a=[];null!==n&&n!==i;){var s=n,c=s.alternate,l=s.stateNode;if(s=s.tag,null!==c&&c===i)break;5!==s&&26!==s&&27!==s||null===l||(c=l,r?null!=(l=Ft(n,o))&&a.unshift(td(n,l,c)):r||null!=(l=Ft(n,o))&&a.push(td(n,l,c))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var od=/\r\n?/g,ad=/\u0000|\uFFFD/g;function sd(e){return("string"==typeof e?e:""+e).replace(od,"\n").replace(ad,"")}function cd(e,t){return t=sd(t),sd(e)===t}function ld(e,t,n,i,r,o){switch(n){case"children":"string"==typeof i?"body"===t||"textarea"===t&&""===i||Tt(e,i):("number"==typeof i||"bigint"==typeof i)&&"body"!==t&&Tt(e,""+i);break;case"className":ct(e,"class",i);break;case"tabIndex":ct(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,n,i);break;case"style":Pt(e,i,o);break;case"data":if("object"!==t){ct(e,"data",i);break}case"src":case"href":if(""===i&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==i||"function"==typeof i||"symbol"==typeof i||"boolean"==typeof i){e.removeAttribute(n);break}i=Ot(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if("function"==typeof i){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof o&&("formAction"===n?("input"!==t&&ld(e,t,"name",r.name,r,null),ld(e,t,"formEncType",r.formEncType,r,null),ld(e,t,"formMethod",r.formMethod,r,null),ld(e,t,"formTarget",r.formTarget,r,null)):(ld(e,t,"encType",r.encType,r,null),ld(e,t,"method",r.method,r,null),ld(e,t,"target",r.target,r,null))),null==i||"symbol"==typeof i||"boolean"==typeof i){e.removeAttribute(n);break}i=Ot(""+i),e.setAttribute(n,i);break;case"onClick":null!=i&&(e.onclick=It);break;case"onScroll":null!=i&&$u("scroll",e);break;case"onScrollEnd":null!=i&&$u("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!=typeof i||!("__html"in i))throw Error(a(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&"function"!=typeof i&&"symbol"!=typeof i;break;case"muted":e.muted=i&&"function"!=typeof i&&"symbol"!=typeof i;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==i||"function"==typeof i||"boolean"==typeof i||"symbol"==typeof i){e.removeAttribute("xlink:href");break}n=Ot(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===i?e.setAttribute(n,""):!1!==i&&null!=i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":null==i||"function"==typeof i||"symbol"==typeof i||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":$u("beforetoggle",e),$u("toggle",e),st(e,"popover",i);break;case"xlinkActuate":lt(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":lt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":lt(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":lt(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":lt(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":lt(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":lt(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":lt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":lt(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":st(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&st(e,n=xt.get(n)||n,i)}}function ud(e,t,n,i,r,o){switch(n){case"style":Pt(e,i,o);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!=typeof i||!("__html"in i))throw Error(a(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"==typeof i?Tt(e,i):("number"==typeof i||"bigint"==typeof i)&&Tt(e,""+i);break;case"onScroll":null!=i&&$u("scroll",e);break;case"onScrollEnd":null!=i&&$u("scrollend",e);break;case"onClick":null!=i&&(e.onclick=It);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:tt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),"function"==typeof(o=null!=(o=e[ze]||null)?o[n]:null)&&e.removeEventListener(t,o,r),"function"!=typeof i)?n in e?e[n]=i:!0===i?e.setAttribute(n,""):st(e,n,i):("function"!=typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,r)))}}function dd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$u("error",e),$u("load",e);var i,r=!1,o=!1;for(i in n)if(n.hasOwnProperty(i)){var s=n[i];if(null!=s)switch(i){case"src":r=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ld(e,t,i,s,n,null)}}return o&&ld(e,t,"srcSet",n.srcSet,n,null),void(r&&ld(e,t,"src",n.src,n,null));case"input":$u("invalid",e);var c=i=s=o=null,l=null,u=null;for(r in n)if(n.hasOwnProperty(r)){var d=n[r];if(null!=d)switch(r){case"name":o=d;break;case"type":s=d;break;case"checked":l=d;break;case"defaultChecked":u=d;break;case"value":i=d;break;case"defaultValue":c=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(a(137,t));break;default:ld(e,t,r,d,n,null)}}return void yt(e,i,c,l,u,s,o,!1);case"select":for(o in $u("invalid",e),r=s=i=null,n)if(n.hasOwnProperty(o)&&null!=(c=n[o]))switch(o){case"value":i=c;break;case"defaultValue":s=c;break;case"multiple":r=c;default:ld(e,t,o,c,n,null)}return t=i,n=s,e.multiple=!!r,void(null!=t?kt(e,!!r,t,!1):null!=n&&kt(e,!!r,n,!0));case"textarea":for(s in $u("invalid",e),i=o=r=null,n)if(n.hasOwnProperty(s)&&null!=(c=n[s]))switch(s){case"value":r=c;break;case"defaultValue":o=c;break;case"children":i=c;break;case"dangerouslySetInnerHTML":if(null!=c)throw Error(a(91));break;default:ld(e,t,s,c,n,null)}return void St(e,r,o,i);case"option":for(l in n)n.hasOwnProperty(l)&&null!=(r=n[l])&&("selected"===l?e.selected=r&&"function"!=typeof r&&"symbol"!=typeof r:ld(e,t,l,r,n,null));return;case"dialog":$u("beforetoggle",e),$u("toggle",e),$u("cancel",e),$u("close",e);break;case"iframe":case"object":$u("load",e);break;case"video":case"audio":for(r=0;r<Ku.length;r++)$u(Ku[r],e);break;case"image":$u("error",e),$u("load",e);break;case"details":$u("toggle",e);break;case"embed":case"source":case"link":$u("error",e),$u("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(r=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ld(e,t,u,r,n,null)}return;default:if(Rt(t)){for(d in n)n.hasOwnProperty(d)&&void 0!==(r=n[d])&&ud(e,t,d,r,n,void 0);return}}for(c in n)n.hasOwnProperty(c)&&null!=(r=n[c])&&ld(e,t,c,r,n,null)}function hd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var pd=null,fd=null;function md(e){return 9===e.nodeType?e:e.ownerDocument}function gd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function yd(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var bd=null,kd="function"==typeof setTimeout?setTimeout:void 0,wd="function"==typeof clearTimeout?clearTimeout:void 0,Sd="function"==typeof Promise?Promise:void 0,Td="function"==typeof queueMicrotask?queueMicrotask:void 0!==Sd?function(e){return Sd.resolve(null).then(e).catch(Cd)}:kd;function Cd(e){setTimeout(function(){throw e})}function Ed(e){return"head"===e}function Pd(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)||"/&"===n){if(0===i)return e.removeChild(r),void zh(t);i--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)i++;else if("html"===n)Ud(e.ownerDocument.documentElement);else if("head"===n){Ud(n=e.ownerDocument.head);for(var o=n.firstChild;o;){var a=o.nextSibling,s=o.nodeName;o[Ge]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=a}}else"body"===n&&Ud(e.ownerDocument.body);n=r}while(n);zh(t)}function Rd(e,t){var n=e;e=0;do{var i=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=i}while(n)}function xd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":xd(n),Je(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function _d(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Nd(e.nextSibling)))return null}return e}function Od(e){return"$?"===e.data||"$~"===e.data}function Id(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Nd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Ad=null;function Dd(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Nd(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Ld(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Md(e,t,n){switch(t=md(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function Ud(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Je(e)}var jd=new Map,Fd=new Set;function Bd(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var zd=D.d;D.d={f:function(){var e=zd.f(),t=Xl();return e||t},r:function(e){var t=Qe(e);null!==t&&5===t.tag&&"form"===t.type?ns(t):zd.r(e)},D:function(e){zd.D(e),Vd("dns-prefetch",e,null)},C:function(e,t){zd.C(e,t),Vd("preconnect",e,t)},L:function(e,t,n){zd.L(e,t,n);var i=qd;if(i&&e&&t){var r='link[rel="preload"][as="'+gt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(r+='[imagesrcset="'+gt(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(r+='[imagesizes="'+gt(n.imageSizes)+'"]')):r+='[href="'+gt(e)+'"]';var o=r;switch(t){case"style":o=Wd(e);break;case"script":o=Jd(e)}jd.has(o)||(e=h({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),jd.set(o,e),null!==i.querySelector(r)||"style"===t&&i.querySelector(Kd(o))||"script"===t&&i.querySelector($d(o))||(dd(t=i.createElement("link"),"link",e),Ze(t),i.head.appendChild(t)))}},m:function(e,t){zd.m(e,t);var n=qd;if(n&&e){var i=t&&"string"==typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+gt(i)+'"][href="'+gt(e)+'"]',o=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Jd(e)}if(!jd.has(o)&&(e=h({rel:"modulepreload",href:e},t),jd.set(o,e),null===n.querySelector(r))){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector($d(o)))return}dd(i=n.createElement("link"),"link",e),Ze(i),n.head.appendChild(i)}}},X:function(e,t){zd.X(e,t);var n=qd;if(n&&e){var i=Xe(n).hoistableScripts,r=Jd(e),o=i.get(r);o||((o=n.querySelector($d(r)))||(e=h({src:e,async:!0},t),(t=jd.get(r))&&Zd(e,t),Ze(o=n.createElement("script")),dd(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(r,o))}},S:function(e,t,n){zd.S(e,t,n);var i=qd;if(i&&e){var r=Xe(i).hoistableStyles,o=Wd(e);t=t||"default";var a=r.get(o);if(!a){var s={loading:0,preload:null};if(a=i.querySelector(Kd(o)))s.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},n),(n=jd.get(o))&&Xd(e,n);var c=a=i.createElement("link");Ze(c),dd(c,"link",e),c._p=new Promise(function(e,t){c.onload=e,c.onerror=t}),c.addEventListener("load",function(){s.loading|=1}),c.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Yd(a,t,i)}a={type:"stylesheet",instance:a,count:1,state:s},r.set(o,a)}}},M:function(e,t){zd.M(e,t);var n=qd;if(n&&e){var i=Xe(n).hoistableScripts,r=Jd(e),o=i.get(r);o||((o=n.querySelector($d(r)))||(e=h({src:e,async:!0,type:"module"},t),(t=jd.get(r))&&Zd(e,t),Ze(o=n.createElement("script")),dd(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(r,o))}}};var qd="undefined"==typeof document?null:document;function Vd(e,t,n){var i=qd;if(i&&"string"==typeof t&&t){var r=gt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"==typeof n&&(r+='[crossorigin="'+n+'"]'),Fd.has(r)||(Fd.add(r),e={rel:e,crossOrigin:n,href:t},null===i.querySelector(r)&&(dd(t=i.createElement("link"),"link",e),Ze(t),i.head.appendChild(t)))}}function Hd(e,t,n,i){var r,o,s,c,l=(l=W.current)?Bd(l):null;if(!l)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Wd(n.href),(i=(n=Xe(l).hoistableStyles).get(t))||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Wd(n.href);var u=Xe(l).hoistableStyles,d=u.get(e);if(d||(l=l.ownerDocument||l,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=l.querySelector(Kd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),jd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},jd.set(e,n),u||(r=l,o=e,s=n,c=d.state,r.querySelector('link[rel="preload"][as="style"]['+o+"]")?c.loading=1:(o=r.createElement("link"),c.preload=o,o.addEventListener("load",function(){return c.loading|=1}),o.addEventListener("error",function(){return c.loading|=2}),dd(o,"link",s),Ze(o),r.head.appendChild(o))))),t&&null===i)throw Error(a(528,""));return d}if(t&&null!==i)throw Error(a(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Jd(n),(i=(n=Xe(l).hoistableScripts).get(t))||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Wd(e){return'href="'+gt(e)+'"'}function Kd(e){return'link[rel="stylesheet"]['+e+"]"}function Gd(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Jd(e){return'[src="'+gt(e)+'"]'}function $d(e){return"script[async]"+e}function Qd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+gt(n.href)+'"]');if(i)return t.instance=i,Ze(i),i;var r=h({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ze(i=(e.ownerDocument||e).createElement("style")),dd(i,"style",r),Yd(i,n.precedence,e),t.instance=i;case"stylesheet":r=Wd(n.href);var o=e.querySelector(Kd(r));if(o)return t.state.loading|=4,t.instance=o,Ze(o),o;i=Gd(n),(r=jd.get(r))&&Xd(i,r),Ze(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),dd(o,"link",i),t.state.loading|=4,Yd(o,n.precedence,e),t.instance=o;case"script":return o=Jd(n.src),(r=e.querySelector($d(o)))?(t.instance=r,Ze(r),r):(i=n,(r=jd.get(o))&&Zd(i=h({},n),r),Ze(r=(e=e.ownerDocument||e).createElement("script")),dd(r,"link",i),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(i=t.instance,t.state.loading|=4,Yd(i,n.precedence,e));return t.instance}function Yd(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,o=r,a=0;a<i.length;a++){var s=i[a];if(s.dataset.precedence===t)o=s;else if(o!==r)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Xd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Zd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var eh=null;function th(e,t,n){if(null===eh){var i=new Map,r=eh=new Map;r.set(n,i)}else(i=(r=eh).get(n))||(i=new Map,r.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var o=n[r];if(!(o[Ge]||o[Be]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var a=o.getAttribute(t)||"";a=e+a;var s=i.get(a);s?s.push(o):i.set(a,[o])}}return i}function nh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function ih(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var rh=0;function oh(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)sh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var ah=null;function sh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,ah=new Map,t.forEach(ch,e),ah=null,oh.call(e))}function ch(e,t){if(!(4&t.state.loading)){var n=ah.get(e);if(n)var i=n.get(null);else{n=new Map,ah.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<r.length;o++){var a=r[o];"LINK"!==a.nodeName&&"not all"===a.getAttribute("media")||(n.set(a.dataset.precedence,a),i=a)}i&&n.set(null,i)}a=(r=t.instance).getAttribute("data-precedence"),(o=n.get(a)||i)===i&&n.set(null,r),n.set(a,r),this.count++,i=oh.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),o?o.parentNode.insertBefore(r,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var lh={$$typeof:k,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function uh(e,t,n,i,r,o,a,s,c){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oe(0),this.hiddenUpdates=Oe(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=o,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function dh(e,t,n,i,r,o){r=function(e){return e?e=Li:Li}(r),null===i.context?i.context=r:i.pendingContext=r,(i=yo(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(i.callback=o),null!==(n=bo(e,i,t))&&(Gl(n,0,t),ko(n,e,t))}function hh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ph(e,t){hh(e,t),(e=e.alternate)&&hh(e,t)}function fh(e){if(13===e.tag||31===e.tag){var t=Ni(e,67108864);null!==t&&Gl(t,0,67108864),ph(e,67108864)}}function mh(e){if(13===e.tag||31===e.tag){var t=Wl(),n=Ni(e,t=Le(t));null!==n&&Gl(n,0,t),ph(e,t)}}var gh=!0;function vh(e,t,n,i){var r=A.T;A.T=null;var o=D.p;try{D.p=2,bh(e,t,n,i)}finally{D.p=o,A.T=r}}function yh(e,t,n,i){var r=A.T;A.T=null;var o=D.p;try{D.p=8,bh(e,t,n,i)}finally{D.p=o,A.T=r}}function bh(e,t,n,i){if(gh){var r=kh(i);if(null===r)ed(e,t,i,wh,n),Nh(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Eh=Ah(Eh,e,t,n,i,r),!0;case"dragenter":return Ph=Ah(Ph,e,t,n,i,r),!0;case"mouseover":return Rh=Ah(Rh,e,t,n,i,r),!0;case"pointerover":var o=r.pointerId;return xh.set(o,Ah(xh.get(o)||null,e,t,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,_h.set(o,Ah(_h.get(o)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Nh(e,i),4&t&&-1<Ih.indexOf(e)){for(;null!==r;){var o=Qe(r);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var a=Ee(o.pendingLanes);if(0!==a){var s=o;for(s.pendingLanes|=2,s.entangledLanes|=2;a;){var c=1<<31-be(a);s.entanglements[1]|=c,a&=~c}Du(o),!(6&hl)&&(Al=se()+500,Lu(0,!1))}}break;case 31:case 13:null!==(s=Ni(o,2))&&Gl(s,0,2),Xl(),ph(o,2)}if(null===(o=kh(i))&&ed(e,t,i,wh,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else ed(e,t,i,null,n)}}function kh(e){return Sh(e=At(e))}var wh=null;function Sh(e){if(wh=null,null!==(e=$e(e))){var t=s(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(31===n){if(null!==(e=l(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return wh=e,null}function Th(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case le:return 2;case ue:return 8;case de:case he:return 32;case pe:return 268435456;default:return 32}default:return 32}}var Ch=!1,Eh=null,Ph=null,Rh=null,xh=new Map,_h=new Map,Oh=[],Ih="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Nh(e,t){switch(e){case"focusin":case"focusout":Eh=null;break;case"dragenter":case"dragleave":Ph=null;break;case"mouseover":case"mouseout":Rh=null;break;case"pointerover":case"pointerout":xh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_h.delete(t.pointerId)}}function Ah(e,t,n,i,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==t&&null!==(t=Qe(t))&&fh(t),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Dh(e){var t=$e(e.target);if(null!==t){var n=s(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void je(e.priority,function(){mh(n)})}else if(31===t){if(null!==(t=l(n)))return e.blockedOn=t,void je(e.priority,function(){mh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=kh(e.nativeEvent);if(null!==n)return null!==(t=Qe(n))&&fh(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Nt=i,n.target.dispatchEvent(i),Nt=null,t.shift()}return!0}function Mh(e,t,n){Lh(e)&&n.delete(t)}function Uh(){Ch=!1,null!==Eh&&Lh(Eh)&&(Eh=null),null!==Ph&&Lh(Ph)&&(Ph=null),null!==Rh&&Lh(Rh)&&(Rh=null),xh.forEach(Mh),_h.forEach(Mh)}function jh(e,t){e.blockedOn===t&&(e.blockedOn=null,Ch||(Ch=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Uh)))}var Fh=null;function Bh(e){Fh!==e&&(Fh=e,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Fh===e&&(Fh=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],r=e[t+2];if("function"!=typeof i){if(null===Sh(i||n))continue;break}var o=Qe(n);null!==o&&(e.splice(t,3),t-=3,es(o,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function zh(e){function t(t){return jh(t,e)}null!==Eh&&jh(Eh,e),null!==Ph&&jh(Ph,e),null!==Rh&&jh(Rh,e),xh.forEach(t),_h.forEach(t);for(var n=0;n<Oh.length;n++){var i=Oh[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Oh.length&&null===(n=Oh[0]).blockedOn;)Dh(n),null===n.blockedOn&&Oh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(i=0;i<n.length;i+=3){var r=n[i],o=n[i+1],a=r[ze]||null;if("function"==typeof o)a||Bh(n);else if(a){var s=null;if(o&&o.hasAttribute("formAction")){if(r=o,a=o[ze]||null)s=a.formAction;else if(null!==Sh(r))continue}else s=a.action;"function"==typeof s?n[i+1]=s:(n.splice(i,3),i-=3),Bh(n)}}}function qh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return r=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==r&&(r(),r=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"==typeof navigation){var i=!1,r=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==r&&(r(),r=null)}}}function Vh(e){this._internalRoot=e}function Hh(e){this._internalRoot=e}Hh.prototype.render=Vh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));dh(t.current,Wl(),e,t,null,null)},Hh.prototype.unmount=Vh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dh(e.current,2,null,e,null,null),Xl(),t[qe]=null}},Hh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ue();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Oh.length&&0!==t&&t<Oh[n].priority;n++);Oh.splice(n,0,e),0===n&&Dh(e)}};var Wh=r.version;if("19.2.3"!==Wh)throw Error(a(527,Wh,"19.2.3"));D.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=s(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return u(r),e;if(o===i)return u(r),t;o=o.sibling}throw Error(a(188))}if(n.return!==i.return)n=r,i=o;else{for(var c=!1,l=r.child;l;){if(l===n){c=!0,n=r,i=o;break}if(l===i){c=!0,i=r,n=o;break}l=l.sibling}if(!c){for(l=o.child;l;){if(l===n){c=!0,n=o,i=r;break}if(l===i){c=!0,i=o,n=r;break}l=l.sibling}if(!c)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),null===(e=null!==e?d(e):null)?null:e.stateNode};var Kh={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:A,reconcilerVersion:"19.2.3"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Gh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gh.isDisabled&&Gh.supportsFiber)try{ge=Gh.inject(Kh),ve=Gh}catch(e){}}t.createRoot=function(e,t){if(!(n=e)||1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType)throw Error(a(299));var n,i=!1,r="",o=Ts,s=Cs,c=Es;return null!=t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(o=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(c=t.onRecoverableError)),t=function(e,t,n,i,r,o,a,s,c,l,u,d){return e=new uh(e,t,n,a,c,l,u,d,s),t=1,!0===o&&(t|=24),o=Ui(3,null,null,t),e.current=o,o.stateNode=e,(t=jr()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:i,isDehydrated:n,cache:t},go(o),e}(e,1,!1,null,0,i,r,null,o,s,c,qh),e[qe]=t.current,Xu(e),new Vh(t)}},314(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,i,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);i&&a[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},338(e,t,n){!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(247)},477(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<o(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var s=2*(i+1)-1,c=e[s],l=s+1,u=e[l];if(0>o(c,n))l<r&&0>o(u,c)?(e[i]=u,e[l]=n,i=l):(e[i]=c,e[s]=n,i=s);else{if(!(l<r&&0>o(u,n)))break e;e[i]=u,e[l]=n,i=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v=!1,y="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,k="undefined"!=typeof setImmediate?setImmediate:null;function w(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(l,t)}t=i(u)}}function S(e){if(g=!1,w(e),!m)if(null!==i(l))m=!0,C||(C=!0,T());else{var t=i(u);null!==t&&N(S,t.startTime-e)}}var T,C=!1,E=-1,P=5,R=-1;function x(){return!(!v&&t.unstable_now()-R<P)}function _(){if(v=!1,C){var e=t.unstable_now();R=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(E),E=-1),f=!0;var o=p;try{t:{for(w(e),h=i(l);null!==h&&!(h.expirationTime>e&&x());){var a=h.callback;if("function"==typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=e);if(e=t.unstable_now(),"function"==typeof s){h.callback=s,w(e),n=!0;break t}h===i(l)&&r(l),w(e)}else r(l);h=i(l)}if(null!==h)n=!0;else{var c=i(u);null!==c&&N(S,c.startTime-e),n=!1}}break e}finally{h=null,p=o,f=!1}n=void 0}}finally{n?T():C=!1}}}if("function"==typeof k)T=function(){k(_)};else if("undefined"!=typeof MessageChannel){var O=new MessageChannel,I=O.port2;O.port1.onmessage=_,T=function(){I.postMessage(null)}}else T=function(){y(_,0)};function N(e,n){E=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,o){var a=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?a+o:a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(u,e),null===i(l)&&e===i(u)&&(g?(b(E),E=-1):g=!0,N(S,o-a))):(e.sortIndex=s,n(l,e),m||f||(m=!0,C||(C=!0,T()))),e},t.unstable_shouldYield=x,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},540(e,t,n){e.exports=n(869)},601(e){e.exports=function(e){return e[1]}},659(e){var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},697(e,t,n){n.d(t,{A:()=>s});var i=n(601),r=n.n(i),o=n(314),a=n.n(o)()(r());a.push([e.id,".vp-scrollbar-none {\n  scrollbar-width: none;\n}\n\n@keyframes vp-avatar-pulse {\n  0% {\n    box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.3);\n    transform: scale(1);\n  }\n\n  50% {\n    box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.7);\n    transform: scale(1.05);\n  }\n\n  100% {\n    box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.3);\n    transform: scale(1);\n  }\n}\n\n.vp-avatar-pulse {\n  animation: vp-avatar-pulse 1s infinite;\n}\n\n@keyframes vp-wave {\n  0% {\n    transform: scale(0.8);\n    opacity: 0.8;\n  }\n\n  100% {\n    transform: scale(2);\n    opacity: 0;\n  }\n}\n\n.vp-wave {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  background: rgba(255, 255, 255, 0.2);\n  animation: vp-wave 2s infinite;\n}\n\n.vp-wave:nth-child(1) {\n  animation-delay: 0.5s;\n}\n\n.vp-wave:nth-child(2) {\n  animation-delay: 1s;\n}\n\n.vp-wave:nth-child(3) {\n  animation-delay: 1.5s;\n}\n\n.vp-wave:nth-child(4) {\n  animation-delay: 2s;\n}\n",""]);const s=a},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},869(e,t){var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),f=Symbol.iterator,m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}function b(){}function k(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var w=k.prototype=new b;w.constructor=k,g(w,y.prototype),w.isPureReactComponent=!0;var S=Array.isArray;function T(){}var C={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function P(e,t,i){var r=i.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:i}}function R(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var x=/\/+/g;function _(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(n=""+e.key,i={"=":"=0",":":"=2"},"$"+n.replace(/[=:]/g,function(e){return i[e]})):t.toString(36);var n,i}function O(e,t,r,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c,l,u=!1;if(null===e)u=!0;else switch(s){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case i:u=!0;break;case h:return O((u=e._init)(e._payload),t,r,o,a)}}if(u)return a=a(e),u=""===o?"."+_(e,0):o,S(a)?(r="",null!=u&&(r=u.replace(x,"$&/")+"/"),O(a,t,r,"",function(e){return e})):null!=a&&(R(a)&&(c=a,l=r+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(x,"$&/")+"/")+u,a=P(c.type,l,c.props)),t.push(a)),1;u=0;var d,p=""===o?".":o+":";if(S(e))for(var m=0;m<e.length;m++)u+=O(o=e[m],t,r,s=p+_(o,m),a);else if("function"==typeof(m=null===(d=e)||"object"!=typeof d?null:"function"==typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=m.call(e),m=0;!(o=e.next()).done;)u+=O(o=o.value,t,r,s=p+_(o,m++),a);else if("object"===s){if("function"==typeof e.then)return O(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(T,T):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,o,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function I(e,t,n){if(null==e)return e;var i=[],r=0;return O(e,i,"","",function(e){return t.call(n,e,r++)}),i}function N(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},D={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!R(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=p,t.Children=D,t.Component=y,t.Fragment=r,t.Profiler=a,t.PureComponent=k,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return C.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var i=g({},e.props),r=e.key;if(null!=t)for(o in void 0!==t.key&&(r=""+t.key),t)!E.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(i[o]=t[o]);var o=arguments.length-2;if(1===o)i.children=n;else if(1<o){for(var a=Array(o),s=0;s<o;s++)a[s]=arguments[s+2];i.children=a}return P(e.type,r,i)},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var i,r={},o=null;if(null!=t)for(i in void 0!==t.key&&(o=""+t.key),t)E.call(t,i)&&"key"!==i&&"__self"!==i&&"__source"!==i&&(r[i]=t[i]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var s=Array(a),c=0;c<a;c++)s[c]=arguments[c+2];r.children=s}if(e&&e.defaultProps)for(i in a=e.defaultProps)void 0===r[i]&&(r[i]=a[i]);return P(e,o,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=R,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=C.T,n={};C.T=n;try{var i=e(),r=C.S;null!==r&&r(n,i),"object"==typeof i&&null!==i&&"function"==typeof i.then&&i.then(T,A)}catch(e){A(e)}finally{null!==t&&null!==n.types&&(t.types=n.types),C.T=t}},t.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},t.use=function(e){return C.H.use(e)},t.useActionState=function(e,t,n){return C.H.useActionState(e,t,n)},t.useCallback=function(e,t){return C.H.useCallback(e,t)},t.useContext=function(e){return C.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return C.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return C.H.useEffect(e,t)},t.useEffectEvent=function(e){return C.H.useEffectEvent(e)},t.useId=function(){return C.H.useId()},t.useImperativeHandle=function(e,t,n){return C.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return C.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return C.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return C.H.useMemo(e,t)},t.useOptimistic=function(e,t){return C.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return C.H.useReducer(e,t,n)},t.useRef=function(e){return C.H.useRef(e)},t.useState=function(e){return C.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return C.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return C.H.useTransition()},t.version="19.2.3"},961(e,t,n){!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(221)},972(e,t,n){n.d(t,{A:()=>s});var i=n(601),r=n.n(i),o=n(314),a=n.n(o)()(r());a.push([e.id,"*, ::before, ::after {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgb(59 130 246 / 0.5);\n  --tw-ring-offset-shadow: 0 0 #0000;\n  --tw-ring-shadow: 0 0 #0000;\n  --tw-shadow: 0 0 #0000;\n  --tw-shadow-colored: 0 0 #0000;\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n  --tw-contain-size:  ;\n  --tw-contain-layout:  ;\n  --tw-contain-paint:  ;\n  --tw-contain-style:  ;\n}\n\n::backdrop {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgb(59 130 246 / 0.5);\n  --tw-ring-offset-shadow: 0 0 #0000;\n  --tw-ring-shadow: 0 0 #0000;\n  --tw-shadow: 0 0 #0000;\n  --tw-shadow-colored: 0 0 #0000;\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n  --tw-contain-size:  ;\n  --tw-contain-layout:  ;\n  --tw-contain-paint:  ;\n  --tw-contain-style:  ;\n}/*\n! tailwindcss v3.4.19 | MIT License | https://tailwindcss.com\n*//*\n1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4)\n2. Allow adding a border to an element by just adding a border-width. (https://github.com/tailwindcss/tailwindcss/pull/116)\n*/\n\n*,\n::before,\n::after {\n  box-sizing: border-box; /* 1 */\n  border-width: 0; /* 2 */\n  border-style: solid; /* 2 */\n  border-color: #e5e7eb; /* 2 */\n}\n\n::before,\n::after {\n  --tw-content: '';\n}\n\n/*\n1. Use a consistent sensible line-height in all browsers.\n2. Prevent adjustments of font size after orientation changes in iOS.\n3. Use a more readable tab size.\n4. Use the user's configured `sans` font-family by default.\n5. Use the user's configured `sans` font-feature-settings by default.\n6. Use the user's configured `sans` font-variation-settings by default.\n7. Disable tap highlights on iOS\n*/\n\nhtml,\n:host {\n  line-height: 1.5; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */ /* 3 */\n  tab-size: 4; /* 3 */\n  font-family: ui-sans-serif, system-ui, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji\"; /* 4 */\n  font-feature-settings: normal; /* 5 */\n  font-variation-settings: normal; /* 6 */\n  -webkit-tap-highlight-color: transparent; /* 7 */\n}\n\n/*\n1. Remove the margin in all browsers.\n2. Inherit line-height from `html` so users can set them as a class directly on the `html` element.\n*/\n\nbody {\n  margin: 0; /* 1 */\n  line-height: inherit; /* 2 */\n}\n\n/*\n1. Add the correct height in Firefox.\n2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)\n3. Ensure horizontal rules are visible by default.\n*/\n\nhr {\n  height: 0; /* 1 */\n  color: inherit; /* 2 */\n  border-top-width: 1px; /* 3 */\n}\n\n/*\nAdd the correct text decoration in Chrome, Edge, and Safari.\n*/\n\nabbr:where([title]) {\n  -webkit-text-decoration: underline dotted;\n          text-decoration: underline dotted;\n}\n\n/*\nRemove the default font size and weight for headings.\n*/\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-size: inherit;\n  font-weight: inherit;\n}\n\n/*\nReset links to optimize for opt-in styling instead of opt-out.\n*/\n\na {\n  color: inherit;\n  text-decoration: inherit;\n}\n\n/*\nAdd the correct font weight in Edge and Safari.\n*/\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/*\n1. Use the user's configured `mono` font-family by default.\n2. Use the user's configured `mono` font-feature-settings by default.\n3. Use the user's configured `mono` font-variation-settings by default.\n4. Correct the odd `em` font sizing in all browsers.\n*/\n\ncode,\nkbd,\nsamp,\npre {\n  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace; /* 1 */\n  font-feature-settings: normal; /* 2 */\n  font-variation-settings: normal; /* 3 */\n  font-size: 1em; /* 4 */\n}\n\n/*\nAdd the correct font size in all browsers.\n*/\n\nsmall {\n  font-size: 80%;\n}\n\n/*\nPrevent `sub` and `sup` elements from affecting the line height in all browsers.\n*/\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/*\n1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)\n2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)\n3. Remove gaps between table borders by default.\n*/\n\ntable {\n  text-indent: 0; /* 1 */\n  border-color: inherit; /* 2 */\n  border-collapse: collapse; /* 3 */\n}\n\n/*\n1. Change the font styles in all browsers.\n2. Remove the margin in Firefox and Safari.\n3. Remove default padding in all browsers.\n*/\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-feature-settings: inherit; /* 1 */\n  font-variation-settings: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  font-weight: inherit; /* 1 */\n  line-height: inherit; /* 1 */\n  letter-spacing: inherit; /* 1 */\n  color: inherit; /* 1 */\n  margin: 0; /* 2 */\n  padding: 0; /* 3 */\n}\n\n/*\nRemove the inheritance of text transform in Edge and Firefox.\n*/\n\nbutton,\nselect {\n  text-transform: none;\n}\n\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Remove default button styles.\n*/\n\nbutton,\ninput:where([type='button']),\ninput:where([type='reset']),\ninput:where([type='submit']) {\n  -webkit-appearance: button; /* 1 */\n  background-color: transparent; /* 2 */\n  background-image: none; /* 2 */\n}\n\n/*\nUse the modern Firefox focus style for all focusable elements.\n*/\n\n:-moz-focusring {\n  outline: auto;\n}\n\n/*\nRemove the additional `:invalid` styles in Firefox. (https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737)\n*/\n\n:-moz-ui-invalid {\n  box-shadow: none;\n}\n\n/*\nAdd the correct vertical alignment in Chrome and Firefox.\n*/\n\nprogress {\n  vertical-align: baseline;\n}\n\n/*\nCorrect the cursor style of increment and decrement buttons in Safari.\n*/\n\n::-webkit-inner-spin-button,\n::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/*\n1. Correct the odd appearance in Chrome and Safari.\n2. Correct the outline style in Safari.\n*/\n\n[type='search'] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/*\nRemove the inner padding in Chrome and Safari on macOS.\n*/\n\n::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Change font properties to `inherit` in Safari.\n*/\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/*\nAdd the correct display in Chrome and Safari.\n*/\n\nsummary {\n  display: list-item;\n}\n\n/*\nRemoves the default spacing and border for appropriate elements.\n*/\n\nblockquote,\ndl,\ndd,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\nhr,\nfigure,\np,\npre {\n  margin: 0;\n}\n\nfieldset {\n  margin: 0;\n  padding: 0;\n}\n\nlegend {\n  padding: 0;\n}\n\nol,\nul,\nmenu {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n\n/*\nReset default styling for dialogs.\n*/\ndialog {\n  padding: 0;\n}\n\n/*\nPrevent resizing textareas horizontally by default.\n*/\n\ntextarea {\n  resize: vertical;\n}\n\n/*\n1. Reset the default placeholder opacity in Firefox. (https://github.com/tailwindlabs/tailwindcss/issues/3300)\n2. Set the default placeholder color to the user's configured gray 400 color.\n*/\n\ninput::placeholder,\ntextarea::placeholder {\n  opacity: 1; /* 1 */\n  color: #9ca3af; /* 2 */\n}\n\n/*\nSet the default cursor for buttons.\n*/\n\nbutton,\n[role=\"button\"] {\n  cursor: pointer;\n}\n\n/*\nMake sure disabled buttons don't get the pointer cursor.\n*/\n:disabled {\n  cursor: default;\n}\n\n/*\n1. Make replaced elements `display: block` by default. (https://github.com/mozdevs/cssremedy/issues/14)\n2. Add `vertical-align: middle` to align replaced elements more sensibly by default. (https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210)\n   This can trigger a poorly considered lint error in some tools but is included by design.\n*/\n\nimg,\nsvg,\nvideo,\ncanvas,\naudio,\niframe,\nembed,\nobject {\n  display: block; /* 1 */\n  vertical-align: middle; /* 2 */\n}\n\n/*\nConstrain images and videos to the parent width and preserve their intrinsic aspect ratio. (https://github.com/mozdevs/cssremedy/issues/14)\n*/\n\nimg,\nvideo {\n  max-width: 100%;\n  height: auto;\n}\n\n/* Make elements with the HTML hidden attribute stay hidden by default */\n[hidden]:where(:not([hidden=\"until-found\"])) {\n  display: none;\n}\n.vp-fixed {\n  position: fixed;\n}\n.vp-absolute {\n  position: absolute;\n}\n.vp-relative {\n  position: relative;\n}\n.vp-inset-0 {\n  inset: 0px;\n}\n.vp--bottom-1 {\n  bottom: -0.25rem;\n}\n.vp-bottom-0 {\n  bottom: 0px;\n}\n.vp-bottom-10 {\n  bottom: 2.5rem;\n}\n.vp-bottom-5 {\n  bottom: 1.25rem;\n}\n.vp-left-0 {\n  left: 0px;\n}\n.vp-left-1\\/2 {\n  left: 50%;\n}\n.vp-left-\\[16px\\] {\n  left: 16px;\n}\n.vp-right-0 {\n  right: 0px;\n}\n.vp-right-4 {\n  right: 1rem;\n}\n.vp-right-5 {\n  right: 1.25rem;\n}\n.vp-top-20 {\n  top: 5rem;\n}\n.vp-top-4 {\n  top: 1rem;\n}\n.vp-z-10 {\n  z-index: 10;\n}\n.vp-z-\\[9999\\] {\n  z-index: 9999;\n}\n.vp-inline-block {\n  display: inline-block;\n}\n.vp-flex {\n  display: flex;\n}\n.vp-grid {\n  display: grid;\n}\n.vp-hidden {\n  display: none;\n}\n.vp-h-10 {\n  height: 2.5rem;\n}\n.vp-h-16 {\n  height: 4rem;\n}\n.vp-h-20 {\n  height: 5rem;\n}\n.vp-h-\\[56px\\] {\n  height: 56px;\n}\n.vp-h-\\[76px\\] {\n  height: 76px;\n}\n.vp-h-\\[84px\\] {\n  height: 84px;\n}\n.vp-h-\\[92px\\] {\n  height: 92px;\n}\n.vp-h-full {\n  height: 100%;\n}\n.vp-w-10 {\n  width: 2.5rem;\n}\n.vp-w-16 {\n  width: 4rem;\n}\n.vp-w-20 {\n  width: 5rem;\n}\n.vp-w-\\[56px\\] {\n  width: 56px;\n}\n.vp-w-\\[76px\\] {\n  width: 76px;\n}\n.vp-w-\\[84px\\] {\n  width: 84px;\n}\n.vp-w-\\[92px\\] {\n  width: 92px;\n}\n.vp-w-\\[calc\\(100\\%-70px\\)\\] {\n  width: calc(100% - 70px);\n}\n.vp-w-full {\n  width: 100%;\n}\n.vp--translate-x-1\\/2 {\n  --tw-translate-x: -50%;\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n}\n@keyframes vp-pulse {\n\n  50% {\n    opacity: .5;\n  }\n}\n.vp-animate-pulse {\n  animation: vp-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n}\n@keyframes vp-spin {\n\n  to {\n    transform: rotate(360deg);\n  }\n}\n.vp-animate-spin {\n  animation: vp-spin 1s linear infinite;\n}\n.vp-cursor-pointer {\n  cursor: pointer;\n}\n.vp-auto-rows-fr {\n  grid-auto-rows: minmax(0, 1fr);\n}\n.vp-grid-cols-1 {\n  grid-template-columns: repeat(1, minmax(0, 1fr));\n}\n.vp-grid-cols-2 {\n  grid-template-columns: repeat(2, minmax(0, 1fr));\n}\n.vp-grid-cols-3 {\n  grid-template-columns: repeat(3, minmax(0, 1fr));\n}\n.vp-grid-cols-4 {\n  grid-template-columns: repeat(4, minmax(0, 1fr));\n}\n.vp-flex-row {\n  flex-direction: row;\n}\n.vp-flex-col {\n  flex-direction: column;\n}\n.vp-items-start {\n  align-items: flex-start;\n}\n.vp-items-center {\n  align-items: center;\n}\n.vp-justify-end {\n  justify-content: flex-end;\n}\n.vp-justify-center {\n  justify-content: center;\n}\n.vp-justify-between {\n  justify-content: space-between;\n}\n.vp-gap-2 {\n  gap: 0.5rem;\n}\n.vp-gap-4 {\n  gap: 1rem;\n}\n.vp-self-end {\n  align-self: flex-end;\n}\n.vp-overflow-hidden {\n  overflow: hidden;\n}\n.vp-overflow-y-auto {\n  overflow-y: auto;\n}\n.vp-break-words {\n  overflow-wrap: break-word;\n}\n.vp-break-all {\n  word-break: break-all;\n}\n.vp-rounded {\n  border-radius: 0.25rem;\n}\n.vp-rounded-full {\n  border-radius: 9999px;\n}\n.vp-rounded-lg {\n  border-radius: 0.5rem;\n}\n.vp-rounded-sm {\n  border-radius: 0.125rem;\n}\n.vp-border {\n  border-width: 1px;\n}\n.vp-border-2 {\n  border-width: 2px;\n}\n.vp-border-4 {\n  border-width: 4px;\n}\n.vp-border-white {\n  --tw-border-opacity: 1;\n  border-color: rgb(255 255 255 / var(--tw-border-opacity, 1));\n}\n.vp-border-b-transparent {\n  border-bottom-color: transparent;\n}\n.vp-border-l-transparent {\n  border-left-color: transparent;\n}\n.vp-border-r-transparent {\n  border-right-color: transparent;\n}\n.vp-border-t-white {\n  --tw-border-opacity: 1;\n  border-top-color: rgb(255 255 255 / var(--tw-border-opacity, 1));\n}\n.vp-bg-black {\n  --tw-bg-opacity: 1;\n  background-color: rgb(0 0 0 / var(--tw-bg-opacity, 1));\n}\n.vp-bg-emerald-500\\/80 {\n  background-color: rgb(16 185 129 / 0.8);\n}\n.vp-bg-gray-800 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(31 41 55 / var(--tw-bg-opacity, 1));\n}\n.vp-bg-pink-500 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(236 72 153 / var(--tw-bg-opacity, 1));\n}\n.vp-bg-pink-600 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(219 39 119 / var(--tw-bg-opacity, 1));\n}\n.vp-bg-red-500\\/80 {\n  background-color: rgb(239 68 68 / 0.8);\n}\n.vp-bg-transparent {\n  background-color: transparent;\n}\n.vp-bg-white {\n  --tw-bg-opacity: 1;\n  background-color: rgb(255 255 255 / var(--tw-bg-opacity, 1));\n}\n.vp-bg-gradient-to-br {\n  background-image: linear-gradient(to bottom right, var(--tw-gradient-stops));\n}\n.vp-bg-gradient-to-tr {\n  background-image: linear-gradient(to top right, var(--tw-gradient-stops));\n}\n.vp-from-indigo-500 {\n  --tw-gradient-from: #6366f1 var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(99 102 241 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.vp-from-slate-700 {\n  --tw-gradient-from: #334155 var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(51 65 85 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.vp-from-slate-800 {\n  --tw-gradient-from: #1e293b var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(30 41 59 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.vp-from-yellow-400 {\n  --tw-gradient-from: #facc15 var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(250 204 21 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.vp-via-pink-500 {\n  --tw-gradient-to: rgb(236 72 153 / 0)  var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), #ec4899 var(--tw-gradient-via-position), var(--tw-gradient-to);\n}\n.vp-to-purple-500 {\n  --tw-gradient-to: #a855f7 var(--tw-gradient-to-position);\n}\n.vp-to-purple-600 {\n  --tw-gradient-to: #9333ea var(--tw-gradient-to-position);\n}\n.vp-to-slate-800 {\n  --tw-gradient-to: #1e293b var(--tw-gradient-to-position);\n}\n.vp-to-slate-900 {\n  --tw-gradient-to: #0f172a var(--tw-gradient-to-position);\n}\n.vp-object-cover {\n  object-fit: cover;\n}\n.vp-p-1\\.5 {\n  padding: 0.375rem;\n}\n.vp-p-2 {\n  padding: 0.5rem;\n}\n.vp-px-2 {\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n}\n.vp-px-4 {\n  padding-left: 1rem;\n  padding-right: 1rem;\n}\n.vp-py-1 {\n  padding-top: 0.25rem;\n  padding-bottom: 0.25rem;\n}\n.vp-py-2 {\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n.vp-text-2xl {\n  font-size: 1.5rem;\n  line-height: 2rem;\n}\n.vp-text-\\[10px\\] {\n  font-size: 10px;\n}\n.vp-text-base {\n  font-size: 1rem;\n  line-height: 1.5rem;\n}\n.vp-text-lg {\n  font-size: 1.125rem;\n  line-height: 1.75rem;\n}\n.vp-text-sm {\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n}\n.vp-font-bold {\n  font-weight: 700;\n}\n.vp-font-semibold {\n  font-weight: 600;\n}\n.vp-leading-normal {\n  line-height: 1.5;\n}\n.vp-tracking-widest {\n  letter-spacing: 0.1em;\n}\n.vp-text-white {\n  --tw-text-opacity: 1;\n  color: rgb(255 255 255 / var(--tw-text-opacity, 1));\n}\n.vp-shadow-lg {\n  --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.vp-shadow-xl {\n  --tw-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.vp-outline-none {\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n}\n.vp-ring-2 {\n  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);\n}\n.vp-ring-emerald-400 {\n  --tw-ring-opacity: 1;\n  --tw-ring-color: rgb(52 211 153 / var(--tw-ring-opacity, 1));\n}\n.vp-ring-offset-2 {\n  --tw-ring-offset-width: 2px;\n}\n.vp-ring-offset-slate-950 {\n  --tw-ring-offset-color: #020617;\n}\n.vp-backdrop-blur-sm {\n  --tw-backdrop-blur: blur(4px);\n  -webkit-backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);\n  backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);\n}\n.vp-transition-all {\n  transition-property: all;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.vp-duration-300 {\n  transition-duration: 300ms;\n}\n.vp-ease-out {\n  transition-timing-function: cubic-bezier(0, 0, 0.2, 1);\n}\n@media (min-width: 768px) {\n\n  .md\\:vp-bottom-5 {\n    bottom: 1.25rem;\n  }\n\n  .md\\:vp-right-5 {\n    right: 1.25rem;\n  }\n\n  .md\\:vp-flex {\n    display: flex;\n  }\n\n  .md\\:vp-h-\\[720px\\] {\n    height: 720px;\n  }\n\n  .md\\:vp-h-\\[812px\\] {\n    height: 812px;\n  }\n\n  .md\\:vp-w-\\[360px\\] {\n    width: 360px;\n  }\n\n  .md\\:vp-rounded-lg {\n    border-radius: 0.5rem;\n  }\n\n  .md\\:vp-shadow-lg {\n    --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);\n    --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n  }\n}\n",""]);const s=a},982(e,t,n){e.exports=n(477)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={id:i,exports:{}};return e[i](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var i={};n.r(i),n.d(i,{default:()=>xm});var r={};n.r(r),n.d(r,{Decoder:()=>It,Encoder:()=>Ot,PacketType:()=>_t,isPacketValid:()=>Lt,protocol:()=>xt});var o={};n.r(o),n.d(o,{hasBrowserEnv:()=>Xn,hasStandardBrowserEnv:()=>ei,hasStandardBrowserWebWorkerEnv:()=>ti,navigator:()=>Zn,origin:()=>ni});var a=n(540),s=n(338),c=n(72),l=n.n(c),u=n(825),d=n.n(u),h=n(659),p=n.n(h),f=n(56),m=n.n(f),g=n(159),v=n.n(g),y=n(113),b=n.n(y),k=n(972),w={};w.styleTagTransform=b(),w.setAttributes=m(),w.insert=p().bind(null,"head"),w.domAPI=d(),w.insertStyleElement=v(),l()(k.A,w),k.A&&k.A.locals&&k.A.locals;let S={data:""},T=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,C=/\/\*[^]*?\*\/|  +/g,E=/\n+/g,P=(e,t)=>{let n="",i="",r="";for(let o in e){let a=e[o];"@"==o[0]?"i"==o[1]?n=o+" "+a+";":i+="f"==o[1]?P(a,o):o+"{"+P(a,"k"==o[1]?"":t)+"}":"object"==typeof a?i+=P(a,t?t.replace(/([^,])+/g,e=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):o):null!=a&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=P.p?P.p(o,a):o+":"+a+";")}return n+(t&&r?t+"{"+r+"}":r)+i},R={},x=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+x(e[n]);return t}return e},_=(e,t,n,i,r)=>{let o=x(e),a=R[o]||(R[o]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(o));if(!R[a]){let t=o!==e?e:(e=>{let t,n,i=[{}];for(;t=T.exec(e.replace(C,""));)t[4]?i.shift():t[3]?(n=t[3].replace(E," ").trim(),i.unshift(i[0][n]=i[0][n]||{})):i[0][t[1]]=t[2].replace(E," ").trim();return i[0]})(e);R[a]=P(r?{["@keyframes "+a]:t}:t,n?"":"."+a)}let s=n&&R.g?R.g:null;return n&&(R.g=R[a]),((e,t,n,i)=>{i?t.data=t.data.replace(i,e):-1===t.data.indexOf(e)&&(t.data=n?e+t.data:t.data+e)})(R[a],t,i,s),a};function O(e){let t=this||{},n=e.call?e(t.p):e;return _(n.unshift?n.raw?((e,t,n)=>e.reduce((e,i,r)=>{let o=t[r];if(o&&o.call){let e=o(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;o=t?"."+t:e&&"object"==typeof e?e.props?"":P(e,""):!1===e?"":e}return e+i+(null==o?"":o)},""))(n,[].slice.call(arguments,1),t.p):n.reduce((e,n)=>Object.assign(e,n&&n.call?n(t.p):n),{}):n,(e=>{if("object"==typeof window){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||S})(t.target),t.g,t.o,t.k)}O.bind({g:1});let I,N,A,D=O.bind({k:1});function L(e,t){let n=this||{};return function(){let i=arguments;function r(o,a){let s=Object.assign({},o),c=s.className||r.className;n.p=Object.assign({theme:N&&N()},s),n.o=/ *go\d+/.test(c),s.className=O.apply(n,i)+(c?" "+c:""),t&&(s.ref=a);let l=e;return e[0]&&(l=s.as||e,delete s.as),A&&l[0]&&A(s),I(l,s)}return t?t(r):r}}var M=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,U=(()=>{let e=0;return()=>(++e).toString()})(),j=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),F="default",B=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case 2:let{toast:i}=t;return B(e,{type:e.toasts.find(e=>e.id===i.id)?1:0,toast:i});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,dismissed:!0,visible:!1}:e)};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let o=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(e=>({...e,pauseDuration:e.pauseDuration+o}))}}},z=[],q={toasts:[],pausedAt:void 0,settings:{toastLimit:20}},V={},H=(e,t=F)=>{V[t]=B(V[t]||q,e),z.forEach(([e,n])=>{e===t&&n(V[t])})},W=e=>Object.keys(V).forEach(t=>H(e,t)),K=(e=F)=>t=>{H(t,e)},G={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},J=e=>(t,n)=>{let i=((e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(null==n?void 0:n.id)||U()}))(t,e,n);return K(i.toasterId||(e=>Object.keys(V).find(t=>V[t].toasts.some(t=>t.id===e)))(i.id))({type:2,toast:i}),i.id},$=(e,t)=>J("blank")(e,t);$.error=J("error"),$.success=J("success"),$.loading=J("loading"),$.custom=J("custom"),$.dismiss=(e,t)=>{let n={type:3,toastId:e};t?K(t)(n):W(n)},$.dismissAll=e=>$.dismiss(void 0,e),$.remove=(e,t)=>{let n={type:4,toastId:e};t?K(t)(n):W(n)},$.removeAll=e=>$.remove(void 0,e),$.promise=(e,t,n)=>{let i=$.loading(t.loading,{...n,...null==n?void 0:n.loading});return"function"==typeof e&&(e=e()),e.then(e=>{let r=t.success?M(t.success,e):void 0;return r?$.success(r,{id:i,...n,...null==n?void 0:n.success}):$.dismiss(i),e}).catch(e=>{let r=t.error?M(t.error,e):void 0;r?$.error(r,{id:i,...n,...null==n?void 0:n.error}):$.dismiss(i)}),e};var Q,Y=D`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,X=D`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Z=D`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ee=L("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Y} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${X} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Z} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,te=D`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ne=L("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${te} 1s linear infinite;
`,ie=D`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,re=D`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,oe=L("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ie} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${re} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,ae=L("div")`
  position: absolute;
`,se=L("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,ce=D`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,le=L("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${ce} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ue=({toast:e})=>{let{icon:t,type:n,iconTheme:i}=e;return void 0!==t?"string"==typeof t?a.createElement(le,null,t):t:"blank"===n?null:a.createElement(se,null,a.createElement(ne,{...i}),"loading"!==n&&a.createElement(ae,null,"error"===n?a.createElement(ee,{...i}):a.createElement(oe,{...i})))},de=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,he=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,pe=L("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,fe=L("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,me=a.memo(({toast:e,position:t,style:n,children:i})=>{let r=e.height?((e,t)=>{let n=e.includes("top")?1:-1,[i,r]=j()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[de(n),he(n)];return{animation:t?`${D(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${D(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(e.position||t||"top-center",e.visible):{opacity:0},o=a.createElement(ue,{toast:e}),s=a.createElement(fe,{...e.ariaProps},M(e.message,e));return a.createElement(pe,{className:e.className,style:{...r,...n,...e.style}},"function"==typeof i?i({icon:o,message:s}):a.createElement(a.Fragment,null,o,s))});Q=a.createElement,P.p=void 0,I=Q,N=void 0,A=void 0;var ge=({id:e,className:t,style:n,onHeightUpdate:i,children:r})=>{let o=a.useCallback(t=>{if(t){let n=()=>{let n=t.getBoundingClientRect().height;i(e,n)};n(),new MutationObserver(n).observe(t,{subtree:!0,childList:!0,characterData:!0})}},[e,i]);return a.createElement("div",{ref:o,className:t,style:n},r)},ve=O`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ye=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:i,children:r,toasterId:o,containerStyle:s,containerClassName:c})=>{let{toasts:l,handlers:u}=((e,t="default")=>{let{toasts:n,pausedAt:i}=((e={},t=F)=>{let[n,i]=(0,a.useState)(V[t]||q),r=(0,a.useRef)(V[t]);(0,a.useEffect)(()=>(r.current!==V[t]&&i(V[t]),z.push([t,i]),()=>{let e=z.findIndex(([e])=>e===t);e>-1&&z.splice(e,1)}),[t]);let o=n.toasts.map(t=>{var n,i,r;return{...e,...e[t.type],...t,removeDelay:t.removeDelay||(null==(n=e[t.type])?void 0:n.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(i=e[t.type])?void 0:i.duration)||(null==e?void 0:e.duration)||G[t.type],style:{...e.style,...null==(r=e[t.type])?void 0:r.style,...t.style}}});return{...n,toasts:o}})(e,t),r=(0,a.useRef)(new Map).current,o=(0,a.useCallback)((e,t=1e3)=>{if(r.has(e))return;let n=setTimeout(()=>{r.delete(e),s({type:4,toastId:e})},t);r.set(e,n)},[]);(0,a.useEffect)(()=>{if(i)return;let e=Date.now(),r=n.map(n=>{if(n.duration===1/0)return;let i=(n.duration||0)+n.pauseDuration-(e-n.createdAt);if(!(i<0))return setTimeout(()=>$.dismiss(n.id,t),i);n.visible&&$.dismiss(n.id)});return()=>{r.forEach(e=>e&&clearTimeout(e))}},[n,i,t]);let s=(0,a.useCallback)(K(t),[t]),c=(0,a.useCallback)(()=>{s({type:5,time:Date.now()})},[s]),l=(0,a.useCallback)((e,t)=>{s({type:1,toast:{id:e,height:t}})},[s]),u=(0,a.useCallback)(()=>{i&&s({type:6,time:Date.now()})},[i,s]),d=(0,a.useCallback)((e,t)=>{let{reverseOrder:i=!1,gutter:r=8,defaultPosition:o}=t||{},a=n.filter(t=>(t.position||o)===(e.position||o)&&t.height),s=a.findIndex(t=>t.id===e.id),c=a.filter((e,t)=>t<s&&e.visible).length;return a.filter(e=>e.visible).slice(...i?[c+1]:[0,c]).reduce((e,t)=>e+(t.height||0)+r,0)},[n]);return(0,a.useEffect)(()=>{n.forEach(e=>{if(e.dismissed)o(e.id,e.removeDelay);else{let t=r.get(e.id);t&&(clearTimeout(t),r.delete(e.id))}})},[n,o]),{toasts:n,handlers:{updateHeight:l,startPause:c,endPause:u,calculateOffset:d}}})(n,o);return a.createElement("div",{"data-rht-toaster":o||"",style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...s},className:c,onMouseEnter:u.startPause,onMouseLeave:u.endPause},l.map(n=>{let o=n.position||t,s=((e,t)=>{let n=e.includes("top"),i=n?{top:0}:{bottom:0},r=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:j()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...i,...r}})(o,u.calculateOffset(n,{reverseOrder:e,gutter:i,defaultPosition:t}));return a.createElement(ge,{id:n.id,key:n.id,onHeightUpdate:u.updateHeight,className:n.visible?ve:"",style:s},"custom"===n.type?M(n.message,n):r?r(n):a.createElement(me,{toast:n,position:o}))}))},be=$;const ke=Object.create(null);ke.open="0",ke.close="1",ke.ping="2",ke.pong="3",ke.message="4",ke.upgrade="5",ke.noop="6";const we=Object.create(null);Object.keys(ke).forEach(e=>{we[ke[e]]=e});const Se={type:"error",data:"parser error"},Te="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Ce="function"==typeof ArrayBuffer,Ee=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Pe=({type:e,data:t},n,i)=>Te&&t instanceof Blob?n?i(t):Re(t,i):Ce&&(t instanceof ArrayBuffer||Ee(t))?n?i(t):Re(new Blob([t]),i):i(ke[e]+(t||"")),Re=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function xe(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let _e;const Oe="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<64;e++)Oe["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;const Ie="function"==typeof ArrayBuffer,Ne=(e,t)=>{if("string"!=typeof e)return{type:"message",data:De(e,t)};const n=e.charAt(0);return"b"===n?{type:"message",data:Ae(e.substring(1),t)}:we[n]?e.length>1?{type:we[n],data:e.substring(1)}:{type:we[n]}:Se},Ae=(e,t)=>{if(Ie){const n=(e=>{let t,n,i,r,o,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);const l=new ArrayBuffer(a),u=new Uint8Array(l);for(t=0;t<s;t+=4)n=Oe[e.charCodeAt(t)],i=Oe[e.charCodeAt(t+1)],r=Oe[e.charCodeAt(t+2)],o=Oe[e.charCodeAt(t+3)],u[c++]=n<<2|i>>4,u[c++]=(15&i)<<4|r>>2,u[c++]=(3&r)<<6|63&o;return l})(e);return De(n,t)}return{base64:!0,data:e}},De=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,Le=String.fromCharCode(30);let Me;function Ue(e){return e.reduce((e,t)=>e+t.length,0)}function je(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let i=0;for(let r=0;r<t;r++)n[r]=e[0][i++],i===e[0].length&&(e.shift(),i=0);return e.length&&i<e[0].length&&(e[0]=e[0].slice(i)),n}function Fe(e){if(e)return function(e){for(var t in Fe.prototype)e[t]=Fe.prototype[t];return e}(e)}Fe.prototype.on=Fe.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Fe.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},Fe.prototype.off=Fe.prototype.removeListener=Fe.prototype.removeAllListeners=Fe.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r=0;r<i.length;r++)if((n=i[r])===t||n.fn===t){i.splice(r,1);break}return 0===i.length&&delete this._callbacks["$"+e],this},Fe.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(n){i=0;for(var r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,t)}return this},Fe.prototype.emitReserved=Fe.prototype.emit,Fe.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Fe.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Be="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),ze="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function qe(e,...t){return t.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{})}const Ve=ze.setTimeout,He=ze.clearTimeout;function We(e,t){t.useNativeTimers?(e.setTimeoutFn=Ve.bind(ze),e.clearTimeoutFn=He.bind(ze)):(e.setTimeoutFn=ze.setTimeout.bind(ze),e.clearTimeoutFn=ze.clearTimeout.bind(ze))}function Ke(e){return"string"==typeof e?function(e){let t=0,n=0;for(let i=0,r=e.length;i<r;i++)t=e.charCodeAt(i),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))}function Ge(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class Je extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class $e extends Fe{constructor(e){super(),this.writable=!1,We(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new Je(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Ne(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&443!==Number(this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}class Qe extends $e{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(Le),i=[];for(let e=0;e<n.length;e++){const r=Ne(n[e],t);if(i.push(r),"error"===r.type)break}return i})(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const n=e.length,i=new Array(n);let r=0;e.forEach((e,o)=>{Pe(e,!1,e=>{i[o]=e,++r===n&&t(i.join(Le))})})})(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=Ge()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let Ye=!1;try{Ye="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}const Xe=Ye;function Ze(){}class et extends Qe{constructor(e){if(super(e),"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class tt extends Fe{constructor(e,t,n){super(),this.createRequest=e,We(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=void 0!==n.data?n.data:null,this._create()}_create(){var e;const t=qe(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(e){}if("POST"===this._method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(n.getResponseHeader("set-cookie"))),4===n.readyState&&(200===n.status||1223===n.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof n.status?n.status:0)},0))},n.send(this._data)}catch(e){return void this.setTimeoutFn(()=>{this._onError(e)},0)}"undefined"!=typeof document&&(this._index=tt.requestsCount++,tt.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=Ze,e)try{this._xhr.abort()}catch(e){}"undefined"!=typeof document&&delete tt.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function nt(){for(let e in tt.requests)tt.requests.hasOwnProperty(e)&&tt.requests[e].abort()}tt.requestsCount=0,tt.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",nt):"function"==typeof addEventListener&&addEventListener("onpagehide"in ze?"pagehide":"unload",nt,!1));const it=function(){const e=rt({xdomain:!1});return e&&null!==e.responseType}();function rt(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||Xe))return new XMLHttpRequest}catch(e){}if(!t)try{return new(ze[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}const ot="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class at extends $e{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=ot?{}:qe(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],i=t===e.length-1;Pe(n,this.supportsBinary,e=>{try{this.doWrite(n,e)}catch(e){}i&&Be(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Ge()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const st=ze.WebSocket||ze.MozWebSocket,ct={websocket:class extends at{createSocket(e,t,n){return ot?new st(e,t,n):t?new st(e,t):new st(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends $e{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=function(e,t){Me||(Me=new TextDecoder);const n=[];let i=0,r=-1,o=!1;return new TransformStream({transform(a,s){for(n.push(a);;){if(0===i){if(Ue(n)<1)break;const e=je(n,1);o=!(128&~e[0]),r=127&e[0],i=r<126?3:126===r?1:2}else if(1===i){if(Ue(n)<2)break;const e=je(n,2);r=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),i=3}else if(2===i){if(Ue(n)<8)break;const e=je(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),o=t.getUint32(0);if(o>Math.pow(2,21)-1){s.enqueue(Se);break}r=o*Math.pow(2,32)+t.getUint32(4),i=3}else{if(Ue(n)<r)break;const e=je(n,r);s.enqueue(Ne(o?e:Me.decode(e),t)),i=0}if(0===r||r>e){s.enqueue(Se);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),i=new TransformStream({transform(e,t){!function(e,t){Te&&e.data instanceof Blob?e.data.arrayBuffer().then(xe).then(t):Ce&&(e.data instanceof ArrayBuffer||Ee(e.data))?t(xe(e.data)):Pe(e,!1,e=>{_e||(_e=new TextEncoder),t(_e.encode(e))})}(e,n=>{const i=n.length;let r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);const e=new DataView(r.buffer);e.setUint8(0,126),e.setUint16(1,i)}else{r=new Uint8Array(9);const e=new DataView(r.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(i))}e.data&&"string"!=typeof e.data&&(r[0]|=128),t.enqueue(r),t.enqueue(n)})}});i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const r=()=>{n.read().then(({done:e,value:t})=>{e||(this.onPacket(t),r())}).catch(e=>{})};r();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],i=t===e.length-1;this._writer.write(n).then(()=>{i&&Be(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends et{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=it&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new tt(rt,this.uri(),e)}}},lt=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ut=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function dt(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),i=e.indexOf("]");-1!=n&&-1!=i&&(e=e.substring(0,n)+e.substring(n,i).replace(/:/g,";")+e.substring(i,e.length));let r=lt.exec(e||""),o={},a=14;for(;a--;)o[ut[a]]=r[a]||"";return-1!=n&&-1!=i&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){const n=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1),"/"==t.slice(-1)&&n.splice(n.length-1,1),n}(0,o.path),o.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,i){t&&(n[t]=i)}),n}(0,o.query),o}const ht="function"==typeof addEventListener&&"function"==typeof removeEventListener,pt=[];ht&&addEventListener("offline",()=>{pt.forEach(e=>e())},!1);class ft extends Fe{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(t=e,e=null),e){const n=dt(e);t.hostname=n.host,t.secure="https"===n.protocol||"wss"===n.protocol,t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=dt(t.host).host);We(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let e=0,i=n.length;e<i;e++){let i=n[e].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}(this.opts.query)),ht&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},pt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&ft.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",ft.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const n=this.writeBuffer[t].data;if(n&&(e+=Ke(n)),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Be(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof n&&(i=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const r={type:e,data:t,options:n};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(ft.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ht&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=pt.indexOf(this._offlineEventListener);-1!==e&&pt.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}ft.protocol=4;class mt extends ft{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;ft.priorWebsocketSuccess=!1;const i=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;ft.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function r(){n||(n=!0,l(),t.close(),t=null)}const o=e=>{const n=new Error("probe error: "+e);n.transport=t.name,r(),this.emitReserved("upgradeError",n)};function a(){o("transport closed")}function s(){o("socket closed")}function c(e){t&&e.name!==t.name&&r()}const l=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",a),this.off("close",s),this.off("upgrading",c)};t.once("open",i),t.once("error",o),t.once("close",a),this.once("close",s),this.once("upgrading",c),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}class gt extends mt{constructor(e,t={}){const n="object"==typeof e?e:t;(!n.transports||n.transports&&"string"==typeof n.transports[0])&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(e=>ct[e]).filter(e=>!!e)),super(e,n)}}const vt="function"==typeof ArrayBuffer,yt=Object.prototype.toString,bt="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===yt.call(Blob),kt="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===yt.call(File);function wt(e){return vt&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||bt&&e instanceof Blob||kt&&e instanceof File}function St(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(St(e[t]))return!0;return!1}if(wt(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return St(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&St(e[t]))return!0;return!1}function Tt(e){const t=[],n=e.data,i=e;return i.data=Ct(n,t),i.attachments=t.length,{packet:i,buffers:t}}function Ct(e,t){if(!e)return e;if(wt(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=Ct(e[i],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=Ct(e[i],t));return n}return e}function Et(e,t){return e.data=Pt(e.data,t),delete e.attachments,e}function Pt(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Pt(e[n],t);else if("object"==typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Pt(e[n],t));return e}const Rt=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],xt=5;var _t;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(_t||(_t={}));class Ot{constructor(e){this.replacer=e}encode(e){return e.type!==_t.EVENT&&e.type!==_t.ACK||!St(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===_t.EVENT?_t.BINARY_EVENT:_t.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==_t.BINARY_EVENT&&e.type!==_t.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Tt(e),n=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(n),i}}class It extends Fe{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===_t.BINARY_EVENT;n||t.type===_t.BINARY_ACK?(t.type=n?_t.EVENT:_t.ACK,this.reconstructor=new Nt(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!wt(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===_t[n.type])throw new Error("unknown packet type "+n.type);if(n.type===_t.BINARY_EVENT||n.type===_t.BINARY_ACK){const i=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const r=e.substring(i,t);if(r!=Number(r)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===e.charAt(t+1)){const i=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);n.nsp=e.substring(i,t)}else n.nsp="/";const i=e.charAt(t+1);if(""!==i&&Number(i)==i){const i=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(!It.isPayloadValid(n.type,i))throw new Error("invalid payload");n.data=i}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case _t.CONNECT:return Dt(t);case _t.DISCONNECT:return void 0===t;case _t.CONNECT_ERROR:return"string"==typeof t||Dt(t);case _t.EVENT:case _t.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===Rt.indexOf(t[0]));case _t.ACK:case _t.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Nt{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Et(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const At=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function Dt(e){return"[object Object]"===Object.prototype.toString.call(e)}function Lt(e){return"string"==typeof e.nsp&&(void 0===(t=e.id)||At(t))&&function(e,t){switch(e){case _t.CONNECT:return void 0===t||Dt(t);case _t.DISCONNECT:return void 0===t;case _t.EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===Rt.indexOf(t[0]));case _t.ACK:return Array.isArray(t);case _t.CONNECT_ERROR:return"string"==typeof t||Dt(t);default:return!1}}(e.type,e.data);var t}function Mt(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Ut=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class jt extends Fe{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Mt(e,"open",this.onopen.bind(this)),Mt(e,"packet",this.onpacket.bind(this)),Mt(e,"error",this.onerror.bind(this)),Mt(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,i,r;if(Ut.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:_t.EVENT,data:t,options:{}};if(o.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,n=t.pop();this._registerAckCallback(e,n),o.id=e}const a=null===(i=null===(n=this.io.engine)||void 0===n?void 0:n.transport)||void 0===i?void 0:i.writable,s=this.connected&&!(null===(r=this.io.engine)||void 0===r?void 0:r._hasPingExpired());return this.flags.volatile&&!a||(s?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var n;const i=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===i)return void(this.acks[e]=t);const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))},i),o=(...e)=>{this.io.clearTimeoutFn(r),t.apply(this,e)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((n,i)=>{const r=(e,t)=>e?i(e):n(t);r.withError=!0,t.push(r),this.emit(e,...t)})}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...i)=>(this._queue[0],null!==e?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:_t.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case _t.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case _t.EVENT:case _t.BINARY_EVENT:this.onevent(e);break;case _t.ACK:case _t.BINARY_ACK:this.onack(e);break;case _t.DISCONNECT:this.ondisconnect();break;case _t.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...i){n||(n=!0,t.packet({type:_t.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:_t.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Ft(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Ft.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=1&Math.floor(10*t)?e+n:e-n}return 0|Math.min(e,this.max)},Ft.prototype.reset=function(){this.attempts=0},Ft.prototype.setMin=function(e){this.ms=e},Ft.prototype.setMax=function(e){this.max=e},Ft.prototype.setJitter=function(e){this.jitter=e};class Bt extends Fe{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,We(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Ft({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||r;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new gt(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=Mt(t,"open",function(){n.onopen(),e&&e()}),r=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=Mt(t,"error",r);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn(()=>{i(),r(new Error("timeout")),t.close()},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Mt(e,"ping",this.onping.bind(this)),Mt(e,"data",this.ondata.bind(this)),Mt(e,"error",this.onerror.bind(this)),Mt(e,"close",this.onclose.bind(this)),Mt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){Be(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new jt(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const e of t)if(this.nsps[e].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const zt={};function qt(e,t){"object"==typeof e&&(t=e,e=void 0);const n=function(e,t="",n){let i=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),i=dt(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+t,i.href=i.protocol+"://"+r+(n&&n.port===i.port?"":":"+i.port),i}(e,(t=t||{}).path||"/socket.io"),i=n.source,r=n.id,o=n.path,a=zt[r]&&o in zt[r].nsps;let s;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?s=new Bt(i,t):(zt[r]||(zt[r]=new Bt(i,t)),s=zt[r]),n.query&&!t.query&&(t.query=n.queryKey),s.socket(n.path,t)}function Vt(e,t){return function(){return e.apply(t,arguments)}}Object.assign(qt,{Manager:Bt,Socket:jt,io:qt,connect:qt});const{toString:Ht}=Object.prototype,{getPrototypeOf:Wt}=Object,{iterator:Kt,toStringTag:Gt}=Symbol,Jt=(e=>t=>{const n=Ht.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),$t=e=>(e=e.toLowerCase(),t=>Jt(t)===e),Qt=e=>t=>typeof t===e,{isArray:Yt}=Array,Xt=Qt("undefined");function Zt(e){return null!==e&&!Xt(e)&&null!==e.constructor&&!Xt(e.constructor)&&nn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const en=$t("ArrayBuffer"),tn=Qt("string"),nn=Qt("function"),rn=Qt("number"),on=e=>null!==e&&"object"==typeof e,an=e=>{if("object"!==Jt(e))return!1;const t=Wt(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Gt in e||Kt in e)},sn=$t("Date"),cn=$t("File"),ln=$t("Blob"),un=$t("FileList"),dn=$t("URLSearchParams"),[hn,pn,fn,mn]=["ReadableStream","Request","Response","Headers"].map($t);function gn(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let i,r;if("object"!=typeof e&&(e=[e]),Yt(e))for(i=0,r=e.length;i<r;i++)t.call(null,e[i],i,e);else{if(Zt(e))return;const r=n?Object.getOwnPropertyNames(e):Object.keys(e),o=r.length;let a;for(i=0;i<o;i++)a=r[i],t.call(null,e[a],a,e)}}function vn(e,t){if(Zt(e))return null;t=t.toLowerCase();const n=Object.keys(e);let i,r=n.length;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const yn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:n.g,bn=e=>!Xt(e)&&e!==yn,kn=(wn="undefined"!=typeof Uint8Array&&Wt(Uint8Array),e=>wn&&e instanceof wn);var wn;const Sn=$t("HTMLFormElement"),Tn=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Cn=$t("RegExp"),En=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};gn(n,(n,r)=>{let o;!1!==(o=t(n,r,e))&&(i[r]=o||n)}),Object.defineProperties(e,i)},Pn=$t("AsyncFunction"),Rn=(xn="function"==typeof setImmediate,_n=nn(yn.postMessage),xn?setImmediate:_n?(On=`axios@${Math.random()}`,In=[],yn.addEventListener("message",({source:e,data:t})=>{e===yn&&t===On&&In.length&&In.shift()()},!1),e=>{In.push(e),yn.postMessage(On,"*")}):e=>setTimeout(e));var xn,_n,On,In;const Nn="undefined"!=typeof queueMicrotask?queueMicrotask.bind(yn):"undefined"!=typeof process&&process.nextTick||Rn,An={isArray:Yt,isArrayBuffer:en,isBuffer:Zt,isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||nn(e.append)&&("formdata"===(t=Jt(e))||"object"===t&&nn(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&en(e.buffer),t},isString:tn,isNumber:rn,isBoolean:e=>!0===e||!1===e,isObject:on,isPlainObject:an,isEmptyObject:e=>{if(!on(e)||Zt(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(e){return!1}},isReadableStream:hn,isRequest:pn,isResponse:fn,isHeaders:mn,isUndefined:Xt,isDate:sn,isFile:cn,isBlob:ln,isRegExp:Cn,isFunction:nn,isStream:e=>on(e)&&nn(e.pipe),isURLSearchParams:dn,isTypedArray:kn,isFileList:un,forEach:gn,merge:function e(){const{caseless:t,skipUndefined:n}=bn(this)&&this||{},i={},r=(r,o)=>{const a=t&&vn(i,o)||o;an(i[a])&&an(r)?i[a]=e(i[a],r):an(r)?i[a]=e({},r):Yt(r)?i[a]=r.slice():n&&Xt(r)||(i[a]=r)};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&gn(arguments[e],r);return i},extend:(e,t,n,{allOwnKeys:i}={})=>(gn(t,(t,i)=>{n&&nn(t)?e[i]=Vt(t,n):e[i]=t},{allOwnKeys:i}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let r,o,a;const s={};if(t=t||{},null==e)return t;do{for(r=Object.getOwnPropertyNames(e),o=r.length;o-- >0;)a=r[o],i&&!i(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&Wt(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:Jt,kindOfTest:$t,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if(Yt(e))return e;let t=e.length;if(!rn(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Kt]).call(e);let i;for(;(i=n.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:Sn,hasOwnProperty:Tn,hasOwnProp:Tn,reduceDescriptors:En,freezeMethods:e=>{En(e,(t,n)=>{if(nn(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];nn(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},i=e=>{e.forEach(e=>{n[e]=!0})};return Yt(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:vn,global:yn,isContextDefined:bn,isSpecCompliantForm:function(e){return!!(e&&nn(e.append)&&"FormData"===e[Gt]&&e[Kt])},toJSONObject:e=>{const t=new Array(10),n=(e,i)=>{if(on(e)){if(t.indexOf(e)>=0)return;if(Zt(e))return e;if(!("toJSON"in e)){t[i]=e;const r=Yt(e)?[]:{};return gn(e,(e,t)=>{const o=n(e,i+1);!Xt(o)&&(r[t]=o)}),t[i]=void 0,r}}return e};return n(e,0)},isAsyncFn:Pn,isThenable:e=>e&&(on(e)||nn(e))&&nn(e.then)&&nn(e.catch),setImmediate:Rn,asap:Nn,isIterable:e=>null!=e&&nn(e[Kt])};function Dn(e,t,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}An.inherits(Dn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:An.toJSONObject(this.config),code:this.code,status:this.status}}});const Ln=Dn.prototype,Mn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Mn[e]={value:e}}),Object.defineProperties(Dn,Mn),Object.defineProperty(Ln,"isAxiosError",{value:!0}),Dn.from=(e,t,n,i,r,o)=>{const a=Object.create(Ln);An.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const s=e&&e.message?e.message:"Error",c=null==t&&e?e.code:t;return Dn.call(a,s,c,n,i,r),e&&null==a.cause&&Object.defineProperty(a,"cause",{value:e,configurable:!0}),a.name=e&&e.name||"Error",o&&Object.assign(a,o),a};const Un=Dn;function jn(e){return An.isPlainObject(e)||An.isArray(e)}function Fn(e){return An.endsWith(e,"[]")?e.slice(0,-2):e}function Bn(e,t,n){return e?e.concat(t).map(function(e,t){return e=Fn(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const zn=An.toFlatObject(An,{},null,function(e){return/^is[A-Z]/.test(e)}),qn=function(e,t,n){if(!An.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=An.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!An.isUndefined(t[e])})).metaTokens,r=n.visitor||l,o=n.dots,a=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&An.isSpecCompliantForm(t);if(!An.isFunction(r))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(An.isDate(e))return e.toISOString();if(An.isBoolean(e))return e.toString();if(!s&&An.isBlob(e))throw new Un("Blob is not supported. Use a Buffer instead.");return An.isArrayBuffer(e)||An.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,r){let s=e;if(e&&!r&&"object"==typeof e)if(An.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(An.isArray(e)&&function(e){return An.isArray(e)&&!e.some(jn)}(e)||(An.isFileList(e)||An.endsWith(n,"[]"))&&(s=An.toArray(e)))return n=Fn(n),s.forEach(function(e,i){!An.isUndefined(e)&&null!==e&&t.append(!0===a?Bn([n],i,o):null===a?n:n+"[]",c(e))}),!1;return!!jn(e)||(t.append(Bn(r,n,o),c(e)),!1)}const u=[],d=Object.assign(zn,{defaultVisitor:l,convertValue:c,isVisitable:jn});if(!An.isObject(e))throw new TypeError("data must be an object");return function e(n,i){if(!An.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),An.forEach(n,function(n,o){!0===(!(An.isUndefined(n)||null===n)&&r.call(t,n,An.isString(o)?o.trim():o,i,d))&&e(n,i?i.concat(o):[o])}),u.pop()}}(e),t};function Vn(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function Hn(e,t){this._pairs=[],e&&qn(e,this,t)}const Wn=Hn.prototype;Wn.append=function(e,t){this._pairs.push([e,t])},Wn.toString=function(e){const t=e?function(t){return e.call(this,t,Vn)}:Vn;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const Kn=Hn;function Gn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Jn(e,t,n){if(!t)return e;const i=n&&n.encode||Gn;An.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let o;if(o=r?r(t,n):An.isURLSearchParams(t)?t.toString():new Kn(t,n).toString(i),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}const $n=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){An.forEach(this.handlers,function(t){null!==t&&e(t)})}},Qn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Yn={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Kn,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Xn="undefined"!=typeof window&&"undefined"!=typeof document,Zn="object"==typeof navigator&&navigator||void 0,ei=Xn&&(!Zn||["ReactNative","NativeScript","NS"].indexOf(Zn.product)<0),ti="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,ni=Xn&&window.location.href||"http://localhost",ii={...o,...Yn},ri=function(e){function t(e,n,i,r){let o=e[r++];if("__proto__"===o)return!0;const a=Number.isFinite(+o),s=r>=e.length;return o=!o&&An.isArray(i)?i.length:o,s?(An.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!a):(i[o]&&An.isObject(i[o])||(i[o]=[]),t(e,n,i[o],r)&&An.isArray(i[o])&&(i[o]=function(e){const t={},n=Object.keys(e);let i;const r=n.length;let o;for(i=0;i<r;i++)o=n[i],t[o]=e[o];return t}(i[o])),!a)}if(An.isFormData(e)&&An.isFunction(e.entries)){const n={};return An.forEachEntry(e,(e,i)=>{t(function(e){return An.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),i,n,0)}),n}return null},oi={transitional:Qn,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,r=An.isObject(e);if(r&&An.isHTMLForm(e)&&(e=new FormData(e)),An.isFormData(e))return i?JSON.stringify(ri(e)):e;if(An.isArrayBuffer(e)||An.isBuffer(e)||An.isStream(e)||An.isFile(e)||An.isBlob(e)||An.isReadableStream(e))return e;if(An.isArrayBufferView(e))return e.buffer;if(An.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return qn(e,new ii.classes.URLSearchParams,{visitor:function(e,t,n,i){return ii.isNode&&An.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}(e,this.formSerializer).toString();if((o=An.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return qn(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return r||i?(t.setContentType("application/json",!1),function(e){if(An.isString(e))try{return(0,JSON.parse)(e),An.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||oi.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(An.isResponse(e)||An.isReadableStream(e))return e;if(e&&An.isString(e)&&(n&&!this.responseType||i)){const n=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(e){if(n){if("SyntaxError"===e.name)throw Un.from(e,Un.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ii.classes.FormData,Blob:ii.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};An.forEach(["delete","get","head","post","put","patch"],e=>{oi.headers[e]={}});const ai=oi,si=An.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ci=Symbol("internals");function li(e){return e&&String(e).trim().toLowerCase()}function ui(e){return!1===e||null==e?e:An.isArray(e)?e.map(ui):String(e)}function di(e,t,n,i,r){return An.isFunction(i)?i.call(this,t,n):(r&&(t=n),An.isString(t)?An.isString(i)?-1!==t.indexOf(i):An.isRegExp(i)?i.test(t):void 0:void 0)}class hi{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function r(e,t,n){const r=li(t);if(!r)throw new Error("header name must be a non-empty string");const o=An.findKey(i,r);(!o||void 0===i[o]||!0===n||void 0===n&&!1!==i[o])&&(i[o||t]=ui(e))}const o=(e,t)=>An.forEach(e,(e,n)=>r(e,n,t));if(An.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(An.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))o((e=>{const t={};let n,i,r;return e&&e.split("\n").forEach(function(e){r=e.indexOf(":"),n=e.substring(0,r).trim().toLowerCase(),i=e.substring(r+1).trim(),!n||t[n]&&si[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)}),t})(e),t);else if(An.isObject(e)&&An.isIterable(e)){let n,i,r={};for(const t of e){if(!An.isArray(t))throw TypeError("Object iterator must return a key-value pair");r[i=t[0]]=(n=r[i])?An.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}o(r,t)}else null!=e&&r(t,e,n);return this}get(e,t){if(e=li(e)){const n=An.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}(e);if(An.isFunction(t))return t.call(this,e,n);if(An.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=li(e)){const n=An.findKey(this,e);return!(!n||void 0===this[n]||t&&!di(0,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function r(e){if(e=li(e)){const r=An.findKey(n,e);!r||t&&!di(0,n[r],r,t)||(delete n[r],i=!0)}}return An.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const r=t[n];e&&!di(0,this[r],r,e,!0)||(delete this[r],i=!0)}return i}normalize(e){const t=this,n={};return An.forEach(this,(i,r)=>{const o=An.findKey(n,r);if(o)return t[o]=ui(i),void delete t[r];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(r):String(r).trim();a!==r&&delete t[r],t[a]=ui(i),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return An.forEach(this,(n,i)=>{null!=n&&!1!==n&&(t[i]=e&&An.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(e=>n.set(e)),n}static accessor(e){const t=(this[ci]=this[ci]={accessors:{}}).accessors,n=this.prototype;function i(e){const i=li(e);t[i]||(function(e,t){const n=An.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+n,{value:function(e,n,r){return this[i].call(this,t,e,n,r)},configurable:!0})})}(n,e),t[i]=!0)}return An.isArray(e)?e.forEach(i):i(e),this}}hi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),An.reduceDescriptors(hi.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}}),An.freezeMethods(hi);const pi=hi;function fi(e,t){const n=this||ai,i=t||n,r=pi.from(i.headers);let o=i.data;return An.forEach(e,function(e){o=e.call(n,o,r.normalize(),t?t.status:void 0)}),r.normalize(),o}function mi(e){return!(!e||!e.__CANCEL__)}function gi(e,t,n){Un.call(this,null==e?"canceled":e,Un.ERR_CANCELED,t,n),this.name="CanceledError"}An.inherits(gi,Un,{__CANCEL__:!0});const vi=gi;function yi(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new Un("Request failed with status code "+n.status,[Un.ERR_BAD_REQUEST,Un.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const bi=(e,t,n=3)=>{let i=0;const r=function(e,t){e=e||10;const n=new Array(e),i=new Array(e);let r,o=0,a=0;return t=void 0!==t?t:1e3,function(s){const c=Date.now(),l=i[a];r||(r=c),n[o]=s,i[o]=c;let u=a,d=0;for(;u!==o;)d+=n[u++],u%=e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),c-r<t)return;const h=l&&c-l;return h?Math.round(1e3*d/h):void 0}}(50,250);return function(e,t){let n,i,r=0,o=1e3/t;const a=(t,o=Date.now())=>{r=o,n=null,i&&(clearTimeout(i),i=null),e(...t)};return[(...e)=>{const t=Date.now(),s=t-r;s>=o?a(e,t):(n=e,i||(i=setTimeout(()=>{i=null,a(n)},o-s)))},()=>n&&a(n)]}(n=>{const o=n.loaded,a=n.lengthComputable?n.total:void 0,s=o-i,c=r(s);i=o,e({loaded:o,total:a,progress:a?o/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&o<=a?(a-o)/c:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0})},n)},ki=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},wi=e=>(...t)=>An.asap(()=>e(...t)),Si=ii.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ii.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ii.origin),ii.navigator&&/(msie|trident)/i.test(ii.navigator.userAgent)):()=>!0,Ti=ii.hasStandardBrowserEnv?{write(e,t,n,i,r,o,a){if("undefined"==typeof document)return;const s=[`${e}=${encodeURIComponent(t)}`];An.isNumber(n)&&s.push(`expires=${new Date(n).toUTCString()}`),An.isString(i)&&s.push(`path=${i}`),An.isString(r)&&s.push(`domain=${r}`),!0===o&&s.push("secure"),An.isString(a)&&s.push(`SameSite=${a}`),document.cookie=s.join("; ")},read(e){if("undefined"==typeof document)return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function Ci(e,t,n){let i=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(i||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Ei=e=>e instanceof pi?{...e}:e;function Pi(e,t){t=t||{};const n={};function i(e,t,n,i){return An.isPlainObject(e)&&An.isPlainObject(t)?An.merge.call({caseless:i},e,t):An.isPlainObject(t)?An.merge({},t):An.isArray(t)?t.slice():t}function r(e,t,n,r){return An.isUndefined(t)?An.isUndefined(e)?void 0:i(void 0,e,0,r):i(e,t,0,r)}function o(e,t){if(!An.isUndefined(t))return i(void 0,t)}function a(e,t){return An.isUndefined(t)?An.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function s(n,r,o){return o in t?i(n,r):o in e?i(void 0,n):void 0}const c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t,n)=>r(Ei(e),Ei(t),0,!0)};return An.forEach(Object.keys({...e,...t}),function(i){const o=c[i]||r,a=o(e[i],t[i],i);An.isUndefined(a)&&o!==s||(n[i]=a)}),n}const Ri=e=>{const t=Pi({},e);let{data:n,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:o,headers:a,auth:s}=t;if(t.headers=a=pi.from(a),t.url=Jn(Ci(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),s&&a.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),An.isFormData(n))if(ii.hasStandardBrowserEnv||ii.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(An.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(([e,n])=>{t.includes(e.toLowerCase())&&a.set(e,n)})}if(ii.hasStandardBrowserEnv&&(i&&An.isFunction(i)&&(i=i(t)),i||!1!==i&&Si(t.url))){const e=r&&o&&Ti.read(o);e&&a.set(r,e)}return t},xi="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const i=Ri(e);let r=i.data;const o=pi.from(i.headers).normalize();let a,s,c,l,u,{responseType:d,onUploadProgress:h,onDownloadProgress:p}=i;function f(){l&&l(),u&&u(),i.cancelToken&&i.cancelToken.unsubscribe(a),i.signal&&i.signal.removeEventListener("abort",a)}let m=new XMLHttpRequest;function g(){if(!m)return;const i=pi.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());yi(function(e){t(e),f()},function(e){n(e),f()},{data:d&&"text"!==d&&"json"!==d?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:e,request:m}),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new Un("Request aborted",Un.ECONNABORTED,e,m)),m=null)},m.onerror=function(t){const i=t&&t.message?t.message:"Network Error",r=new Un(i,Un.ERR_NETWORK,e,m);r.event=t||null,n(r),m=null},m.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||Qn;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new Un(t,r.clarifyTimeoutError?Un.ETIMEDOUT:Un.ECONNABORTED,e,m)),m=null},void 0===r&&o.setContentType(null),"setRequestHeader"in m&&An.forEach(o.toJSON(),function(e,t){m.setRequestHeader(t,e)}),An.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),d&&"json"!==d&&(m.responseType=i.responseType),p&&([c,u]=bi(p,!0),m.addEventListener("progress",c)),h&&m.upload&&([s,l]=bi(h),m.upload.addEventListener("progress",s),m.upload.addEventListener("loadend",l)),(i.cancelToken||i.signal)&&(a=t=>{m&&(n(!t||t.type?new vi(null,e,m):t),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(a),i.signal&&(i.signal.aborted?a():i.signal.addEventListener("abort",a)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);v&&-1===ii.protocols.indexOf(v)?n(new Un("Unsupported protocol "+v+":",Un.ERR_BAD_REQUEST,e)):m.send(r||null)})},_i=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,i=new AbortController;const r=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;i.abort(t instanceof Un?t:new vi(t instanceof Error?t.message:t))}};let o=t&&setTimeout(()=>{o=null,r(new Un(`timeout ${t} of ms exceeded`,Un.ETIMEDOUT))},t);const a=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)}),e=null)};e.forEach(e=>e.addEventListener("abort",r));const{signal:s}=i;return s.unsubscribe=()=>An.asap(a),s}},Oi=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,r=0;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},Ii=(e,t,n,i)=>{const r=async function*(e,t){for await(const n of async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}}(e))yield*Oi(n,t)}(e,t);let o,a=0,s=e=>{o||(o=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await r.next();if(t)return s(),void e.close();let o=i.byteLength;if(n){let e=a+=o;n(e)}e.enqueue(new Uint8Array(i))}catch(e){throw s(e),e}},cancel:e=>(s(e),r.return())},{highWaterMark:2})},{isFunction:Ni}=An,Ai=(({Request:e,Response:t})=>({Request:e,Response:t}))(An.global),{ReadableStream:Di,TextEncoder:Li}=An.global,Mi=(e,...t)=>{try{return!!e(...t)}catch(e){return!1}},Ui=e=>{e=An.merge.call({skipUndefined:!0},Ai,e);const{fetch:t,Request:n,Response:i}=e,r=t?Ni(t):"function"==typeof fetch,o=Ni(n),a=Ni(i);if(!r)return!1;const s=r&&Ni(Di),c=r&&("function"==typeof Li?(l=new Li,e=>l.encode(e)):async e=>new Uint8Array(await new n(e).arrayBuffer()));var l;const u=o&&s&&Mi(()=>{let e=!1;const t=new n(ii.origin,{body:new Di,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),d=a&&s&&Mi(()=>An.isReadableStream(new i("").body)),h={stream:d&&(e=>e.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!h[e]&&(h[e]=(t,n)=>{let i=t&&t[e];if(i)return i.call(t);throw new Un(`Response type '${e}' is not supported`,Un.ERR_NOT_SUPPORT,n)})});return async e=>{let{url:r,method:a,data:s,signal:l,cancelToken:p,timeout:f,onDownloadProgress:m,onUploadProgress:g,responseType:v,headers:y,withCredentials:b="same-origin",fetchOptions:k}=Ri(e),w=t||fetch;v=v?(v+"").toLowerCase():"text";let S=_i([l,p&&p.toAbortSignal()],f),T=null;const C=S&&S.unsubscribe&&(()=>{S.unsubscribe()});let E;try{if(g&&u&&"get"!==a&&"head"!==a&&0!==(E=await(async(e,t)=>{const i=An.toFiniteNumber(e.getContentLength());return null==i?(async e=>{if(null==e)return 0;if(An.isBlob(e))return e.size;if(An.isSpecCompliantForm(e)){const t=new n(ii.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return An.isArrayBufferView(e)||An.isArrayBuffer(e)?e.byteLength:(An.isURLSearchParams(e)&&(e+=""),An.isString(e)?(await c(e)).byteLength:void 0)})(t):i})(y,s))){let e,t=new n(r,{method:"POST",body:s,duplex:"half"});if(An.isFormData(s)&&(e=t.headers.get("content-type"))&&y.setContentType(e),t.body){const[e,n]=ki(E,bi(wi(g)));s=Ii(t.body,65536,e,n)}}An.isString(b)||(b=b?"include":"omit");const t=o&&"credentials"in n.prototype,l={...k,signal:S,method:a.toUpperCase(),headers:y.normalize().toJSON(),body:s,duplex:"half",credentials:t?b:void 0};T=o&&new n(r,l);let p=await(o?w(T,k):w(r,l));const f=d&&("stream"===v||"response"===v);if(d&&(m||f&&C)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=p[t]});const t=An.toFiniteNumber(p.headers.get("content-length")),[n,r]=m&&ki(t,bi(wi(m),!0))||[];p=new i(Ii(p.body,65536,n,()=>{r&&r(),C&&C()}),e)}v=v||"text";let P=await h[An.findKey(h,v)||"text"](p,e);return!f&&C&&C(),await new Promise((t,n)=>{yi(t,n,{data:P,headers:pi.from(p.headers),status:p.status,statusText:p.statusText,config:e,request:T})})}catch(t){if(C&&C(),t&&"TypeError"===t.name&&/Load failed|fetch/i.test(t.message))throw Object.assign(new Un("Network Error",Un.ERR_NETWORK,e,T),{cause:t.cause||t});throw Un.from(t,t&&t.code,e,T)}}},ji=new Map,Fi=e=>{let t=e&&e.env||{};const{fetch:n,Request:i,Response:r}=t,o=[i,r,n];let a,s,c=o.length,l=ji;for(;c--;)a=o[c],s=l.get(a),void 0===s&&l.set(a,s=c?new Map:Ui(t)),l=s;return s},Bi=(Fi(),{http:null,xhr:xi,fetch:{get:Fi}});An.forEach(Bi,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}});const zi=e=>`- ${e}`,qi=e=>An.isFunction(e)||null===e||!1===e,Vi=function(e,t){e=An.isArray(e)?e:[e];const{length:n}=e;let i,r;const o={};for(let a=0;a<n;a++){let n;if(i=e[a],r=i,!qi(i)&&(r=Bi[(n=String(i)).toLowerCase()],void 0===r))throw new Un(`Unknown adapter '${n}'`);if(r&&(An.isFunction(r)||(r=r.get(t))))break;o[n||"#"+a]=r}if(!r){const e=Object.entries(o).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build"));let t=n?e.length>1?"since :\n"+e.map(zi).join("\n"):" "+zi(e[0]):"as no adapter specified";throw new Un("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return r};function Hi(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new vi(null,e)}function Wi(e){return Hi(e),e.headers=pi.from(e.headers),e.data=fi.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Vi(e.adapter||ai.adapter,e)(e).then(function(t){return Hi(e),t.data=fi.call(e,e.transformResponse,t),t.headers=pi.from(t.headers),t},function(t){return mi(t)||(Hi(e),t&&t.response&&(t.response.data=fi.call(e,e.transformResponse,t.response),t.response.headers=pi.from(t.response.headers))),Promise.reject(t)})}const Ki="1.13.2",Gi={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Gi[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Ji={};Gi.transitional=function(e,t,n){function i(e,t){return"[Axios v"+Ki+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,r,o)=>{if(!1===e)throw new Un(i(r," has been removed"+(t?" in "+t:"")),Un.ERR_DEPRECATED);return t&&!Ji[r]&&(Ji[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,o)}},Gi.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};const $i={assertOptions:function(e,t,n){if("object"!=typeof e)throw new Un("options must be an object",Un.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const o=i[r],a=t[o];if(a){const t=e[o],n=void 0===t||a(t,o,e);if(!0!==n)throw new Un("option "+o+" must be "+n,Un.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new Un("Unknown option "+o,Un.ERR_BAD_OPTION)}},validators:Gi},Qi=$i.validators;class Yi{constructor(e){this.defaults=e||{},this.interceptors={request:new $n,response:new $n}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Pi(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;void 0!==n&&$i.assertOptions(n,{silentJSONParsing:Qi.transitional(Qi.boolean),forcedJSONParsing:Qi.transitional(Qi.boolean),clarifyTimeoutError:Qi.transitional(Qi.boolean)},!1),null!=i&&(An.isFunction(i)?t.paramsSerializer={serialize:i}:$i.assertOptions(i,{encode:Qi.function,serialize:Qi.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),$i.assertOptions(t,{baseUrl:Qi.spelling("baseURL"),withXsrfToken:Qi.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=r&&An.merge(r.common,r[t.method]);r&&An.forEach(["delete","get","head","post","put","patch","common"],e=>{delete r[e]}),t.headers=pi.concat(o,r);const a=[];let s=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))});const c=[];let l;this.interceptors.response.forEach(function(e){c.push(e.fulfilled,e.rejected)});let u,d=0;if(!s){const e=[Wi.bind(this),void 0];for(e.unshift(...a),e.push(...c),u=e.length,l=Promise.resolve(t);d<u;)l=l.then(e[d++],e[d++]);return l}u=a.length;let h=t;for(;d<u;){const e=a[d++],t=a[d++];try{h=e(h)}catch(e){t.call(this,e);break}}try{l=Wi.call(this,h)}catch(e){return Promise.reject(e)}for(d=0,u=c.length;d<u;)l=l.then(c[d++],c[d++]);return l}getUri(e){return Jn(Ci((e=Pi(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}An.forEach(["delete","get","head","options"],function(e){Yi.prototype[e]=function(t,n){return this.request(Pi(n||{},{method:e,url:t,data:(n||{}).data}))}}),An.forEach(["post","put","patch"],function(e){function t(t){return function(n,i,r){return this.request(Pi(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}Yi.prototype[e]=t(),Yi.prototype[e+"Form"]=t(!0)});const Xi=Yi;class Zi{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const i=new Promise(e=>{n.subscribe(e),t=e}).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e(function(e,i,r){n.reason||(n.reason=new vi(e,i,r),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new Zi(function(t){e=t});return{token:t,cancel:e}}}const er=Zi,tr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(tr).forEach(([e,t])=>{tr[t]=e});const nr=tr,ir=function e(t){const n=new Xi(t),i=Vt(Xi.prototype.request,n);return An.extend(i,Xi.prototype,n,{allOwnKeys:!0}),An.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return e(Pi(t,n))},i}(ai);ir.Axios=Xi,ir.CanceledError=vi,ir.CancelToken=er,ir.isCancel=mi,ir.VERSION=Ki,ir.toFormData=qn,ir.AxiosError=Un,ir.Cancel=ir.CanceledError,ir.all=function(e){return Promise.all(e)},ir.spread=function(e){return function(t){return e.apply(null,t)}},ir.isAxiosError=function(e){return An.isObject(e)&&!0===e.isAxiosError},ir.mergeConfig=Pi,ir.AxiosHeaders=pi,ir.formToJSON=e=>ri(An.isHTMLForm(e)?new FormData(e):e),ir.getAdapter=Vi,ir.HttpStatusCode=nr,ir.default=ir;const rr="https://api.viewpro.com",or=rr+"/api",ar=rr+"/public/avatars/",sr="Client",cr=ir.create({baseURL:or,timeout:1e4,headers:{"Content-type":"application/json"}});function lr(e){let{onJoin:t}=e;const[n,i]=(0,a.useState)([]);(0,a.useEffect)(()=>{const e=sr+"-"+Date.now().toString(),t=qt(rr,{query:{uid:e}});return t.on("connect",()=>{console.log("Connected to socket:",e),r()}),t.on("disconnect",()=>{console.log("Disconnected from socket:",e),r()}),t.on("user:logout",()=>{r()}),t.on("user:status",()=>{r()}),t.on("connect_error",e=>{console.error("Socket connection error:",e)}),()=>{t.off("connect"),t.off("disconnect"),t.off("user:logout"),t.off("user:status"),t.off("connect_error"),t.disconnect()}},[]);const r=async()=>{try{const{data:e}=await cr.get("/user/check");i(e.users)}catch(e){console.error("Failed to get user list",e),$.error("Failed to get user list")}};return n.length>0?a.createElement("div",{onClick:t,className:"vp-fixed vp-bottom-5 vp-right-5 vp-z-[9999] vp-flex vp-items-center vp-justify-center vp-cursor-pointer"},a.createElement("div",{className:"vp-w-[92px] vp-h-[92px] vp-flex vp-items-center vp-justify-center vp-rounded-full vp-bg-gradient-to-tr vp-from-yellow-400 vp-via-pink-500 vp-to-purple-500"},a.createElement("div",{className:"vp-w-[84px] vp-h-[84px] vp-flex vp-items-center vp-justify-center vp-rounded-full vp-bg-white"},a.createElement("div",{className:"vp-relative vp-w-[76px] vp-h-[76px] vp-flex vp-items-center vp-justify-center vp-rounded-full vp-bg-gray-800"},a.createElement("div",{className:"vp-wave"}),a.createElement("div",{className:"vp-wave"}),a.createElement("div",{className:"vp-wave"}),a.createElement("div",{className:"vp-wave"}),a.createElement("img",{src:ar+"volkmar.jpg",alt:"avatar",crossOrigin:"anonymous",className:"vp-w-[56px] vp-h-[56px] vp-rounded-full vp-avatar-pulse"}))),a.createElement("span",{className:"vp-absolute vp--bottom-1 vp-left-1/2 vp--translate-x-1/2 vp-rounded vp-border-2 vp-border-white vp-bg-pink-600 vp-px-2 vp-text-[10px] vp-leading-normal vp-font-bold vp-text-white"},"LIVE"))):null}function ur(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if("default"!==n&&!(n in e)){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}})}),Object.freeze(e)}cr.interceptors.request.use(async e=>e,e=>{var t;return be.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.message)||e.message||"Something went wrong"),Promise.reject(e)}),cr.interceptors.response.use(e=>{const{data:t}=e;return 200===t.code?(t.message&&"Success"!==t.message&&be.success(t.message),Promise.resolve(t)):(be.error(t.message),Promise.reject(new Error(t.message)))},async e=>{var t;return be.error((null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.message)||e.message||"Something went wrong"),Promise.reject(e)});var dr=Object.defineProperty,hr=(e,t,n)=>((e,t,n)=>t in e?dr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class pr{constructor(){hr(this,"_locking"),hr(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let e;this._locks+=1;const t=new Promise(t=>e=()=>{this._locks-=1,t()}),n=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),n}}function fr(e,t){if(!e)throw new Error(t)}function mr(e){if("number"!=typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function gr(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function vr(e){if("number"!=typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const yr=Symbol("@bufbuild/protobuf/enum-type");function br(e,t,n,i){e[yr]=kr(t,n.map(t=>({no:t.no,name:t.name,localName:e[t.no]})))}function kr(e,t,n){const i=Object.create(null),r=Object.create(null),o=[];for(const e of t){const t=wr(e);o.push(t),i[e.name]=t,r[e.no]=t}return{typeName:e,values:o,findName:e=>i[e],findNumber:e=>r[e]}}function wr(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class Sr{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType().runtime.bin,i=n.makeReadOptions(t);return n.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){const n=this.getType(),i=n.runtime.json,r=i.makeReadOptions(t);return i.readMessage(n,e,r,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(e){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(e instanceof Error?e.message:String(e)))}return this.fromJson(n,t)}toBinary(e){const t=this.getType().runtime.bin,n=t.makeWriteOptions(e),i=n.writerFactory();return t.writeMessage(this,i,n),i.finish()}toJson(e){const t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Tr(){let e=0,t=0;for(let n=0;n<28;n+=7){let i=this.buf[this.pos++];if(e|=(127&i)<<n,!(128&i))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,!(128&n))return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let i=this.buf[this.pos++];if(t|=(127&i)<<n,!(128&i))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Cr(e,t,n){for(let i=0;i<28;i+=7){const r=e>>>i,o=!(r>>>7==0&&0==t),a=255&(o?128|r:r);if(n.push(a),!o)return}const i=e>>>28&15|(7&t)<<4,r=!!(t>>3);if(n.push(255&(r?128|i:i)),r){for(let e=3;e<31;e+=7){const i=t>>>e,r=!(i>>>7==0),o=255&(r?128|i:i);if(n.push(o),!r)return}n.push(t>>>31&1)}}const Er=4294967296;function Pr(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let i=0,r=0;function o(t,o){const a=Number(e.slice(t,o));r*=n,i=i*n+a,i>=Er&&(r+=i/Er|0,i%=Er)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),t?_r(i,r):xr(i,r)}function Rr(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(Er*t+e);const n=16777215&(e>>>24|t<<8),i=t>>16&65535;let r=(16777215&e)+6777216*n+6710656*i,o=n+8147497*i,a=2*i;const s=1e7;return r>=s&&(o+=Math.floor(r/s),r%=s),o>=s&&(a+=Math.floor(o/s),o%=s),a.toString()+Or(o)+Or(r)}function xr(e,t){return{lo:0|e,hi:0|t}}function _r(e,t){return t=~t,e?e=1+~e:t+=1,xr(e,t)}const Or=e=>{const t=String(e);return"0000000".slice(t.length)+t};function Ir(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Nr(){let e=this.buf[this.pos++],t=127&e;if(!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,!(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;128&e&&t<10;t++)e=this.buf[this.pos++];if(128&e)throw new Error("invalid varint");return this.assertBounds(),t>>>0}const Ar=function(){const e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),i=BigInt("0"),r=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const i="bigint"==typeof e?e:BigInt(e);if(i>n||i<t)throw new Error("int64 invalid: ".concat(e));return i},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>r||t<i)throw new Error("uint64 invalid: ".concat(e));return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}const t=e=>fr(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e)),n=e=>fr(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e));return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),Pr(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),Pr(e)),dec:(e,t)=>function(e,t){let n=xr(e,t);const i=2147483648&n.hi;i&&(n=_r(n.lo,n.hi));const r=Rr(n.lo,n.hi);return i?"-"+r:r}(e,t),uDec:(e,t)=>Rr(e,t)}}();var Dr,Lr,Mr;function Ur(e,t,n){if(t===n)return!0;if(e==Dr.BYTES){if(!(t instanceof Uint8Array&&n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case Dr.UINT64:case Dr.FIXED64:case Dr.INT64:case Dr.SFIXED64:case Dr.SINT64:return t==n}return!1}function jr(e,t){switch(e){case Dr.BOOL:return!1;case Dr.UINT64:case Dr.FIXED64:case Dr.INT64:case Dr.SFIXED64:case Dr.SINT64:return 0==t?Ar.zero:"0";case Dr.DOUBLE:case Dr.FLOAT:return 0;case Dr.BYTES:return new Uint8Array(0);case Dr.STRING:return"";default:return 0}}function Fr(e,t){switch(e){case Dr.BOOL:return!1===t;case Dr.STRING:return""===t;case Dr.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(Dr||(Dr={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"}(Lr||(Lr={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Mr||(Mr={}));class Br{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(gr(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return mr(e),Ir(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){vr(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){gr(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){mr(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return mr(e),Ir(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=Ar.enc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=Ar.uEnc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=Ar.enc(e);return Cr(t.lo,t.hi,this.buf),this}sint64(e){let t=Ar.enc(e),n=t.hi>>31;return Cr(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=Ar.uEnc(e);return Cr(t.lo,t.hi,this.buf),this}}class zr{constructor(e,t){this.varint64=Tr,this.uint32=Nr,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case Mr.Varint:for(;128&this.buf[this.pos++];);break;case Mr.Bit64:this.pos+=4;case Mr.Bit32:this.pos+=4;break;case Mr.LengthDelimited:let n=this.uint32();this.pos+=n;break;case Mr.StartGroup:for(;;){const[e,n]=this.tag();if(n===Mr.EndGroup){if(void 0!==t&&e!==t)throw new Error("invalid end group tag");break}this.skip(n,e)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return Ar.dec(...this.varint64())}uint64(){return Ar.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,Ar.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ar.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ar.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function qr(e){const t=e.field.localName,n=Object.create(null);return n[t]=function(e){const t=e.field;if(t.repeated)return[];if(void 0!==t.default)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return jr(t.T,t.L);case"message":const e=t.T,n=new e;return e.fieldWrapper?e.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}(e),[n,()=>n[t]]}let Vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Hr=[];for(let e=0;e<Vr.length;e++)Hr[Vr[e].charCodeAt(0)]=e;Hr["-".charCodeAt(0)]=Vr.indexOf("+"),Hr["_".charCodeAt(0)]=Vr.indexOf("/");const Wr={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,i=new Uint8Array(t),r=0,o=0,a=0;for(let t=0;t<e.length;t++){if(n=Hr[e.charCodeAt(t)],void 0===n)switch(e[t]){case"=":o=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:a=n,o=1;break;case 1:i[r++]=a<<2|(48&n)>>4,a=n,o=2;break;case 2:i[r++]=(15&a)<<4|(60&n)>>2,a=n,o=3;break;case 3:i[r++]=(3&a)<<6|n,o=0}}if(1==o)throw Error("invalid base64 string.");return i.subarray(0,r)},enc(e){let t,n="",i=0,r=0;for(let o=0;o<e.length;o++)switch(t=e[o],i){case 0:n+=Vr[t>>2],r=(3&t)<<4,i=1;break;case 1:n+=Vr[r|t>>4],r=(15&t)<<2,i=2;break;case 2:n+=Vr[r|t>>6],n+=Vr[63&t],i=0}return i&&(n+=Vr[r],n+="=",1==i&&(n+="=")),n}};function Kr(e,t,n){$r(t,e);const i=t.runtime.bin.makeReadOptions(n),r=function(e,t){if(!t.repeated&&("enum"==t.kind||"scalar"==t.kind)){for(let n=e.length-1;n>=0;--n)if(e[n].no==t.no)return[e[n]];return[]}return e.filter(e=>e.no===t.no)}(e.getType().runtime.bin.listUnknownFields(e),t.field),[o,a]=qr(t);for(const e of r)t.runtime.bin.readField(o,i.readerFactory(e.data),t.field,e.wireType,i);return a()}function Gr(e,t,n,i){$r(t,e);const r=t.runtime.bin.makeReadOptions(i),o=t.runtime.bin.makeWriteOptions(i);if(Jr(e,t)){const n=e.getType().runtime.bin.listUnknownFields(e).filter(e=>e.no!=t.field.no);e.getType().runtime.bin.discardUnknownFields(e);for(const t of n)e.getType().runtime.bin.onUnknownField(e,t.no,t.wireType,t.data)}const a=o.writerFactory();let s=t.field;s.opt||s.repeated||"enum"!=s.kind&&"scalar"!=s.kind||(s=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(s,n,a,o);const c=r.readerFactory(a.finish());for(;c.pos<c.len;){const[t,n]=c.tag(),i=c.skip(n,t);e.getType().runtime.bin.onUnknownField(e,t,n,i)}}function Jr(e,t){const n=e.getType();return t.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(e).find(e=>e.no==t.field.no)}function $r(e,t){fr(e.extendee.typeName==t.getType().typeName,"extension ".concat(e.typeName," can only be applied to message ").concat(e.extendee.typeName))}function Qr(e,t){const n=e.localName;if(e.repeated)return t[n].length>0;if(e.oneof)return t[e.oneof.localName].case===n;switch(e.kind){case"enum":case"scalar":return e.opt||e.req?void 0!==t[n]:"enum"==e.kind?t[n]!==e.T.values[0].no:!Fr(e.T,t[n]);case"message":return void 0!==t[n];case"map":return Object.keys(t[n]).length>0}}function Yr(e,t){const n=e.localName,i=!e.opt&&!e.req;if(e.repeated)t[n]=[];else if(e.oneof)t[e.oneof.localName]={case:void 0};else switch(e.kind){case"map":t[n]={};break;case"enum":t[n]=i?e.T.values[0].no:void 0;break;case"scalar":t[n]=i?jr(e.T,e.L):void 0;break;case"message":t[n]=void 0}}function Xr(e,t){if(null===e||"object"!=typeof e)return!1;if(!Object.getOwnPropertyNames(Sr.prototype).every(t=>t in e&&"function"==typeof e[t]))return!1;const n=e.getType();return null!==n&&"function"==typeof n&&"typeName"in n&&"string"==typeof n.typeName&&(void 0===t||n.typeName==t.typeName)}function Zr(e,t){return Xr(t)||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}Dr.DOUBLE,Dr.FLOAT,Dr.INT64,Dr.UINT64,Dr.INT32,Dr.UINT32,Dr.BOOL,Dr.STRING,Dr.BYTES;const eo={ignoreUnknownFields:!1},to={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};const no=Symbol(),io=Symbol();function ro(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function oo(e,t,n,i,r){let o=n.localName;if(n.repeated){if(fr("map"!=n.kind),null===t)return;if(!Array.isArray(t))throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ro(t)));const a=e[o];for(const e of t){if(null===e)throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ro(e)));switch(n.kind){case"message":a.push(n.T.fromJson(e,i));break;case"enum":const t=co(n.T,e,i.ignoreUnknownFields,!0);t!==io&&a.push(t);break;case"scalar":try{a.push(so(n.T,e,n.L,!0))}catch(t){let i="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ro(e));throw t instanceof Error&&t.message.length>0&&(i+=": ".concat(t.message)),new Error(i)}}}}else if("map"==n.kind){if(null===t)return;if("object"!=typeof t||Array.isArray(t))throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ro(t)));const a=e[o];for(const[e,o]of Object.entries(t)){if(null===o)throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: map value null"));let s;try{s=ao(n.K,e)}catch(e){let i="cannot decode map key for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ro(t));throw e instanceof Error&&e.message.length>0&&(i+=": ".concat(e.message)),new Error(i)}switch(n.V.kind){case"message":a[s]=n.V.T.fromJson(o,i);break;case"enum":const e=co(n.V.T,o,i.ignoreUnknownFields,!0);e!==io&&(a[s]=e);break;case"scalar":try{a[s]=so(n.V.T,o,Lr.BIGINT,!0)}catch(e){let i="cannot decode map value for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ro(t));throw e instanceof Error&&e.message.length>0&&(i+=": ".concat(e.message)),new Error(i)}}}}else switch(n.oneof&&(e=e[n.oneof.localName]={case:o},o="value"),n.kind){case"message":const a=n.T;if(null===t&&"google.protobuf.Value"!=a.typeName)return;let s=e[o];Xr(s)?s.fromJson(t,i):(e[o]=s=a.fromJson(t,i),a.fieldWrapper&&!n.oneof&&(e[o]=a.fieldWrapper.unwrapField(s)));break;case"enum":const c=co(n.T,t,i.ignoreUnknownFields,!1);switch(c){case no:Yr(n,e);break;case io:break;default:e[o]=c}break;case"scalar":try{const i=so(n.T,t,n.L,!1);i===no?Yr(n,e):e[o]=i}catch(e){let i="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ro(t));throw e instanceof Error&&e.message.length>0&&(i+=": ".concat(e.message)),new Error(i)}}}function ao(e,t){if(e===Dr.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1}return so(e,t,Lr.BIGINT,!0).toString()}function so(e,t,n,i){if(null===t)return i?jr(e,n):no;switch(e){case Dr.DOUBLE:case Dr.FLOAT:if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const i=Number(t);if(Number.isNaN(i))break;if(!Number.isFinite(i))break;return e==Dr.FLOAT&&vr(i),i;case Dr.INT32:case Dr.FIXED32:case Dr.SFIXED32:case Dr.SINT32:case Dr.UINT32:let r;if("number"==typeof t?r=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(r=Number(t)),void 0===r)break;return e==Dr.UINT32||e==Dr.FIXED32?gr(r):mr(r),r;case Dr.INT64:case Dr.SFIXED64:case Dr.SINT64:if("number"!=typeof t&&"string"!=typeof t)break;const o=Ar.parse(t);return n?o.toString():o;case Dr.FIXED64:case Dr.UINT64:if("number"!=typeof t&&"string"!=typeof t)break;const a=Ar.uParse(t);return n?a.toString():a;case Dr.BOOL:if("boolean"!=typeof t)break;return t;case Dr.STRING:if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw new Error("invalid UTF8")}return t;case Dr.BYTES:if(""===t)return new Uint8Array(0);if("string"!=typeof t)break;return Wr.dec(t)}throw new Error}function co(e,t,n,i){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:i?e.values[0].no:no;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const i=e.findName(t);if(void 0!==i)return i.no;if(n)return io}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(ro(t)))}function lo(e){return!(!e.repeated&&"map"!=e.kind&&(e.oneof||"message"==e.kind||e.opt||e.req))}function uo(e,t,n){if("map"==e.kind){fr("object"==typeof t&&null!=t);const i={},r=Object.entries(t);switch(e.V.kind){case"scalar":for(const[t,n]of r)i[t.toString()]=po(e.V.T,n);break;case"message":for(const[e,t]of r)i[e.toString()]=t.toJson(n);break;case"enum":const t=e.V.T;for(const[e,o]of r)i[e.toString()]=ho(t,o,n.enumAsInteger)}return n.emitDefaultValues||r.length>0?i:void 0}if(e.repeated){fr(Array.isArray(t));const i=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++)i.push(po(e.T,t[n]));break;case"enum":for(let r=0;r<t.length;r++)i.push(ho(e.T,t[r],n.enumAsInteger));break;case"message":for(let e=0;e<t.length;e++)i.push(t[e].toJson(n))}return n.emitDefaultValues||i.length>0?i:void 0}switch(e.kind){case"scalar":return po(e.T,t);case"enum":return ho(e.T,t,n.enumAsInteger);case"message":return Zr(e.T,t).toJson(n)}}function ho(e,t,n){var i;if(fr("number"==typeof t),"google.protobuf.NullValue"==e.typeName)return null;if(n)return t;const r=e.findNumber(t);return null!==(i=null==r?void 0:r.name)&&void 0!==i?i:t}function po(e,t){switch(e){case Dr.INT32:case Dr.SFIXED32:case Dr.SINT32:case Dr.FIXED32:case Dr.UINT32:return fr("number"==typeof t),t;case Dr.FLOAT:case Dr.DOUBLE:return fr("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t;case Dr.STRING:return fr("string"==typeof t),t;case Dr.BOOL:return fr("boolean"==typeof t),t;case Dr.UINT64:case Dr.FIXED64:case Dr.INT64:case Dr.SFIXED64:case Dr.SINT64:return fr("bigint"==typeof t||"string"==typeof t||"number"==typeof t),t.toString();case Dr.BYTES:return fr(t instanceof Uint8Array),Wr.enc(t)}}const fo=Symbol("@bufbuild/protobuf/unknown-fields"),mo={readUnknownFields:!0,readerFactory:e=>new zr(e)},go={writeUnknownFields:!0,writerFactory:()=>new Br};function vo(e,t,n,i,r){let{repeated:o,localName:a}=n;switch(n.oneof&&((e=e[n.oneof.localName]).case!=a&&delete e.value,e.case=a,a="value"),n.kind){case"scalar":case"enum":const s="enum"==n.kind?Dr.INT32:n.T;let c=ko;if("scalar"==n.kind&&n.L>0&&(c=bo),o){let n=e[a];if(i==Mr.LengthDelimited&&s!=Dr.STRING&&s!=Dr.BYTES){let e=t.uint32()+t.pos;for(;t.pos<e;)n.push(c(t,s))}else n.push(c(t,s))}else e[a]=c(t,s);break;case"message":const l=n.T;o?e[a].push(yo(t,new l,r,n)):Xr(e[a])?yo(t,e[a],r,n):(e[a]=yo(t,new l,r,n),!l.fieldWrapper||n.oneof||n.repeated||(e[a]=l.fieldWrapper.unwrapField(e[a])));break;case"map":let[u,d]=function(e,t,n){const i=t.uint32(),r=t.pos+i;let o,a;for(;t.pos<r;){const[i]=t.tag();switch(i){case 1:o=ko(t,e.K);break;case 2:switch(e.V.kind){case"scalar":a=ko(t,e.V.T);break;case"enum":a=t.int32();break;case"message":a=yo(t,new e.V.T,n,void 0)}}}if(void 0===o&&(o=jr(e.K,Lr.BIGINT)),"string"!=typeof o&&"number"!=typeof o&&(o=o.toString()),void 0===a)switch(e.V.kind){case"scalar":a=jr(e.V.T,Lr.BIGINT);break;case"enum":a=e.V.T.values[0].no;break;case"message":a=new e.V.T}return[o,a]}(n,t,r);e[a][u]=d}}function yo(e,t,n,i){const r=t.getType().runtime.bin,o=null==i?void 0:i.delimited;return r.readMessage(t,e,o?i.no:e.uint32(),n,o),t}function bo(e,t){const n=ko(e,t);return"bigint"==typeof n?n.toString():n}function ko(e,t){switch(t){case Dr.STRING:return e.string();case Dr.BOOL:return e.bool();case Dr.DOUBLE:return e.double();case Dr.FLOAT:return e.float();case Dr.INT32:return e.int32();case Dr.INT64:return e.int64();case Dr.UINT64:return e.uint64();case Dr.FIXED64:return e.fixed64();case Dr.BYTES:return e.bytes();case Dr.FIXED32:return e.fixed32();case Dr.SFIXED32:return e.sfixed32();case Dr.SFIXED64:return e.sfixed64();case Dr.SINT64:return e.sint64();case Dr.UINT32:return e.uint32();case Dr.SINT32:return e.sint32()}}function wo(e,t,n,i){fr(void 0!==t);const r=e.repeated;switch(e.kind){case"scalar":case"enum":let o="enum"==e.kind?Dr.INT32:e.T;if(r)if(fr(Array.isArray(t)),e.packed)!function(e,t,n,i){if(!i.length)return;e.tag(n,Mr.LengthDelimited).fork();let[,r]=Eo(t);for(let t=0;t<i.length;t++)e[r](i[t]);e.join()}(n,o,e.no,t);else for(const i of t)Co(n,o,e.no,i);else Co(n,o,e.no,t);break;case"message":if(r){fr(Array.isArray(t));for(const r of t)To(n,i,e,r)}else To(n,i,e,t);break;case"map":fr("object"==typeof t&&null!=t);for(const[r,o]of Object.entries(t))So(n,i,e,r,o)}}function So(e,t,n,i,r){e.tag(n.no,Mr.LengthDelimited),e.fork();let o=i;switch(n.K){case Dr.INT32:case Dr.FIXED32:case Dr.UINT32:case Dr.SFIXED32:case Dr.SINT32:o=Number.parseInt(i);break;case Dr.BOOL:fr("true"==i||"false"==i),o="true"==i}switch(Co(e,n.K,1,o),n.V.kind){case"scalar":Co(e,n.V.T,2,r);break;case"enum":Co(e,Dr.INT32,2,r);break;case"message":fr(void 0!==r),e.tag(2,Mr.LengthDelimited).bytes(r.toBinary(t))}e.join()}function To(e,t,n,i){const r=Zr(n.T,i);n.delimited?e.tag(n.no,Mr.StartGroup).raw(r.toBinary(t)).tag(n.no,Mr.EndGroup):e.tag(n.no,Mr.LengthDelimited).bytes(r.toBinary(t))}function Co(e,t,n,i){fr(void 0!==i);let[r,o]=Eo(t);e.tag(n,r)[o](i)}function Eo(e){let t=Mr.Varint;switch(e){case Dr.BYTES:case Dr.STRING:t=Mr.LengthDelimited;break;case Dr.DOUBLE:case Dr.FIXED64:case Dr.SFIXED64:t=Mr.Bit64;break;case Dr.FIXED32:case Dr.SFIXED32:case Dr.FLOAT:t=Mr.Bit32}return[t,Dr[e].toLowerCase()]}function Po(e){if(void 0===e)return e;if(Xr(e))return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function Ro(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class xo{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function _o(e,t){const n=Io(e);return t?n:Mo(Lo(n))}const Oo=Io;function Io(e){let t=!1;const n=[];for(let i=0;i<e.length;i++){let r=e.charAt(i);switch(r){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),t=!1;break;default:t&&(t=!1,r=r.toUpperCase()),n.push(r)}}return n.join("")}const No=new Set(["constructor","toString","toJSON","valueOf"]),Ao=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Do=e=>"".concat(e,"$"),Lo=e=>Ao.has(e)?Do(e):e,Mo=e=>No.has(e)?Do(e):e;class Uo{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=_o(e,!1)}addField(e){fr(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const jo=(Fo=e=>new xo(e,e=>function(e){var t,n,i,r,o,a;const s=[];let c;for(const l of"function"==typeof e?e():e){const e=l;if(e.localName=_o(l.name,void 0!==l.oneof),e.jsonName=null!==(t=l.jsonName)&&void 0!==t?t:Oo(l.name),e.repeated=null!==(n=l.repeated)&&void 0!==n&&n,"scalar"==l.kind&&(e.L=null!==(i=l.L)&&void 0!==i?i:Lr.BIGINT),e.delimited=null!==(r=l.delimited)&&void 0!==r&&r,e.req=null!==(o=l.req)&&void 0!==o&&o,e.opt=null!==(a=l.opt)&&void 0!==a&&a,void 0===l.packed&&(e.packed="enum"==l.kind||"scalar"==l.kind&&l.T!=Dr.BYTES&&l.T!=Dr.STRING),void 0!==l.oneof){const t="string"==typeof l.oneof?l.oneof:l.oneof.name;c&&c.name==t||(c=new Uo(t)),e.oneof=c,c.addField(e)}s.push(e)}return s}(e)),Bo=e=>{for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,i=e;if(t.repeated)i[n]=[];else switch(t.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=jr(t.T,t.L)}}},{syntax:"proto3",json:{makeReadOptions:function(e){return e?Object.assign(Object.assign({},eo),e):eo},makeWriteOptions:function(e){return e?Object.assign(Object.assign({},to),e):to},readMessage(e,t,n,i){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(ro(t)));i=null!=i?i:new e;const r=new Map,o=n.typeRegistry;for(const[a,s]of Object.entries(t)){const t=e.fields.findJsonName(a);if(t){if(t.oneof){if(null===s&&"scalar"==t.kind)continue;const n=r.get(t.oneof);if(void 0!==n)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(t.oneof.name,'" present: "').concat(n,'", "').concat(a,'"'));r.set(t.oneof,a)}oo(i,s,t,n,e)}else{let t=!1;if((null==o?void 0:o.findExtension)&&a.startsWith("[")&&a.endsWith("]")){const r=o.findExtension(a.substring(1,a.length-1));if(r&&r.extendee.typeName==e.typeName){t=!0;const[e,o]=qr(r);oo(e,s,r.field,n,r),Gr(i,r,o(),n)}}if(!t&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(a,'" is unknown'))}}return i},writeMessage(e,t){const n=e.getType(),i={};let r;try{for(r of n.fields.byNumber()){if(!Qr(r,e)){if(r.req)throw"required field not set";if(!t.emitDefaultValues)continue;if(!lo(r))continue}const n=uo(r,r.oneof?e[r.oneof.localName].value:e[r.localName],t);void 0!==n&&(i[t.useProtoFieldName?r.name:r.jsonName]=n)}const o=t.typeRegistry;if(null==o?void 0:o.findExtensionFor)for(const r of n.runtime.bin.listUnknownFields(e)){const a=o.findExtensionFor(n.typeName,r.no);if(a&&Jr(e,a)){const n=Kr(e,a,t),r=uo(a.field,n,t);void 0!==r&&(i[a.field.jsonName]=r)}}}catch(e){const t=r?"cannot encode field ".concat(n.typeName,".").concat(r.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),i=e instanceof Error?e.message:String(e);throw new Error(t+(i.length>0?": ".concat(i):""))}return i},readScalar:(e,t,n)=>so(e,t,null!=n?n:Lr.BIGINT,!0),writeScalar(e,t,n){if(void 0!==t)return n||Fr(e,t)?po(e,t):void 0},debug:ro},bin:{makeReadOptions:function(e){return e?Object.assign(Object.assign({},mo),e):mo},makeWriteOptions:function(e){return e?Object.assign(Object.assign({},go),e):go},listUnknownFields(e){var t;return null!==(t=e[fo])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[fo]},writeUnknownFields(e,t){const n=e[fo];if(n)for(const e of n)t.tag(e.no,e.wireType).raw(e.data)},onUnknownField(e,t,n,i){const r=e;Array.isArray(r[fo])||(r[fo]=[]),r[fo].push({no:t,wireType:n,data:i})},readMessage(e,t,n,i,r){const o=e.getType(),a=r?t.len:t.pos+n;let s,c;for(;t.pos<a&&([s,c]=t.tag(),!0!==r||c!=Mr.EndGroup);){const n=o.fields.find(s);if(!n){const n=t.skip(c,s);i.readUnknownFields&&this.onUnknownField(e,s,c,n);continue}vo(e,t,n,c,i)}if(r&&(c!=Mr.EndGroup||s!==n))throw new Error("invalid end group tag")},readField:vo,writeMessage(e,t,n){const i=e.getType();for(const r of i.fields.byNumber())if(Qr(r,e))wo(r,r.oneof?e[r.oneof.localName].value:e[r.localName],t,n);else if(r.req)throw new Error("cannot encode field ".concat(i.typeName,".").concat(r.name," to binary: required field not set"));return n.writeUnknownFields&&this.writeUnknownFields(e,t),t},writeField(e,t,n,i){void 0!==t&&wo(e,t,n,i)}},util:Object.assign(Object.assign({},{setEnumType:br,initPartial(e,t){if(void 0===e)return;const n=t.getType();for(const i of n.fields.byMember()){const n=i.localName,r=t,o=e;if(null!=o[n])switch(i.kind){case"oneof":const e=o[n].case;if(void 0===e)continue;const t=i.findField(e);let a=o[n].value;t&&"message"==t.kind&&!Xr(a,t.T)?a=new t.T(a):t&&"scalar"===t.kind&&t.T===Dr.BYTES&&(a=Ro(a)),r[n]={case:e,value:a};break;case"scalar":case"enum":let s=o[n];i.T===Dr.BYTES&&(s=i.repeated?s.map(Ro):Ro(s)),r[n]=s;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===Dr.BYTES)for(const[e,t]of Object.entries(o[n]))r[n][e]=Ro(t);else Object.assign(r[n],o[n]);break;case"message":const e=i.V.T;for(const t of Object.keys(o[n])){let i=o[n][t];e.fieldWrapper||(i=new e(i)),r[n][t]=i}}break;case"message":const c=i.T;if(i.repeated)r[n]=o[n].map(e=>Xr(e,c)?e:new c(e));else{const e=o[n];c.fieldWrapper?"google.protobuf.BytesValue"===c.typeName?r[n]=Ro(e):r[n]=e:r[n]=Xr(e,c)?e:new c(e)}}}},equals:(e,t,n)=>t===n||!(!t||!n)&&e.fields.byMember().every(e=>{const i=t[e.localName],r=n[e.localName];if(e.repeated){if(i.length!==r.length)return!1;switch(e.kind){case"message":return i.every((t,n)=>e.T.equals(t,r[n]));case"scalar":return i.every((t,n)=>Ur(e.T,t,r[n]));case"enum":return i.every((e,t)=>Ur(Dr.INT32,e,r[t]))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":let t=i,n=r;return e.T.fieldWrapper&&(void 0===t||Xr(t)||(t=e.T.fieldWrapper.wrapField(t)),void 0===n||Xr(n)||(n=e.T.fieldWrapper.wrapField(n))),e.T.equals(t,n);case"enum":return Ur(Dr.INT32,i,r);case"scalar":return Ur(e.T,i,r);case"oneof":if(i.case!==r.case)return!1;const o=e.findField(i.case);if(void 0===o)return!0;switch(o.kind){case"message":return o.T.equals(i.value,r.value);case"enum":return Ur(Dr.INT32,i.value,r.value);case"scalar":return Ur(o.T,i.value,r.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const a=Object.keys(i).concat(Object.keys(r));switch(e.V.kind){case"message":const t=e.V.T;return a.every(e=>t.equals(i[e],r[e]));case"enum":return a.every(e=>Ur(Dr.INT32,i[e],r[e]));case"scalar":const n=e.V.T;return a.every(e=>Ur(n,i[e],r[e]))}}}),clone(e){const t=e.getType(),n=new t,i=n;for(const n of t.fields.byMember()){const t=e[n.localName];let r;if(n.repeated)r=t.map(Po);else if("map"==n.kind){r=i[n.localName];for(const[e,n]of Object.entries(t))r[e]=Po(n)}else r="oneof"==n.kind?n.findField(t.case)?{case:t.case,value:Po(t.value)}:{case:void 0}:Po(t);i[n.localName]=r}for(const n of t.runtime.bin.listUnknownFields(e))t.runtime.bin.onUnknownField(i,n.no,n.wireType,n.data);return n}}),{newFieldList:Fo,initFields:Bo}),makeMessageType(e,t,n){return function(e,t,n,i){var r;const o=null!==(r=null==i?void 0:i.localName)&&void 0!==r?r:t.substring(t.lastIndexOf(".")+1),a={[o]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[o];return Object.setPrototypeOf(a.prototype,new Sr),Object.assign(a,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>(new a).fromBinary(e,t),fromJson:(e,t)=>(new a).fromJson(e,t),fromJsonString:(e,t)=>(new a).fromJsonString(e,t),equals:(t,n)=>e.util.equals(a,t,n)}),a}(this,e,t,n)},makeEnum:function(e,t,n){const i={};for(const e of t){const t=wr(e);i[t.localName]=t.no,i[t.no]=t.localName}return br(i,e,t),i},makeEnumType:kr,getEnumType:function(e){const t=e[yr];return fr(t,"missing enum type on enum object"),t},makeExtension(e,t,n){return function(e,t,n,i){let r;return{typeName:t,extendee:n,get field(){if(!r){const n="function"==typeof i?i():i;n.name=t.split(".").pop(),n.jsonName="[".concat(t,"]"),r=e.util.newFieldList([n]).list()[0]}return r},runtime:e}}(this,e,t,n)}});var Fo,Bo;class zo extends Sr{constructor(e){super(),this.seconds=Ar.zero,this.nanos=0,jo.util.initPartial(e,this)}fromJson(e,t){if("string"!=typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(jo.json.debug(e)));const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ar.parse(i/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);n="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return zo.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new zo({seconds:Ar.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new zo).fromBinary(e,t)}static fromJson(e,t){return(new zo).fromJson(e,t)}static fromJsonString(e,t){return(new zo).fromJsonString(e,t)}static equals(e,t){return jo.util.equals(zo,e,t)}}zo.runtime=jo,zo.typeName="google.protobuf.Timestamp",zo.fields=jo.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const qo=jo.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:zo},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:Vo,repeated:!0},{no:5,name:"events",kind:"message",T:Wo,repeated:!0}]),Vo=jo.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:Ho,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),Ho=jo.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:zo},{no:3,name:"value",kind:"scalar",T:2}]),Wo=jo.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:zo},{no:7,name:"normalized_end_timestamp",kind:"message",T:zo,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),Ko=jo.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),Go=jo.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),Jo=jo.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),$o=jo.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Qo=jo.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Yo=jo.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Xo=jo.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),Zo=jo.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),ea=jo.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),ta=jo.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),na=jo.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:ia,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:Ua}]),ia=jo.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),ra=jo.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:jo.getEnumType(Jo),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),oa=jo.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:jo.getEnumType(aa)},{no:4,name:"tracks",kind:"message",T:da,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:ra},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:jo.getEnumType(sa)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:jo.getEnumType(Xo)},{no:18,name:"kind_details",kind:"enum",T:jo.getEnumType(ca),repeated:!0}]),aa=jo.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),sa=jo.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),ca=jo.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),la=jo.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),ua=jo.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ha,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:jo.getEnumType(pa)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),da=jo.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:jo.getEnumType(Go)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:jo.getEnumType(Jo)},{no:10,name:"layers",kind:"message",T:ha,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:ua,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:jo.getEnumType(la)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:Ua},{no:19,name:"audio_features",kind:"enum",T:jo.getEnumType(ta),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:jo.getEnumType(Ko)}]),ha=jo.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:jo.getEnumType($o)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),pa=jo.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),fa=jo.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:jo.getEnumType(ma)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:ka,oneof:"value"},{no:3,name:"speaker",kind:"message",T:ya,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:wa,oneof:"value"},{no:7,name:"transcription",kind:"message",T:Sa,oneof:"value"},{no:8,name:"metrics",kind:"message",T:qo,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Ca,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:Ea,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:Pa,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:Ra,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:za,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:qa,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:Va,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:ga,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),ma=jo.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),ga=jo.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:jo.getEnumType(la)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),va=jo.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:ka,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:Ca,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:Ea,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:Pa,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:Ra,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:za,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:qa,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:Va,oneof:"value"}]),ya=jo.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:ba,repeated:!0}]),ba=jo.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),ka=jo.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),wa=jo.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),Sa=jo.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:Ta,repeated:!0}]),Ta=jo.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Ca=jo.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),Ea=jo.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),Pa=jo.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),Ra=jo.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:xa,oneof:"value"}]),xa=jo.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),_a=jo.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),Oa=jo.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:jo.getEnumType(Ia)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),Ia=jo.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),Na=jo.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:jo.getEnumType(Aa)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),Aa=jo.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),Da=jo.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:La},{no:2,name:"screen",kind:"message",T:La},{no:3,name:"resume_connection",kind:"enum",T:jo.getEnumType(Yo)},{no:4,name:"disabled_codecs",kind:"message",T:Ma},{no:5,name:"force_relay",kind:"enum",T:jo.getEnumType(Yo)}]),La=jo.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:jo.getEnumType(Yo)}]),Ma=jo.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:ia,repeated:!0},{no:2,name:"publish",kind:"message",T:ia,repeated:!0}]),Ua=jo.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),ja=jo.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),Fa=jo.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:jo.getEnumType(ja)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),Ba=jo.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),za=jo.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:jo.getEnumType(la)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:Fa,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:Ba,oneof:"content_header"}],{localName:"DataStream_Header"}),qa=jo.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),Va=jo.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),Ha=jo.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),Wa=jo.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),Ka=jo.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),Ga=jo.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),Ja=jo.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:rs,oneof:"message"},{no:2,name:"answer",kind:"message",T:rs,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Xa,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Ya,oneof:"message"},{no:5,name:"mute",kind:"message",T:Za,oneof:"message"},{no:6,name:"subscription",kind:"message",T:as,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:ss,oneof:"message"},{no:8,name:"leave",kind:"message",T:us,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:hs,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Ps,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:_s,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Ns,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:ps,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:As,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:cs,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:ls,oneof:"message"}]),$a=jo.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:es,oneof:"message"},{no:2,name:"answer",kind:"message",T:rs,oneof:"message"},{no:3,name:"offer",kind:"message",T:rs,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Xa,oneof:"message"},{no:5,name:"update",kind:"message",T:os,oneof:"message"},{no:6,name:"track_published",kind:"message",T:ns,oneof:"message"},{no:8,name:"leave",kind:"message",T:us,oneof:"message"},{no:9,name:"mute",kind:"message",T:Za,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:ms,oneof:"message"},{no:11,name:"room_update",kind:"message",T:gs,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:ys,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:ks,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Ts,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Rs,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:is,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:ts,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Ds,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Us,oneof:"message"},{no:22,name:"request_response",kind:"message",T:js,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:Bs,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:xs,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:Ws,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:Cs,oneof:"message"}]),Qa=jo.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ha,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:jo.getEnumType(pa)}]),Ya=jo.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:jo.getEnumType(Go)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:jo.getEnumType(Jo)},{no:9,name:"layers",kind:"message",T:ha,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Qa,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:jo.getEnumType(la)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:jo.getEnumType(Ko)},{no:17,name:"audio_features",kind:"enum",T:jo.getEnumType(ta),repeated:!0}]),Xa=jo.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:jo.getEnumType(Wa)},{no:3,name:"final",kind:"scalar",T:8}]),Za=jo.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),es=jo.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:na},{no:2,name:"participant",kind:"message",T:oa},{no:3,name:"other_participants",kind:"message",T:oa,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:fs,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Da},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Oa},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:ia,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),ts=jo.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:fs,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Da},{no:3,name:"server_info",kind:"message",T:Oa},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),ns=jo.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:da}]),is=jo.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),rs=jo.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),os=jo.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:oa,repeated:!0}]),as=jo.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:_a,repeated:!0}]),ss=jo.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:jo.getEnumType($o)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),cs=jo.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:jo.getEnumType(ta),repeated:!0}]),ls=jo.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),us=jo.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:jo.getEnumType(Xo)},{no:3,name:"action",kind:"enum",T:jo.getEnumType(ds)},{no:4,name:"regions",kind:"message",T:Ls}]),ds=jo.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),hs=jo.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:ha,repeated:!0}]),ps=jo.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),fs=jo.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),ms=jo.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:ba,repeated:!0}]),gs=jo.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:na}]),vs=jo.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:jo.getEnumType(Qo)},{no:3,name:"score",kind:"scalar",T:2}]),ys=jo.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:vs,repeated:!0}]),bs=jo.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:jo.getEnumType(Ka)}]),ks=jo.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:bs,repeated:!0}]),ws=jo.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:jo.getEnumType($o)},{no:2,name:"enabled",kind:"scalar",T:8}]),Ss=jo.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:ws,repeated:!0}]),Ts=jo.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:ws,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:Ss,repeated:!0}]),Cs=jo.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:Ha,repeated:!0}]),Es=jo.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),Ps=jo.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Es,repeated:!0}]),Rs=jo.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),xs=jo.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:na},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:oa},{no:4,name:"other_participants",kind:"message",T:oa,repeated:!0}]),_s=jo.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:rs},{no:2,name:"subscription",kind:"message",T:as},{no:3,name:"publish_tracks",kind:"message",T:ns,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Is,repeated:!0},{no:5,name:"offer",kind:"message",T:rs},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:Os,repeated:!0}]),Os=jo.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),Is=jo.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:jo.getEnumType(Wa)}]),Ns=jo.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:jo.getEnumType(Ga),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),As=jo.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),Ds=jo.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),Ls=jo.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:Ms,repeated:!0}]),Ms=jo.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),Us=jo.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:jo.getEnumType(ea)}]),js=jo.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:jo.getEnumType(Fs)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:Xa,oneof:"request"},{no:5,name:"add_track",kind:"message",T:Ya,oneof:"request"},{no:6,name:"mute",kind:"message",T:Za,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:ps,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:cs,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:ls,oneof:"request"}]),Fs=jo.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),Bs=jo.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),zs=jo.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),qs=jo.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:Na},{no:2,name:"connection_settings",kind:"message",T:zs},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:Ya,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:rs},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:jo.getEnumType(Zo)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:_s}]),Vs=jo.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:jo.getEnumType(Hs)},{no:2,name:"join_request",kind:"scalar",T:12}]),Hs=jo.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),Ws=jo.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function Ks(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Gs,Js,$s,Qs={exports:{}},Ys=Qs.exports,Xs=(Gs||(Gs=1,function(e){var t,n;t=Ys,n=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],r={},o=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(){for(var n=this.getLevel(),r=0;r<i.length;r++){var o=i[r];this[o]=r<n?e:this.methodFactory(o,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function l(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function u(i,r,o){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?s:void 0!==console[i]?a(console,i):void 0!==console.log?a(console,"log"):e)}(i)||l.apply(this,arguments)}function d(e,n){var a,s,l,d=this,h="loglevel";function p(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(h),r=n.indexOf(i+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+i.length+1))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}}function f(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?h+=":"+e:"symbol"==typeof e&&(h=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){return null!=l?l:null!=s?s:a},d.setLevel=function(e,n){return l=f(e),!1!==n&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{return void(window.localStorage[h]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch(e){}}}(l),c.call(d)},d.setDefaultLevel=function(e){s=f(e),p()||d.setLevel(e,!1)},d.resetLevel=function(){l=null,function(){if(typeof window!==t&&h){try{window.localStorage.removeItem(h)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(o!==d&&(a=f(o.getLevel())),c.call(d),o===d)for(var e in r)r[e].rebuild()},a=f(o?o.getLevel():"WARN");var m=p();null!=m&&(l=f(m)),c.call(d)}(o=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=r[e];return t||(t=r[e]=new d(e,o.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=h),o},o.getLoggers=function(){return r},o.default=o,o},e.exports?e.exports=n():t.log=n()}(Qs)),Qs.exports);!function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"}(Js||(Js={})),function(e){e.Default="livekit",e.Room="livekit-room",e.TokenSource="livekit-token-source",e.Participant="livekit-participant",e.Track="livekit-track",e.Publication="livekit-track-publication",e.Engine="livekit-engine",e.Signal="livekit-signal",e.PCManager="livekit-pc-manager",e.PCTransport="livekit-pc-transport",e.E2EE="lk-e2ee"}($s||($s={}));let Zs=Xs.getLogger("livekit");function ec(e){const t=Xs.getLogger(e);return t.setDefaultLevel(Zs.getLevel()),t}Object.values($s).map(e=>Xs.getLogger(e)),Zs.setDefaultLevel(Js.info);const tc=Xs.getLogger("lk-e2ee"),nc=7e3,ic=[0,300,1200,2700,4800,nc,nc,nc,nc,nc];function rc(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,s)}c((i=i.apply(e,t||[])).next())})}function oc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,r){!function(e,t,n,i){Promise.resolve(i).then(function(t){e({value:t,done:n})},t)}(i,r,(t=e[n](t)).done,t.value)})}}}"function"==typeof SuppressedError&&SuppressedError;var ac,sc={exports:{}},cc=function(){if(ac)return sc.exports;ac=1;var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function r(){r.init.call(this)}sc.exports=r,sc.exports.once=function(e,t){return new Promise(function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}f(e,t,o,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&f(e,"error",t,{once:!0})}(e,r)})},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,o,c,l;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),c=o[t]),void 0===c)c=o[t]=n,++e._eventsCount;else if("function"==typeof c?c=o[t]=i?[n,c]:[c,n]:i?c.unshift(n):c.push(n),(r=s(e))>0&&c.length>r&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=c.length,l=u,console&&console.warn&&console.warn(l)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=l.bind(i);return r.listener=n,i.wrapFn=r,r}function d(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function f(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function r(o){i.once&&e.removeEventListener(t,r),n(o)})}}return Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return s(this)},r.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var l=c.length,u=p(c,l);for(i=0;i<l;++i)n(u[i],this,t)}return!0},r.prototype.addListener=function(e,t){return c(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return c(this,e,t,!0)},r.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,i,r,o,s;if(a(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},r.prototype.listeners=function(e){return d(this,e,!0)},r.prototype.rawListeners=function(e){return d(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},r.prototype.listenerCount=h,r.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},sc.exports}();let lc=!0,uc=!0;function dc(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseFloat(i[n],10)}function hc(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);const o=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,o),r.apply(this,[e,o])};const o=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function pc(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(lc=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function fc(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(uc=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function mc(){if("object"==typeof window){if(lc)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function gc(e,t){uc&&console.warn(e+" is deprecated, please use "+t+" instead.")}function vc(e){return"[object Object]"===Object.prototype.toString.call(e)}function yc(e){return vc(e)?Object.keys(e).reduce(function(t,n){const i=vc(e[n]),r=i?yc(e[n]):e[n],o=i&&!Object.keys(r).length;return void 0===r||o?t:Object.assign(t,{[n]:r})},{}):e}function bc(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(i=>{i.endsWith("Id")?bc(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach(t=>{bc(e,e.get(t),n)})}))}function kc(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const o=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(t=>{e.forEach(n=>{n.type===i&&n.trackId===t.id&&bc(e,n,r)})}),r}const wc=mc;function Sc(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"==typeof i.ideal?(e[r("min",n)]=i.ideal,t.optional.push(e),e={},e[r("max",n)]=i.ideal,t.optional.push(e)):(e[r("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach(e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const a=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||a)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then(n=>{n=n.filter(e=>"videoinput"===e.kind);let a=n.find(e=>t.some(t=>e.label.toLowerCase().includes(t)));return!a&&n.length&&t.includes("back")&&(a=n[n.length-1]),a&&(e.video.deviceId=o.exact?{exact:a.deviceId}:{ideal:a.deviceId}),e.video=i(e.video),wc("chrome: "+JSON.stringify(e)),r(e)})}e.video=i(e.video)}return wc("chrome: "+JSON.stringify(e)),r(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){r(e,e=>{n.webkitGetUserMedia(e,t,e=>{i&&i(o(e))})})}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return r(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(o(e))))}}}function Tc(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Cc(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const r=new Event("track");r.track=n.track,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)}),t.stream.getTracks().forEach(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else hc(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Ec(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Pc(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>kc(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),hc(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>kc(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach(n=>{n.track===e&&(t?i=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?i=!0:n=t),t.track===e)),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Rc(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),r.apply(this,arguments)}}function xc(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Rc(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(e=>e.track===t))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const r=this._streams[n.id];if(r)r.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>o(this,e))}};e.RTCPeerConnection.prototype[t]=i[t]});const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function _c(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]})}function Oc(e,t){hc(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}var Ic=Object.freeze({__proto__:null,fixNegotiationNeeded:Oc,shimAddTrackRemoveTrack:xc,shimAddTrackRemoveTrackWithNative:Rc,shimGetSendersWithDtmf:Ec,shimGetUserMedia:Sc,shimMediaStream:Tc,shimOnTrack:Cc,shimPeerConnection:_c,shimSenderReceiverGetStats:Pc});function Nc(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){gc("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function Ac(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Dc(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,o]=arguments;return i.apply(this,[e||null]).then(e=>{if(t.version<53&&!r)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(r,o)}}function Lc(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Mc(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),hc(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Uc(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){gc("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function jc(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Fc(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach(e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return i})}function Bc(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function zc(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function qc(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var Vc=Object.freeze({__proto__:null,shimAddTransceiver:Fc,shimCreateAnswer:qc,shimCreateOffer:zc,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:Bc,shimGetUserMedia:Nc,shimOnTrack:Ac,shimPeerConnection:Dc,shimRTCDataChannel:jc,shimReceiverGetStats:Mc,shimRemoveStream:Uc,shimSenderGetStats:Lc});function Hc(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i&&i.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function Wc(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function Kc(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};let s=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=s,s=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=s,s=function(e,t,n){const i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=s}function Gc(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(Jc(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function Jc(e){return e&&void 0!==e.video?Object.assign({},e,{video:yc(e.video)}):e}function $c(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?(gc("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Qc(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Yc(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Xc(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Zc,el=Object.freeze({__proto__:null,shimAudioContext:Xc,shimCallbacksAPI:Kc,shimConstraints:Jc,shimCreateOfferLegacy:Yc,shimGetUserMedia:Gc,shimLocalStreamsAPI:Hc,shimRTCIceServerUrls:$c,shimRemoteStreamsAPI:Wc,shimTrackEventTransceiver:Qc}),tl={exports:{}},nl=(Zc||(Zc=1,function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(e=>e.trim())},t.splitSections=function(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+"\r\n")},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter(e=>0===e.indexOf(n))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":n.relatedAddress=t[e+1];break;case"rport":n.relatedPort=parseInt(t[e+1],10);break;case"tcptype":n.tcpType=t[e+1];break;case"ufrag":n.ufrag=t[e+1],n.usernameFragment=t[e+1];break;default:void 0===n[t[e]]&&(n[t[e]]=t[e+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let e=0;e<i.length;e++)n=i[e].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach(t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)}),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(e=>parseInt(e,10))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],r=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&r?{usernameFragment:i.substring(12),password:r.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let r=3;r<i.length;r++){const o=i[r],a=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){const i=t.parseRtpMap(a),r=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(i.parameters=r.length?t.parseFmtp(r[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach(e=>{n.headerExtensions.push(t.parseExtmap(e))});const r=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach(e=>{r.forEach(t=>{e.rtcpFeedback.find(e=>e.type===t.type&&e.parameter===t.parameter)||e.rtcpFeedback.push(t)})}),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map(e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach(e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)});let r=0;return n.codecs.forEach(e=>{e.maxptime>r&&(r=e.maxptime)}),r>0&&(i+="a=maxptime:"+r+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach(e=>{i+=t.writeExtmap(e)}),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute),s=a.length>0&&a[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map(e=>e.substring(17).split(" ").map(e=>parseInt(e,10)));l.length>0&&l[0].length>1&&l[0][0]===s&&(c=l[0][1]),i.codecs.forEach(e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(t.rtx={ssrc:c}),n.push(t),r&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach(e=>{e.maxBitrate=u})),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute)[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const r=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=r.length>0,n.compound=0===r.length;const o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const r=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"msid"===e.attribute);return r.length>0?(n=r[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let r;i.length>0&&(r=parseInt(i[0].substring(19),10)),isNaN(r)&&(r=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:n.fmt,maxMessageSize:r};const a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){const e=a[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let r;const o=void 0!==n?n:2;return r=e||t.generateSessionId(),"v=0\r\no="+(i||"thisisadapterortc")+" "+r+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let e=0;e<i.length;e++)switch(i[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[e].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let e=0;e<n.length;e++)if(n[e].length<2||"="!==n[e].charAt(1))return!1;return!0},e.exports=t}(tl)),tl.exports),il=Ks(nl),rl=ur({__proto__:null,default:il},[nl]);function ol(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=il.parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,hc(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function al(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||hc(e,"icecandidate",e=>{if(e.candidate){const t=il.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function sl(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=il.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=il.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const r=il.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?i=parseInt(r[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let r;r=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>r}),this._sctp=o}return n.apply(this,arguments)}}function cl(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},hc(e,"datachannel",e=>(t(e.channel,e.target),e))}function ll(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function ul(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t._safariVersion>=13.1)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function dl(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function hl(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then(e=>n.apply(this,[e]))})}var pl=Object.freeze({__proto__:null,removeExtmapAllowMixed:ul,shimAddIceCandidateNullOrEmpty:dl,shimConnectionState:ll,shimMaxMessageSize:sl,shimParameterlessSetLocalDescription:hl,shimRTCIceCandidate:ol,shimRTCIceCandidateRelayProtocol:al,shimSendThrowTypeError:cl});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=mc,i=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.userAgentData&&n.userAgentData.brands){const e=n.userAgentData.brands.find(e=>"Chromium"===e.brand);if(e)return{browser:"chrome",version:parseInt(e.version,10)}}if(n.mozGetUserMedia)t.browser="firefox",t.version=parseInt(dc(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=parseInt(dc(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=parseInt(dc(n.userAgent,/AppleWebKit\/(\d+)\./,1)),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,t._safariVersion=dc(n.userAgent,/Version\/(\d+(\.?\d+))/,1)}return t}(e),r={browserDetails:i,commonShim:pl,extractVersion:dc,disableLog:pc,disableWarnings:fc,sdp:rl};switch(i.browser){case"chrome":if(!Ic||!_c||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=Ic,dl(e,i),hl(e),Sc(e,i),Tc(e),_c(e,i),Cc(e),xc(e,i),Ec(e),Pc(e),Oc(e,i),ol(e),al(e),ll(e),sl(e,i),cl(e),ul(e,i);break;case"firefox":if(!Vc||!Dc||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=Vc,dl(e,i),hl(e),Nc(e,i),Dc(e,i),Ac(e),Uc(e),Lc(e),Mc(e),jc(e),Fc(e),Bc(e),zc(e),qc(e),ol(e),ll(e),sl(e,i),cl(e);break;case"safari":if(!el||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=el,dl(e,i),hl(e),$c(e),Yc(e),Kc(e),Hc(e),Wc(e),Qc(e),Gc(e),Xc(e),ol(e),al(e),sl(e,i),cl(e),ul(e,i);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});class fl extends Promise{constructor(e){super(e)}catch(e){return super.catch(e)}static reject(e){return super.reject(e)}static all(e){return super.all(e)}static race(e){return super.race(e)}}const ml=/version\/(\d+(\.?_?\d+)+)/i;let gl;function vl(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===e&&"undefined"==typeof navigator)return;const n=(null!=e?e:navigator.userAgent).toLowerCase();if(void 0===gl||t){const e=yl.find(e=>{let{test:t}=e;return t.test(n)});gl=null==e?void 0:e.describe(n)}return gl}const yl=[{test:/firefox|iceweasel|fxios/i,describe:e=>({name:"Firefox",version:bl(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:kl(e)})},{test:/chrom|crios|crmo/i,describe:e=>({name:"Chrome",version:bl(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0,osVersion:kl(e)})},{test:/safari|applewebkit/i,describe:e=>({name:"Safari",version:bl(ml,e),os:e.includes("mobile/")?"iOS":"macOS",osVersion:kl(e)})}];function bl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=t.match(e);return i&&i.length>=n&&i[n]||""}function kl(e){return e.includes("mac os")?bl(/\(.+?(\d+_\d+(:?_\d+)?)/,e,1).replace(/_/g,"."):void 0}class wl extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var Sl,Tl,Cl,El,Pl,Rl,xl;!function(e){e[e.NotAllowed=0]="NotAllowed",e[e.ServerUnreachable=1]="ServerUnreachable",e[e.InternalError=2]="InternalError",e[e.Cancelled=3]="Cancelled",e[e.LeaveRequest=4]="LeaveRequest",e[e.Timeout=5]="Timeout",e[e.WebSocket=6]="WebSocket",e[e.ServiceNotFound=7]="ServiceNotFound"}(Sl||(Sl={}));class _l extends wl{constructor(e,t,n,i){super(1,e),this.name="ConnectionError",this.status=n,this.reason=t,this.context=i,this.reasonName=Sl[t]}static notAllowed(e,t,n){return new _l(e,Sl.NotAllowed,t,n)}static timeout(e){return new _l(e,Sl.Timeout)}static leaveRequest(e,t){return new _l(e,Sl.LeaveRequest,void 0,t)}static internal(e,t){return new _l(e,Sl.InternalError,void 0,t)}static cancelled(e){return new _l(e,Sl.Cancelled)}static serverUnreachable(e,t){return new _l(e,Sl.ServerUnreachable,t)}static websocket(e,t,n){return new _l(e,Sl.WebSocket,t,n)}static serviceNotFound(e,t){return new _l(e,Sl.ServiceNotFound,void 0,t)}}class Ol extends wl{constructor(e){super(21,null!=e?e:"device is unsupported"),this.name="DeviceUnsupportedError"}}class Il extends wl{constructor(e){super(20,null!=e?e:"track is invalid"),this.name="TrackInvalidError"}}class Nl extends wl{constructor(e){super(10,null!=e?e:"unsupported server"),this.name="UnsupportedServer"}}class Al extends wl{constructor(e){super(12,null!=e?e:"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Dl extends wl{constructor(e){super(13,null!=e?e:"unable to negotiate"),this.name="NegotiationError"}}class Ll extends wl{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class Ml extends wl{constructor(e,t){super(15,e),this.name="SignalRequestError",this.reason=t,this.reasonName="string"==typeof t?t:Fs[t]}}!function(e){e[e.AlreadyOpened=0]="AlreadyOpened",e[e.AbnormalEnd=1]="AbnormalEnd",e[e.DecodeFailed=2]="DecodeFailed",e[e.LengthExceeded=3]="LengthExceeded",e[e.Incomplete=4]="Incomplete",e[e.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",e[e.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"}(Tl||(Tl={}));class Ul extends wl{constructor(e,t){super(16,e),this.name="DataStreamError",this.reason=t,this.reasonName=Tl[t]}}class jl extends wl{constructor(e){super(18,e),this.name="SignalReconnectError"}}!function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(Cl||(Cl={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(Cl||(Cl={}));class Fl{}function Bl(e){return void 0===e?e:"function"==typeof structuredClone?"object"==typeof e&&null!==e?structuredClone(Object.assign({},e)):structuredClone(e):JSON.parse(JSON.stringify(e))}Fl.setTimeout=function(){return setTimeout(...arguments)},Fl.setInterval=function(){return setInterval(...arguments)},Fl.clearTimeout=function(){return clearTimeout(...arguments)},Fl.clearInterval=function(){return clearInterval(...arguments)},function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.Moved="moved",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.ParticipantAttributesChanged="participantAttributesChanged",e.ParticipantActive="participantActive",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.VideoPlaybackStatusChanged="videoPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged",e.ChatMessage="chatMessage",e.LocalTrackSubscribed="localTrackSubscribed",e.MetricsReceived="metricsReceived"}(El||(El={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackCpuConstrained="localTrackCpuConstrained",e.LocalSenderCreated="localSenderCreated",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.TrackCpuConstrained="trackCpuConstrained",e.MediaDevicesError="mediaDevicesError",e.AudioStreamAcquired="audioStreamAcquired",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded",e.AttributesChanged="attributesChanged",e.LocalTrackSubscribed="localTrackSubscribed",e.ChatMessage="chatMessage",e.Active="active"}(Pl||(Pl={})),function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",e.RemoteMute="remoteMute",e.SubscribedQualityUpdate="subscribedQualityUpdate",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackSubscribed="localTrackSubscribed",e.Offline="offline",e.SignalRequestResponse="signalRequestResponse",e.SignalConnected="signalConnected",e.RoomMoved="roomMoved"}(Rl||(Rl={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Restarted="restarted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.CpuConstrained="cpuConstrained",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.VideoPlaybackStarted="videoPlaybackStarted",e.VideoPlaybackFailed="videoPlaybackFailed",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged",e.SubscriptionFailed="subscriptionFailed",e.TrackProcessorUpdate="trackProcessorUpdate",e.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",e.TranscriptionReceived="transcriptionReceived",e.TimeSyncUpdate="timeSyncUpdate",e.PreConnectBufferFlushed="preConnectBufferFlushed"}(xl||(xl={}));class zl{constructor(e,t,n,i,r){if("object"==typeof e)this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else{if(void 0===t||void 0===n)throw new TypeError("Unsupported options: provide at least width, height and maxBitrate");this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:n,maxFramerate:i,priority:r}}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const ql=["vp8","h264"],Vl=["vp8","h264","vp9","av1","h265"],Hl=function(e){return!!ql.find(t=>t===e)};var Wl,Kl;!function(e){e[e.PREFER_REGRESSION=0]="PREFER_REGRESSION",e[e.SIMULCAST=1]="SIMULCAST",e[e.REGRESSION=2]="REGRESSION"}(Wl||(Wl={})),function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:24e3},e.music={maxBitrate:48e3},e.musicStereo={maxBitrate:64e3},e.musicHighQuality={maxBitrate:96e3},e.musicHighQualityStereo={maxBitrate:128e3}}(Kl||(Kl={}));const Gl={h90:new zl(160,90,9e4,20),h180:new zl(320,180,16e4,20),h216:new zl(384,216,18e4,20),h360:new zl(640,360,45e4,20),h540:new zl(960,540,8e5,25),h720:new zl(1280,720,17e5,30),h1080:new zl(1920,1080,3e6,30),h1440:new zl(2560,1440,5e6,30),h2160:new zl(3840,2160,8e6,30)},Jl={h120:new zl(160,120,7e4,20),h180:new zl(240,180,125e3,20),h240:new zl(320,240,14e4,20),h360:new zl(480,360,33e4,20),h480:new zl(640,480,5e5,20),h540:new zl(720,540,6e5,25),h720:new zl(960,720,13e5,30),h1080:new zl(1440,1080,23e5,30),h1440:new zl(1920,1440,38e5,30)},$l={h360fps3:new zl(640,360,2e5,3,"medium"),h360fps15:new zl(640,360,4e5,15,"medium"),h720fps5:new zl(1280,720,8e5,5,"medium"),h720fps15:new zl(1280,720,15e5,15,"medium"),h720fps30:new zl(1280,720,2e6,30,"medium"),h1080fps15:new zl(1920,1080,25e5,15,"medium"),h1080fps30:new zl(1920,1080,5e6,30,"medium"),original:new zl(0,0,7e6,30,"medium")};function Ql(e,t,n){var i,r,o,a;const{optionsWithoutProcessor:s,audioProcessor:c,videoProcessor:l}=ou(null!=e?e:{}),u=null==t?void 0:t.processor,d=null==n?void 0:n.processor,h=null!=s?s:{};return!0===h.audio&&(h.audio={}),!0===h.video&&(h.video={}),h.audio&&(Yl(h.audio,t),null!==(i=(o=h.audio).deviceId)&&void 0!==i||(o.deviceId={ideal:"default"}),(c||u)&&(h.audio.processor=null!=c?c:u)),h.video&&(Yl(h.video,n),null!==(r=(a=h.video).deviceId)&&void 0!==r||(a.deviceId={ideal:"default"}),(l||d)&&(h.video.processor=null!=l?l:d)),h}function Yl(e,t){return Object.keys(t).forEach(n=>{void 0===e[n]&&(e[n]=t[n])}),e}function Xl(e){var t,n,i,r;const o={};if(e.video)if("object"==typeof e.video){const n={},r=n,a=e.video;Object.keys(a).forEach(e=>{"resolution"===e?Yl(r,a.resolution):r[e]=a[e]}),o.video=n,null!==(t=(i=o.video).deviceId)&&void 0!==t||(i.deviceId={ideal:"default"})}else o.video=!!e.video&&{deviceId:{ideal:"default"}};else o.video=!1;return e.audio?"object"==typeof e.audio?(o.audio=e.audio,null!==(n=(r=o.audio).deviceId)&&void 0!==n||(r.deviceId={ideal:"default"})):o.audio={deviceId:{ideal:"default"}}:o.audio=!1,o}function Zl(){var e;const t="undefined"!=typeof window&&(window.AudioContext||window.webkitAudioContext);if(t){const n=new t({latencyHint:"interactive"});if("suspended"===n.state&&"undefined"!=typeof window&&(null===(e=window.document)||void 0===e?void 0:e.body)){const e=()=>rc(this,void 0,void 0,function*(){var t;try{"suspended"===n.state&&(yield n.resume())}catch(e){console.warn("Error trying to auto-resume audio context",e)}finally{null===(t=window.document.body)||void 0===t||t.removeEventListener("click",e)}});n.addEventListener("statechange",()=>{var t;"closed"===n.state&&(null===(t=window.document.body)||void 0===t||t.removeEventListener("click",e))}),window.document.body.addEventListener("click",e)}return n}}function eu(e){return"audioinput"===e?lu.Source.Microphone:"videoinput"===e?lu.Source.Camera:lu.Source.Unknown}function tu(e){return e===lu.Source.Microphone?"audioinput":e===lu.Source.Camera?"videoinput":void 0}function nu(e){return e.split("/")[1].toLowerCase()}function iu(e){const t=[];return e.forEach(e=>{void 0!==e.track&&t.push(new ns({cid:e.track.mediaStreamID,track:e.trackInfo}))}),t}function ru(e){return"mediaStreamTrack"in e?{trackID:e.sid,source:e.source,muted:e.isMuted,enabled:e.mediaStreamTrack.enabled,kind:e.kind,streamID:e.mediaStreamID,streamTrackID:e.mediaStreamTrack.id}:{trackID:e.trackSid,enabled:e.isEnabled,muted:e.isMuted,trackInfo:Object.assign({mimeType:e.mimeType,name:e.trackName,encrypted:e.isEncrypted,kind:e.kind,source:e.source},e.track?ru(e.track):{})}}function ou(e){const t=Object.assign({},e);let n,i;return"object"==typeof t.audio&&t.audio.processor&&(n=t.audio.processor,t.audio=Object.assign(Object.assign({},t.audio),{processor:void 0})),"object"==typeof t.video&&t.video.processor&&(i=t.video.processor,t.video=Object.assign(Object.assign({},t.video),{processor:void 0})),{audioProcessor:n,videoProcessor:i,optionsWithoutProcessor:Bl(t)}}function au(e,t){return e.width*e.height<t.width*t.height}const su=[];var cu;!function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH"}(cu||(cu={}));class lu extends cc.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=lu.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Zs,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),5e3):this.handleAppVisibilityChanged()},this.log=ec(null!==(i=n.loggerName)&&void 0!==i?i:$s.Track),this.loggerContextCb=n.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=lu.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),ru(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===lu.Kind.Video&&(t="video"),0===this.attachedElements.length&&this.kind===lu.Kind.Video&&this.addAppVisibilityListener(),e||("audio"===t&&(su.forEach(t=>{null!==t.parentElement||e||(e=t)}),e&&su.splice(su.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),uu(this.mediaStreamTrack,e);const n=e.srcObject.getTracks(),i=n.some(e=>"audio"===e.kind);return e.play().then(()=>{this.emit(i?xl.AudioPlaybackStarted:xl.VideoPlaybackStarted)}).catch(t=>{"NotAllowedError"===t.name?this.emit(i?xl.AudioPlaybackFailed:xl.VideoPlaybackFailed,t):"AbortError"===t.name?Zs.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):Zs.warn("could not playback ".concat(i?"audio":"video"),t),i&&e&&n.some(e=>"video"===e.kind)&&"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(xl.ElementAttached,e),e}detach(e){try{if(e){du(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e),this.emit(xl.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(e=>{du(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e),this.emit(xl.ElementDetached,e)}),this.attachedElements=[],t}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=ec(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),su.forEach(e=>{e.parentElement||(t=!1)}),t&&su.push(e)}}handleAppVisibilityChanged(){return rc(this,void 0,void 0,function*(){this.isInBackground="hidden"===document.visibilityState,this.isInBackground||this.kind!==lu.Kind.Video||setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Tu()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Tu()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function uu(e,t){let n,i;n=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,i="audio"===e.kind?n.getAudioTracks():n.getVideoTracks(),i.includes(e)||(i.forEach(e=>{n.removeTrack(e)}),n.addTrack(e)),ku()&&t instanceof HTMLVideoElement||(t.autoplay=!0),t.muted=0===n.getAudioTracks().length,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,(ku()||yu())&&t instanceof HTMLVideoElement&&setTimeout(()=>{t.srcObject=n,t.play().catch(()=>{})},0))}function du(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}!function(e){let t,n,i;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(n=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(i=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return Go.AUDIO;case t.Video:return Go.VIDEO;default:return Go.DATA}},e.kindFromProto=function(e){switch(e){case Go.AUDIO:return t.Audio;case Go.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case n.Camera:return Jo.CAMERA;case n.Microphone:return Jo.MICROPHONE;case n.ScreenShare:return Jo.SCREEN_SHARE;case n.ScreenShareAudio:return Jo.SCREEN_SHARE_AUDIO;default:return Jo.UNKNOWN}},e.sourceFromProto=function(e){switch(e){case Jo.CAMERA:return n.Camera;case Jo.MICROPHONE:return n.Microphone;case Jo.SCREEN_SHARE:return n.ScreenShare;case Jo.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}},e.streamStateFromProto=function(e){switch(e){case Ka.ACTIVE:return i.Active;case Ka.PAUSED:return i.Paused;default:return i.Unknown}}}(lu||(lu={}));const hu="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function pu(e){return new fl(t=>Fl.setTimeout(t,e))}function fu(){return"addTransceiver"in RTCPeerConnection.prototype}function mu(){return"addTrack"in RTCPeerConnection.prototype}function gu(e){return"av1"===e||"vp9"===e}function vu(e){return!(!document||wu())&&(e||(e=document.createElement("audio")),"setSinkId"in e)}function yu(){var e;return"Firefox"===(null===(e=vl())||void 0===e?void 0:e.name)}function bu(){const e=vl();return!!e&&"Chrome"===e.name&&"iOS"!==e.os}function ku(){var e;return"Safari"===(null===(e=vl())||void 0===e?void 0:e.name)}function wu(){const e=vl();return"Safari"===(null==e?void 0:e.name)||"iOS"===(null==e?void 0:e.os)}function Su(){var e,t;return!!Tu()&&(null!==(t=null===(e=navigator.userAgentData)||void 0===e?void 0:e.mobile)&&void 0!==t?t:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent))}function Tu(){return"undefined"!=typeof document}function Cu(){return"ReactNative"==navigator.product}function Eu(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function Pu(e){return Eu(e)?e.hostname.split(".")[0]:null}function Ru(){if(n.g&&n.g.LiveKitReactNativeGlobal)return n.g.LiveKitReactNativeGlobal}function xu(){if(!Cu())return;let e=Ru();return e?e.platform:void 0}function _u(){if(Tu())return window.devicePixelRatio;if(Cu()){let e=Ru();if(e)return e.devicePixelRatio}return 1}function Ou(e,t){const n=e.split("."),i=t.split("."),r=Math.min(n.length,i.length);for(let e=0;e<r;++e){const t=parseInt(n[e],10),o=parseInt(i[e],10);if(t>o)return 1;if(t<o)return-1;if(e===r-1&&t===o)return 0}return""===e&&""!==t?-1:""===t?1:n.length==i.length?0:n.length<i.length?-1:1}function Iu(e){for(const t of e)t.target.handleResize(t)}function Nu(e){for(const t of e)t.target.handleVisibilityChanged(t)}let Au=null;const Du=()=>(Au||(Au=new ResizeObserver(Iu)),Au);let Lu=null;const Mu=()=>(Lu||(Lu=new IntersectionObserver(Nu,{root:null,rootMargin:"0px"})),Lu);let Uu;function ju(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=document.createElement("canvas");r.width=e,r.height=t;const o=r.getContext("2d");null==o||o.fillRect(0,0,r.width,r.height),i&&o&&(o.beginPath(),o.arc(e/2,t/2,50,0,2*Math.PI,!0),o.closePath(),o.fillStyle="grey",o.fill());const a=r.captureStream(),[s]=a.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=n,s}function Fu(){if(!Uu){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const i=e.createMediaStreamDestination();if(t.connect(n),n.connect(i),t.start(),[Uu]=i.stream.getAudioTracks(),!Uu)throw Error("Could not get empty media stream audio track");Uu.enabled=!1}return Uu.clone()}class Bu{get isResolved(){return this._isResolved}constructor(e,t){this._isResolved=!1,this.onFinally=t,this.promise=new Promise((t,n)=>rc(this,void 0,void 0,function*(){this.resolve=t,this.reject=n,e&&(yield e(t,n))})).finally(()=>{var e;this._isResolved=!0,null===(e=this.onFinally)||void 0===e||e.call(this)})}}function zu(e){if("string"==typeof e||"number"==typeof e)return e;if(Array.isArray(e))return e[0];if(void 0!==e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(void 0!==e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function qu(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}function Vu(e){switch(e.reason){case Sl.LeaveRequest:return e.context;case Sl.Cancelled:return Xo.CLIENT_INITIATED;case Sl.NotAllowed:return Xo.USER_REJECTED;case Sl.ServerUnreachable:return Xo.JOIN_FAILURE;default:return Xo.UNKNOWN_REASON}}function Hu(e){return void 0!==e?Number(e):void 0}function Wu(e){return void 0!==e?BigInt(e):void 0}function Ku(e){return!!e&&!(e instanceof MediaStreamTrack)&&e.isLocal}function Gu(e){return!!e&&e.kind==lu.Kind.Audio}function Ju(e){return!!e&&e.kind==lu.Kind.Video}function $u(e){return Ku(e)&&Ju(e)}function Qu(e){return Ku(e)&&Gu(e)}function Yu(e){return!!e&&!e.isLocal}function Xu(e){return!!e&&!e.isLocal}function Zu(e){return Yu(e)&&Ju(e)}function ed(e){return e.endsWith("/")?e:"".concat(e,"/")}function td(e,t){return e.pathname="".concat(ed(e.pathname)).concat(t),e}function nd(e){if("string"==typeof e)return $a.fromJson(JSON.parse(e),{ignoreUnknownFields:!0});if(e instanceof ArrayBuffer)return $a.fromBinary(new Uint8Array(e));throw new Error("could not decode websocket message: ".concat(typeof e))}const id="lk_e2ee";var rd,od,ad,sd,cd;function ld(){return void 0!==window.RTCRtpScriptTransform}!function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"}(rd||(rd={})),function(e){e.KeyRatcheted="keyRatcheted"}(od||(od={})),function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"}(ad||(ad={})),function(e){e.Error="cryptorError"}(sd||(sd={})),cc.EventEmitter,function(e){e[e.InvalidKey=0]="InvalidKey",e[e.MissingKey=1]="MissingKey",e[e.InternalError=2]="InternalError"}(cd||(cd={}));class ud extends cc.EventEmitter{constructor(e,t){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=e=>{var t,n;const{kind:i,data:r}=e.data;switch(i){case"error":if(Zs.error(r.error.message),r.uuid){const e=this.decryptDataRequests.get(r.uuid);if(null==e?void 0:e.reject){e.reject(r.error);break}const t=this.encryptDataRequests.get(r.uuid);if(null==t?void 0:t.reject){t.reject(r.error);break}}this.emit(ad.EncryptionError,r.error,r.participantIdentity);break;case"initAck":r.enabled&&this.keyProvider.getKeys().forEach(e=>{this.postKey(e)});break;case"enable":if(r.enabled&&this.keyProvider.getKeys().forEach(e=>{this.postKey(e)}),this.encryptionEnabled!==r.enabled&&r.participantIdentity===(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))this.emit(ad.ParticipantEncryptionStatusChanged,r.enabled,this.room.localParticipant),this.encryptionEnabled=r.enabled;else if(r.participantIdentity){const e=null===(n=this.room)||void 0===n?void 0:n.getParticipantByIdentity(r.participantIdentity);if(!e)throw TypeError("couldn't set encryption status, participant not found".concat(r.participantIdentity));this.emit(ad.ParticipantEncryptionStatusChanged,r.enabled,e)}break;case"ratchetKey":this.keyProvider.emit(rd.KeyRatcheted,r.ratchetResult,r.participantIdentity,r.keyIndex);break;case"decryptDataResponse":const e=this.decryptDataRequests.get(r.uuid);(null==e?void 0:e.resolve)&&e.resolve(r);break;case"encryptDataResponse":const i=this.encryptDataRequests.get(r.uuid);(null==i?void 0:i.resolve)&&i.resolve(r)}},this.onWorkerError=e=>{Zs.error("e2ee worker encountered an error:",{error:e.error}),this.emit(ad.EncryptionError,e.error,void 0)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=t}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!(void 0!==window.RTCRtpSender&&void 0!==window.RTCRtpSender.prototype.createEncodedStreams||ld()))throw new Ol("tried to setup end-to-end encryption on an unsupported browser");if(Zs.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:tc.getLevel()}};this.worker&&(Zs.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){Zs.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){e&&0!==e.length?this.postSifTrailer(e):Zs.warn("ignoring server sent trailer as it's empty")}setupEngine(e){e.on(Rl.RTPVideoMapUpdate,e=>{this.postRTPMap(e)})}setupEventListeners(e,t){e.on(El.TrackPublished,(e,t)=>this.setParticipantCryptorEnabled(e.trackInfo.encryption!==la.NONE,t.identity)),e.on(El.ConnectionStateChanged,t=>{t===_h.Connected&&e.remoteParticipants.forEach(e=>{e.trackPublications.forEach(t=>{this.setParticipantCryptorEnabled(t.trackInfo.encryption!==la.NONE,e.identity)})})}).on(El.TrackUnsubscribed,(e,t,n)=>{var i;const r={kind:"removeTransform",data:{participantIdentity:n.identity,trackId:e.mediaStreamID}};null===(i=this.worker)||void 0===i||i.postMessage(r)}).on(El.TrackSubscribed,(e,t,n)=>{this.setupE2EEReceiver(e,n.identity,t.trackInfo)}).on(El.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(e=>{this.postKey(e)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(Pl.LocalSenderCreated,(e,t)=>rc(this,void 0,void 0,function*(){this.setupE2EESender(t,e)})),e.localParticipant.on(Pl.LocalTrackPublished,e=>{if(!Ju(e.track)||!wu())return;const t={kind:"updateCodec",data:{trackId:e.track.mediaStreamID,codec:nu(e.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(t)}),t.on(rd.SetKey,e=>this.postKey(e)).on(rd.RatchetRequest,(e,t)=>this.postRatchetRequest(e,t))}encryptData(e){return rc(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const t=crypto.randomUUID(),n={kind:"encryptDataRequest",data:{uuid:t,payload:e,participantIdentity:this.room.localParticipant.identity}},i=new Bu;return i.onFinally=()=>{this.encryptDataRequests.delete(t)},this.encryptDataRequests.set(t,i),this.worker.postMessage(n),i.promise})}handleEncryptedData(e,t,n,i){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const r=crypto.randomUUID(),o={kind:"decryptDataRequest",data:{uuid:r,payload:e,iv:t,participantIdentity:n,keyIndex:i}},a=new Bu;return a.onFinally=()=>{this.decryptDataRequests.delete(r)},this.decryptDataRequests.set(r,a),this.worker.postMessage(o),a.promise}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const n={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(n)}postKey(e){let{key:t,participantIdentity:n,keyIndex:i}=e;var r;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:n,isPublisher:n===(null===(r=this.room)||void 0===r?void 0:r.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,t){if(!this.worker)throw new ReferenceError("failed to enable e2ee, worker is not ready");{const n={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(n)}}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const n={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(n)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,n){if(e.receiver){if(!(null==n?void 0:n.mimeType)||""===n.mimeType)throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,"video"===e.kind?nu(n.mimeType):void 0)}}setupE2EESender(e,t){Ku(e)&&t?this.handleSender(t,e.mediaStreamID,void 0):t||Zs.warn("early return because sender is not ready")}handleReceiver(e,t,n,i){return rc(this,void 0,void 0,function*(){if(this.worker){if(ld()&&!bu()){const r={kind:"decode",participantIdentity:n,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,r)}else{if(id in e&&i){const e={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:n}};return void this.worker.postMessage(e)}let r=e.writableStream,o=e.readableStream;if(!r||!o){const t=e.createEncodedStreams();e.writableStream=t.writable,r=t.writable,e.readableStream=t.readable,o=t.readable}const a={kind:"decode",data:{readableStream:o,writableStream:r,trackId:t,codec:i,participantIdentity:n,isReuse:id in e}};this.worker.postMessage(a,[o,r])}e[id]=!0}})}handleSender(e,t,n){var i;if(!(id in e)&&this.worker){if(!(null===(i=this.room)||void 0===i?void 0:i.localParticipant.identity)||""===this.room.localParticipant.identity)throw TypeError("local identity needs to be known in order to set up encrypted sender");if(ld()&&!bu()){Zs.info("initialize script transform");const i={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:n};e.transform=new RTCRtpScriptTransform(this.worker,i)}else{Zs.info("initialize encoded streams");const i=e.createEncodedStreams(),r={kind:"encode",data:{readableStream:i.readable,writableStream:i.writable,codec:n,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(r,[i.readable,i.writable])}e[id]=!0}}}class dd{constructor(){this.failedConnectionAttempts=new Map,this.backOffPromises=new Map}static getInstance(){return this._instance||(this._instance=new dd),this._instance}addFailedConnectionAttempt(e){var t;const n=Pu(new URL(e));if(!n)return;let i=null!==(t=this.failedConnectionAttempts.get(n))&&void 0!==t?t:0;this.failedConnectionAttempts.set(n,i+1),this.backOffPromises.set(n,pu(Math.min(500*Math.pow(2,i),15e3)))}getBackOffPromise(e){const t=new URL(e),n=t&&Pu(t);return n&&this.backOffPromises.get(n)||Promise.resolve()}resetFailedConnectionAttempts(e){const t=new URL(e),n=t&&Pu(t);n&&(this.failedConnectionAttempts.set(n,0),this.backOffPromises.set(n,Promise.resolve()))}resetAll(){this.backOffPromises.clear(),this.failedConnectionAttempts.clear()}}dd._instance=null;const hd="default";class pd{constructor(){this._previousDevices=[]}static getInstance(){return void 0===this.instance&&(this.instance=new pd),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return rc(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;if((null===(i=pd.userMediaPromiseMap)||void 0===i?void 0:i.size)>0){Zs.debug("awaiting getUserMedia promise");try{e?yield pd.userMediaPromiseMap.get(e):yield Promise.all(pd.userMediaPromiseMap.values())}catch(e){Zs.warn("error waiting for media permissons")}}let r=yield navigator.mediaDevices.enumerateDevices();if(n&&(!ku()||!t.hasDeviceInUse(e))){const t=0===r.filter(t=>t.kind===e).length||r.some(t=>{const n=""===t.label,i=!e||t.kind===e;return n&&i});if(t){const t={video:"audioinput"!==e&&"audiooutput"!==e,audio:"videoinput"!==e&&{deviceId:{ideal:"default"}}},n=yield navigator.mediaDevices.getUserMedia(t);r=yield navigator.mediaDevices.enumerateDevices(),n.getTracks().forEach(e=>{e.stop()})}}return t._previousDevices=r,e&&(r=r.filter(t=>t.kind===e)),r}()})}normalizeDeviceId(e,t,n){return rc(this,void 0,void 0,function*(){if(t!==hd)return t;const i=yield this.getDevices(e),r=i.find(e=>e.deviceId===hd);if(!r)return void Zs.warn("could not reliably determine default device");const o=i.find(e=>e.deviceId!==hd&&e.groupId===(null!=n?n:r.groupId));if(o)return null==o?void 0:o.deviceId;Zs.warn("could not reliably determine default device")})}hasDeviceInUse(e){return e?pd.userMediaPromiseMap.has(e):pd.userMediaPromiseMap.size>0}}var fd;pd.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],pd.userMediaPromiseMap=new Map,function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"}(fd||(fd={}));class md{constructor(){this.pendingTasks=new Map,this.taskMutex=new pr,this.nextTaskIndex=0}run(e){return rc(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:fd.WAITING};this.pendingTasks.set(t.id,t);const n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=fd.RUNNING,yield e()}finally{t.status=fd.COMPLETED,this.pendingTasks.delete(t.id),n()}})}flush(){return rc(this,void 0,void 0,function*(){return this.run(()=>rc(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class gd{get readyState(){return this.ws.readyState}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i;if(null===(n=t.signal)||void 0===n?void 0:n.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const r=new WebSocket(e,null!==(i=t.protocols)&&void 0!==i?i:[]);r.binaryType="arraybuffer",this.ws=r;const o=function(){let{closeCode:e,reason:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.close(e,t)};this.opened=new fl((e,t)=>{const n=()=>{t(_l.websocket("Encountered websocket error during connection establishment"))};r.onopen=()=>{e({readable:new ReadableStream({start(e){r.onmessage=t=>{let{data:n}=t;return e.enqueue(n)},r.onerror=t=>e.error(t)},cancel:o}),writable:new WritableStream({write(e){r.send(e)},abort(){r.close()},close:o}),protocol:r.protocol,extensions:r.extensions}),r.removeEventListener("error",n)},r.addEventListener("error",n)}),this.closed=new fl((e,t)=>{const n=()=>rc(this,void 0,void 0,function*(){const n=new fl(e=>{r.readyState!==WebSocket.CLOSED&&r.addEventListener("close",t=>{e(t)},{once:!0})}),i=yield fl.race([pu(250),n]);i?e(i):t(_l.websocket("Encountered unspecified websocket error without a timely close event"))});r.onclose=t=>{let{code:i,reason:o}=t;e({closeCode:i,reason:o}),r.removeEventListener("error",n)},r.addEventListener("error",n)}),t.signal&&(t.signal.onabort=()=>r.close()),this.close=o}}const vd=["syncState","trickle","offer","answer","simulate","leave"];var yd;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.DISCONNECTING=3]="DISCONNECTING",e[e.DISCONNECTED=4]="DISCONNECTED"}(yd||(yd={}));class bd{get currentState(){return this.state}get isDisconnected(){return this.state===yd.DISCONNECTING||this.state===yd.DISCONNECTED}get isEstablishingConnection(){return this.state===yd.CONNECTING||this.state===yd.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;this.rtt=0,this.state=yd.DISCONNECTED,this.log=Zs,this._requestId=0,this.useV0SignalPath=!1,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=ec(null!==(n=t.loggerName)&&void 0!==n?n:$s.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new md,this.queuedRequests=[],this.closingLock=new pr,this.connectionLock=new pr,this.state=yd.DISCONNECTED}get logContext(){var e,t;return null!==(t=null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this))&&void 0!==t?t:{}}join(e,t,n,i){return rc(this,arguments,void 0,function(e,t,n,i){var r=this;let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function*(){return r.state=yd.CONNECTING,r.options=n,yield r.connect(e,t,n,i,o)}()})}reconnect(e,t,n,i){return rc(this,void 0,void 0,function*(){if(this.options)return this.state=yd.RECONNECTING,this.clearPingInterval(),yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:n,reconnectReason:i}),void 0,this.useV0SignalPath);this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext)})}connect(e,t,n,i){return rc(this,arguments,void 0,function(e,t,n,i){var r=this;let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function*(){const a=yield r.connectionLock.lock();r.connectOptions=n,r.useV0SignalPath=o;const s=function(){var e;const t=new Na({sdk:Aa.JS,protocol:16,version:"2.17.0"});return Cu()&&(t.os=null!==(e=xu())&&void 0!==e?e:""),t}(),c=o?function(e,t,n){var i;const r=new URLSearchParams;return r.set("access_token",e),n.reconnect&&(r.set("reconnect","1"),n.sid&&r.set("sid",n.sid)),r.set("auto_subscribe",n.autoSubscribe?"1":"0"),r.set("sdk",Cu()?"reactnative":"js"),r.set("version",t.version),r.set("protocol",t.protocol.toString()),t.deviceModel&&r.set("device_model",t.deviceModel),t.os&&r.set("os",t.os),t.osVersion&&r.set("os_version",t.osVersion),t.browser&&r.set("browser",t.browser),t.browserVersion&&r.set("browser_version",t.browserVersion),n.adaptiveStream&&r.set("adaptive_stream","1"),n.reconnectReason&&r.set("reconnect_reason",n.reconnectReason.toString()),(null===(i=navigator.connection)||void 0===i?void 0:i.type)&&r.set("network",navigator.connection.type),r}(t,s,n):function(e,t,n){const i=new URLSearchParams;i.set("access_token",e);const r=new qs({clientInfo:t,connectionSettings:new zs({autoSubscribe:!!n.autoSubscribe,adaptiveStream:!!n.adaptiveStream}),reconnect:!!n.reconnect,participantSid:n.sid?n.sid:void 0});n.reconnectReason&&(r.reconnectReason=n.reconnectReason);const o=new Vs({joinRequest:r.toBinary()});return i.set("join_request",btoa(new TextDecoder("utf-8").decode(o.toBinary()))),i}(t,s,n),l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=function(e,t){const n=new URL(function(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}(e));return t.forEach((e,t)=>{n.searchParams.set(t,e)}),td(n,"rtc")}(e,t);return n?i:td(i,"v1")}(e,c,o).toString(),u=(d=l,td(new URL(qu(d)),"validate")).toString();var d;return new Promise((e,t)=>rc(r,void 0,void 0,function*(){var r,o;try{let a=!1;const s=e=>rc(this,void 0,void 0,function*(){if(a)return;a=!0;const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown reason";if(!(e instanceof AbortSignal))return t;const n=e.reason;switch(typeof n){case"string":return n;case"object":return n instanceof Error?n.message:t;default:return"toString"in n?n.toString():t}}(e instanceof Event?e.currentTarget:e,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(n)).catch(e=>{this.log.error(e),this.close()}):this.close(),c(),t(_l.cancelled(n))});null==i||i.addEventListener("abort",s);const c=()=>{clearTimeout(d),null==i||i.removeEventListener("abort",s)},d=setTimeout(()=>{s(_l.timeout("room connection has timed out (signal)"))},n.websocketTimeout),h=(e,t)=>{this.handleSignalConnected(e,d,t)},p=new URL(l);p.searchParams.has("access_token")&&p.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(p),Object.assign({reconnect:n.reconnect,reconnectReason:n.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new gd(l);try{this.ws.closed.then(e=>{var n;this.isEstablishingConnection&&t(_l.internal("Websocket got closed during a (re)connection attempt: ".concat(e.reason))),1e3!==e.closeCode&&(this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:e.reason,code:e.closeCode,wasClean:1e3===e.closeCode,state:this.state})),this.state===yd.CONNECTED&&this.handleOnClose(null!==(n=e.reason)&&void 0!==n?n:"Unexpected WS error"))}).catch(e=>{this.isEstablishingConnection&&t(_l.internal("Websocket error during a (re)connection attempt: ".concat(e)))});const i=yield this.ws.opened.catch(e=>rc(this,void 0,void 0,function*(){if(this.state!==yd.CONNECTED){this.state=yd.DISCONNECTED,clearTimeout(d);const n=yield this.handleConnectionError(e,u);return void t(n)}this.handleWSError(e),t(e)}));if(clearTimeout(d),!i)return;const a=i.readable.getReader();this.streamWriter=i.writable.getWriter();const s=yield a.read();if(a.releaseLock(),!s.value)throw _l.internal("no message received as first message");const c=nd(s.value),l=this.validateFirstMessage(c,null!==(r=n.reconnect)&&void 0!==r&&r);if(!l.isValid)return void t(l.error);"join"===(null===(o=c.message)||void 0===o?void 0:o.case)&&(this.pingTimeoutDuration=c.message.value.pingTimeout,this.pingIntervalDuration=c.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration}))),h(i,l.shouldProcessFirstMessage?c:void 0),e(l.response)}catch(e){t(e)}finally{c()}}finally{a()}}))}()})}startReadingLoop(e,t){return rc(this,void 0,void 0,function*(){for(t&&this.handleSignalResponse(t);;){this.signalLatency&&(yield pu(this.signalLatency));const{done:t,value:n}=yield e.read();if(t)break;const i=nd(n);this.handleSignalResponse(i)}})}close(){return rc(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Close method called on signal client";return function*(){if([yd.DISCONNECTING||yd.DISCONNECTED].includes(e.state))return void e.log.debug("ignoring signal close as it's already in disconnecting state");const i=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=yd.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:n});const t=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([t,pu(250)])}}catch(t){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:t}))}finally{t&&(e.state=yd.DISCONNECTED),i()}}()})}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:wd(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:wd(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Xa({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new Za({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return rc(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){const r=n.getNextRequestId();return yield n.sendRequest({case:"updateMetadata",value:new ps({requestId:r,metadata:e,name:t,attributes:i})}),r}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new hs({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new Ps({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ar.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new As({timestamp:Ar.parse(Date.now()),rtt:Ar.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new cs({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new us({reason:Xo.CLIENT_INITIATED,action:ds.DISCONNECT})})}sendRequest(e){return rc(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){const i=!n&&!function(e){const t=vd.indexOf(e.case)>=0;return Zs.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}(e);if(i&&t.state===yd.RECONNECTING)return void t.queuedRequests.push(()=>rc(t,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));if(n||(yield t.requestQueue.flush()),t.signalLatency&&(yield pu(t.signalLatency)),t.isDisconnected)return void t.log.debug("skipping signal request (type: ".concat(e.case,") - SignalClient disconnected"));if(!t.streamWriter)return void t.log.error("cannot send signal request before connected, type: ".concat(null==e?void 0:e.case),t.logContext);const r=new Ja({message:e});try{t.useJSON?yield t.streamWriter.write(r.toJsonString()):yield t.streamWriter.write(r.toBinary())}catch(e){t.log.error("error sending signal message",Object.assign(Object.assign({},t.logContext),{error:e}))}}()})}handleSignalResponse(e){var t,n;const i=e.message;if(null==i)return void this.log.debug("received unsupported message",this.logContext);let r=!1;if("answer"===i.case){const e=kd(i.value);this.onAnswer&&this.onAnswer(e,i.value.id,i.value.midToTrackId)}else if("offer"===i.case){const e=kd(i.value);this.onOffer&&this.onOffer(e,i.value.id,i.value.midToTrackId)}else if("trickle"===i.case){const e=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(e,i.value.target)}else"update"===i.case?this.onParticipantUpdate&&this.onParticipantUpdate(null!==(t=i.value.participants)&&void 0!==t?t:[]):"trackPublished"===i.case?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):"speakersChanged"===i.case?this.onSpeakersChanged&&this.onSpeakersChanged(null!==(n=i.value.speakers)&&void 0!==n?n:[]):"leave"===i.case?this.onLeave&&this.onLeave(i.value):"mute"===i.case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):"roomUpdate"===i.case?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):"connectionQuality"===i.case?this.onConnectionQuality&&this.onConnectionQuality(i.value):"streamStateUpdate"===i.case?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):"subscribedQualityUpdate"===i.case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):"subscriptionPermissionUpdate"===i.case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):"refreshToken"===i.case?this.onTokenRefresh&&this.onTokenRefresh(i.value):"trackUnpublished"===i.case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):"subscriptionResponse"===i.case?this.onSubscriptionError&&this.onSubscriptionError(i.value):"pong"===i.case||("pongResp"===i.case?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),r=!0):"requestResponse"===i.case?this.onRequestResponse&&this.onRequestResponse(i.value):"trackSubscribed"===i.case?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):"roomMoved"===i.case?(this.onTokenRefresh&&this.onTokenRefresh(i.value.token),this.onRoomMoved&&this.onRoomMoved(i.value)):"mediaSectionsRequirement"===i.case?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(i.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));r||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return rc(this,void 0,void 0,function*(){if(this.state===yd.DISCONNECTED)return;const t=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){this.clearPingTimeout(),this.pingTimeoutDuration?this.pingTimeout=Fl.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*this.pingTimeoutDuration).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},1e3*this.pingTimeoutDuration):this.log.warn("ping timeout duration not set",this.logContext)}clearPingTimeout(){this.pingTimeout&&Fl.clearTimeout(this.pingTimeout)}startPingInterval(){this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration?(this.log.debug("start ping interval",this.logContext),this.pingInterval=Fl.setInterval(()=>{this.sendPing()},1e3*this.pingIntervalDuration)):this.log.warn("ping interval duration not set",this.logContext)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Fl.clearInterval(this.pingInterval)}handleSignalConnected(e,t,n){this.state=yd.CONNECTED,clearTimeout(t),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),n)}validateFirstMessage(e,t){var n,i,r,o,a;return"join"===(null===(n=e.message)||void 0===n?void 0:n.case)?{isValid:!0,response:e.message.value}:this.state===yd.RECONNECTING&&"leave"!==(null===(i=e.message)||void 0===i?void 0:i.case)?"reconnect"===(null===(r=e.message)||void 0===r?void 0:r.case)?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&"leave"===(null===(o=e.message)||void 0===o?void 0:o.case)?{isValid:!1,error:_l.leaveRequest("Received leave request while trying to (re)connect",e.message.value.reason)}:t?{isValid:!1,error:_l.internal("Unexpected first message")}:{isValid:!1,error:_l.internal("did not receive join response, got ".concat(null===(a=e.message)||void 0===a?void 0:a.case," instead"))}}handleConnectionError(e,t){return rc(this,void 0,void 0,function*(){try{const n=yield fetch(t);switch(n.status){case 404:return _l.serviceNotFound("v1 RTC path not found. Consider upgrading your LiveKit server version","v0-rtc");case 401:case 403:const e=yield n.text();return _l.notAllowed(e,n.status)}return e instanceof _l?e:_l.internal("Encountered unknown websocket error during connection: ".concat(e),{status:n.status,statusText:n.statusText})}catch(e){return e instanceof _l?e:_l.serverUnreachable(e instanceof Error?e.message:"server was not reachable")}})}}function kd(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function wd(e,t){return new rs({sdp:e.sdp,type:e.type,id:t})}class Sd{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class Td{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const n=Date.now();n-this._lastCleanup>this.ttl/2&&this.cleanup();const i=n+this.ttl;return this._map.set(e,{value:t,expiresAt:i}),this}get(e){const t=this._map.get(e);if(t){if(!(t.expiresAt<Date.now()))return t.value;this._map.delete(e)}}has(e){const t=this._map.get(e);return!(!t||t.expiresAt<Date.now()&&(this._map.delete(e),1))}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,n]of this._map.entries())n.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e(n.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],n=this.asValueMap();for(const[i,r]of n.entries())t.push(e(r,i,n));return t}asValueMap(){const e=new Map;for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e.set(t,n.value);return e}}var Cd,Ed,Pd,Rd,xd,_d={},Od={},Id={exports:{}};function Nd(){if(Cd)return Id.exports;Cd=1;var e=Id.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",(t+=null!=e.rateNumerator?" rate=%s":"")+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(e).forEach(function(t){e[t].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})}),Id.exports}function Ad(){return Ed||(Ed=1,function(e){var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,i){var r=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:r&&!n[e.name]&&(n[e.name]={});var o=e.push?{}:r?n[e.name]:n;!function(e,n,i,r){if(r&&!i)n[r]=t(e[1]);else for(var o=0;o<i.length;o+=1)null!=e[o+1]&&(n[i[o]]=t(e[o+1]))}(i.match(e.reg),o,e.names,e.name),e.push&&n[e.push].push(o)},i=Nd(),r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},o=[],a=t;return e.split(/(\r\n|\r|\n)/).filter(r).forEach(function(e){var t=e[0],r=e.slice(2);"m"===t&&(o.push({rtp:[],fmtp:[]}),a=o[o.length-1]);for(var s=0;s<(i[t]||[]).length;s+=1){var c=i[t][s];if(c.reg.test(r))return n(c,a,r)}}),t.media=o,t};var o=function(e,n){var i=n.split(/=(.+)/,2);return 2===i.length?e[i[0]]=t(i[1]):1===i.length&&n.length>1&&(e[i[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],i=e.split(" ").map(t),r=0;r<i.length;r+=3)n.push({component:i[r],ip:i[r+1],port:i[r+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var n,i=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),i=!0),{scid:n,paused:i}})})}}(Od)),Od}function Dd(){if(Rd)return Pd;Rd=1;var e=Nd(),t=/%[sdv%]/g,n=function(e){var n=1,i=arguments,r=i.length;return e.replace(t,function(e){if(n>=r)return e;var t=i[n];switch(n+=1,e){case"%%":return"%";case"%s":return String(t);case"%d":return Number(t);case"%v":return""}})},i=function(e,t,i){var r=[e+"="+(t.format instanceof Function?t.format(t.push?i:i[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var a=t.names[o];t.name?r.push(i[t.name][a]):r.push(i[t.names[o]])}else r.push(i[t.name]);return n.apply(null,r)},r=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];return Pd=function(t,n){n=n||{},null==t.version&&(t.version=0),null==t.name&&(t.name=" "),t.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var a=n.outerOrder||r,s=n.innerOrder||o,c=[];return a.forEach(function(n){e[n].forEach(function(e){e.name in t&&null!=t[e.name]?c.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach(function(t){c.push(i(n,e,t))})})}),t.media.forEach(function(t){c.push(i("m",e.m[0],t)),s.forEach(function(n){e[n].forEach(function(e){e.name in t&&null!=t[e.name]?c.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach(function(t){c.push(i(n,e,t))})})})}),c.join("\r\n")+"\r\n"},Pd}var Ld=function(){if(xd)return _d;xd=1;var e=Ad(),t=Dd(),n=Nd();return _d.grammar=n,_d.write=t,_d.parse=e.parse,_d.parseParams=e.parseParams,_d.parseFmtpConfig=e.parseFmtpConfig,_d.parsePayloads=e.parsePayloads,_d.parseRemoteCandidates=e.parseRemoteCandidates,_d.parseImageAttributes=e.parseImageAttributes,_d.parseSimulcastStreamList=e.parseSimulcastStreamList,_d}();function Md(e,t,n){var i,r,o;void 0===t&&(t=50),void 0===n&&(n={});var a=null!=(i=n.isImmediate)&&i,s=null!=(r=n.callback)&&r,c=n.maxWait,l=Date.now(),u=[];function d(){if(void 0!==c){var e=Date.now()-l;if(e+t>=c)return c-e}return t}var h=function(){var t=[].slice.call(arguments),n=this;return new Promise(function(i,r){var c=a&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,l=Date.now(),!a){var i=e.apply(n,t);s&&s(i),u.forEach(function(e){return(0,e.resolve)(i)}),u=[]}},d()),c){var h=e.apply(n,t);return s&&s(h),i(h)}u.push({resolve:i,reject:r})})};return h.cancel=function(e){void 0!==o&&clearTimeout(o),u.forEach(function(t){return(0,t.reject)(e)}),u=[]},h}const Ud="negotiationStarted",jd="negotiationComplete",Fd="rtpVideoPayloadTypes";class Bd extends cc.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;super(),this.log=Zs,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Md(e=>rc(this,void 0,void 0,function*(){this.emit(Ud);try{yield this.createAndSendOffer()}catch(t){if(!e)throw t;e(t)}}),20),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=ec(null!==(n=t.loggerName)&&void 0!==n?n:$s.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new pr}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=e=>{var t;e.candidate&&(null===(t=this.onIceCandidate)||void 0===t||t.call(this,e.candidate))},e.onicecandidateerror=e=>{var t;null===(t=this.onIceCandidateError)||void 0===t||t.call(this,e)},e.oniceconnectionstatechange=()=>{var t;null===(t=this.onIceConnectionStateChange)||void 0===t||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;null===(t=this.onSignalingStatechange)||void 0===t||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,e.connectionState)},e.ondatachannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},e.ontrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},e}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}get isICEConnected(){return null!==this._pc&&("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState)}addIceCandidate(e){return rc(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,t){return rc(this,void 0,void 0,function*(){var n;if("answer"===e.type&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let i;if("offer"===e.type){let{stereoMids:t,nackMids:n}=function(e){var t;const n=[],i=[],r=Ld.parse(null!==(t=e.sdp)&&void 0!==t?t:"");let o=0;return r.media.forEach(e=>{var t;const r=Vd(e.mid);"audio"===e.type&&(e.rtp.some(e=>"opus"===e.codec&&(o=e.payload,!0)),(null===(t=e.rtcpFb)||void 0===t?void 0:t.some(e=>e.payload===o&&"nack"===e.type))&&i.push(r),e.fmtp.some(e=>e.payload===o&&(e.config.includes("sprop-stereo=1")&&n.push(r),!0)))}),{stereoMids:n,nackMids:i}}(e);this.remoteStereoMids=t,this.remoteNackMids=n}else if("answer"===e.type){const t=Ld.parse(null!==(n=e.sdp)&&void 0!==n?n:"");t.media.forEach(e=>{const t=Vd(e.mid);"audio"===e.type&&this.trackBitrates.some(n=>{if(!n.transceiver||t!=n.transceiver.mid)return!1;let i=0;if(e.rtp.some(e=>e.codec.toUpperCase()===n.codec.toUpperCase()&&(i=e.payload,!0)),0===i)return!0;let r=!1;for(const t of e.fmtp)if(t.payload===i){t.config=t.config.split(";").filter(e=>!e.includes("maxaveragebitrate")).join(";"),n.maxbr>0&&(t.config+=";maxaveragebitrate=".concat(1e3*n.maxbr)),r=!0;break}return r||n.maxbr>0&&e.fmtp.push({payload:i,config:"maxaveragebitrate=".concat(1e3*n.maxbr)}),!0})}),i=Ld.write(t)}return yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach(e=>{this.pc.addIceCandidate(e)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):"answer"===e.type&&(this.emit(jd),e.sdp)&&Ld.parse(e.sdp).media.forEach(e=>{"video"===e.type&&this.emit(Fd,e.rtp)}),!0})}createAndSendOffer(e){return rc(this,void 0,void 0,function*(){var t;const n=yield this.offerLock.lock();try{if(void 0===this.onOffer)return;if((null==e?void 0:e.iceRestart)&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&"have-local-offer"===this._pc.signalingState){const t=this._pc.remoteDescription;if(!(null==e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this._pc.setRemoteDescription(t)}else if(!this._pc||"closed"===this._pc.signalingState)return void this.log.warn("could not createOffer with closed peer connection",this.logContext);this.log.debug("starting to negotiate",this.logContext);const n=this.latestOfferId+1;this.latestOfferId=n;const i=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:i.sdp},this.logContext));const r=Ld.parse(null!==(t=i.sdp)&&void 0!==t?t:"");if(r.media.forEach(e=>{qd(e),"audio"===e.type?zd(e,["all"],[]):"video"===e.type&&this.trackBitrates.some(t=>{if(!e.msid||!t.cid||!e.msid.includes(t.cid))return!1;let n=0;if(e.rtp.some(e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0)),0===n)return!0;if(gu(t.codec)&&!ku()&&this.ensureVideoDDExtensionForSVC(e,r),!gu(t.codec))return!0;const i=Math.round(.7*t.maxbr);for(const t of e.fmtp)if(t.payload===n){t.config.includes("x-google-start-bitrate")||(t.config+=";x-google-start-bitrate=".concat(i));break}return!0})}),this.latestOfferId>n)return void this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:n}));yield this.setMungedSDP(i,Ld.write(r)),this.onOffer(i,this.latestOfferId)}finally{n()}})}createAndSetAnswer(){return rc(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),n=Ld.parse(null!==(e=t.sdp)&&void 0!==e?e:"");return n.media.forEach(e=>{qd(e),"audio"===e.type&&zd(e,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,Ld.write(n)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTransceiverOfKind(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new Al("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new Al("PC closed, cannot configure");return null===(t=this._pc)||void 0===t?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(null===(e=this._pc)||void 0===e?void 0:e.removeTrack)}removeTrack(e){var t;return null===(t=this._pc)||void 0===t?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.connectionState)&&void 0!==t?t:"closed"}getICEConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.iceConnectionState)&&void 0!==t?t:"closed"}getSignallingState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.signalingState)&&void 0!==t?t:"closed"}getTransceivers(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getTransceivers())&&void 0!==t?t:[]}getSenders(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getSenders())&&void 0!==t?t:[]}getLocalDescription(){var e;return null===(e=this._pc)||void 0===e?void 0:e.localDescription}getRemoteDescription(){var e;return null===(e=this.pc)||void 0===e?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return rc(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const n=new Map,i=new Map;if((yield this._pc.getStats()).forEach(e=>{switch(e.type){case"transport":t=e.selectedCandidatePairId;break;case"candidate-pair":""===t&&e.selected&&(t=e.id),n.set(e.id,e);break;case"remote-candidate":i.set(e.id,"".concat(e.address,":").concat(e.port))}}),""===t)return;const r=null===(e=n.get(t))||void 0===e?void 0:e.remoteCandidateId;return void 0!==r?i.get(r):void 0})}setMungedSDP(e,t,n){return rc(this,void 0,void 0,function*(){if(t){const i=e.sdp;e.sdp=t;try{return this.log.debug("setting munged ".concat(n?"remote":"local"," description"),this.logContext),void(n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e))}catch(n){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:n,sdp:t})),e.sdp=i}}try{n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(t){let i="unknown error";t instanceof Error?i=t.message:"string"==typeof t&&(i=t);const r={error:i,sdp:e.sdp};throw!n&&this.pc.remoteDescription&&(r.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:r})),new Dl(i)}})}ensureVideoDDExtensionForSVC(e,t){var n,i;if(!(null===(n=e.ext)||void 0===n?void 0:n.some(e=>e.uri===hu))){if(0===this.ddExtID){let e=0;t.media.forEach(t=>{var n;"video"===t.type&&(null===(n=t.ext)||void 0===n||n.forEach(t=>{t.value>e&&(e=t.value)}))}),this.ddExtID=e+1}null===(i=e.ext)||void 0===i||i.push({value:this.ddExtID,uri:hu})}}}function zd(e,t,n){const i=Vd(e.mid);let r=0;e.rtp.some(e=>"opus"===e.codec&&(r=e.payload,!0)),r>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(i)&&!e.rtcpFb.some(e=>e.payload===r&&"nack"===e.type)&&e.rtcpFb.push({payload:r,type:"nack"}),(t.includes(i)||1===t.length&&"all"===t[0])&&e.fmtp.some(e=>e.payload===r&&(e.config.includes("stereo=1")||(e.config+=";stereo=1"),!0)))}function qd(e){if(e.connection){const t=e.connection.ip.indexOf(":")>=0;(4===e.connection.version&&t||6===e.connection.version&&!t)&&(e.connection.ip="0.0.0.0",e.connection.version=4)}}function Vd(e){return"number"==typeof e?e.toFixed(0):e}const Hd="vp8",Wd={audioPreset:Kl.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:$l.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Hd,backupCodec:!0,preConnectBuffer:!1},Kd={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},Gd={deviceId:{ideal:"default"},resolution:Gl.h720.resolution},Jd={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new class{constructor(e){this._retryDelays=void 0!==e?[...e]:ic}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+1e3*Math.random()}},disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!0},$d={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Qd;!function(e){e[e.NEW=0]="NEW",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.FAILED=3]="FAILED",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}(Qd||(Qd={}));class Yd{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}get mode(){return this._mode}constructor(e,t,n){var i;this.peerConnectionTimeout=$d.peerConnectionTimeout,this.log=Zs,this.updateState=()=>{var e,t;const n=this.state,i=this.requiredTransports.map(e=>e.getConnectionState());i.every(e=>"connected"===e)?this.state=Qd.CONNECTED:i.some(e=>"failed"===e)?this.state=Qd.FAILED:i.some(e=>"connecting"===e)?this.state=Qd.CONNECTING:i.every(e=>"closed"===e)?this.state=Qd.CLOSED:i.some(e=>"closed"===e)?this.state=Qd.CLOSING:i.every(e=>"new"===e)&&(this.state=Qd.NEW),n!==this.state&&(this.log.debug("pc state change: from ".concat(Qd[n]," to ").concat(Qd[this.state]),this.logContext),null===(e=this.onStateChange)||void 0===e||e.call(this,this.state,this.publisher.getConnectionState(),null===(t=this.subscriber)||void 0===t?void 0:t.getConnectionState()))},this.log=ec(null!==(i=n.loggerName)&&void 0!==i?i:$s.PCManager),this.loggerOptions=n,this.isPublisherConnectionRequired="subscriber-primary"!==t,this.isSubscriberConnectionRequired="subscriber-primary"===t,this.publisher=new Bd(e,n),this._mode=t,"publisher-only"!==t&&(this.subscriber=new Bd(e,n),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,Wa.SUBSCRIBER)},this.subscriber.onDataChannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},this.subscriber.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,Wa.PUBLISHER)},this.publisher.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},this.publisher.onOffer=(e,t)=>{var n;null===(n=this.onPublisherOffer)||void 0===n||n.call(this,e,t)},this.state=Qd.NEW,this.connectionLock=new pr,this.remoteOfferLock=new pr}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}requirePublisher(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return rc(this,void 0,void 0,function*(){var e;if(this.publisher&&"closed"!==this.publisher.getSignallingState()){const e=this.publisher;for(const t of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(t)}catch(e){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:e}))}}yield Promise.all([this.publisher.close(),null===(e=this.subscriber)||void 0===e?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return rc(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return rc(this,void 0,void 0,function*(){var n;t===Wa.PUBLISHER?yield this.publisher.addIceCandidate(e):yield null===(n=this.subscriber)||void 0===n?void 0:n.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,t){return rc(this,void 0,void 0,function*(){var n,i,r;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:null===(n=this.subscriber)||void 0===n?void 0:n.getSignallingState().toString()}));const o=yield this.remoteOfferLock.lock();try{if(!(yield null===(i=this.subscriber)||void 0===i?void 0:i.setRemoteDescription(e,t)))return;return yield null===(r=this.subscriber)||void 0===r?void 0:r.createAndSetAnswer()}finally{o()}})}updateConfiguration(e,t){var n;this.publisher.setConfiguration(e),null===(n=this.subscriber)||void 0===n||n.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return rc(this,void 0,void 0,function*(){var n;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&"connected"!==this.publisher.getConnectionState()&&"connecting"!==this.publisher.getConnectionState()&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all(null===(n=this.requiredTransports)||void 0===n?void 0:n.map(n=>this.ensureTransportConnected(n,e,t)))}finally{i()}})}negotiate(e){return rc(this,void 0,void 0,function*(){return new fl((t,n)=>rc(this,void 0,void 0,function*(){const i=setTimeout(()=>{n(new Dl("negotiation timed out"))},this.peerConnectionTimeout);e.signal.addEventListener("abort",()=>{clearTimeout(i),n(new Dl("negotiation aborted"))}),this.publisher.once(Ud,()=>{e.signal.aborted||this.publisher.once(jd,()=>{clearTimeout(i),t()})}),yield this.publisher.negotiate(e=>{clearTimeout(i),e instanceof Error?n(e):n(new Error(String(e)))})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTransceiverOfKind(e,t){return this.publisher.addTransceiverOfKind(e,t)}getMidForReceiver(e){const t=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(t=>t.receiver===e);return null==t?void 0:t.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===Wa.PUBLISHER||e===Wa.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return rc(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.peerConnectionTimeout;return function*(){if("connected"!==e.getConnectionState())return new Promise((e,r)=>rc(n,void 0,void 0,function*(){const n=()=>{this.log.warn("abort transport connection",this.logContext),Fl.clearTimeout(o),r(_l.cancelled("room connection has been cancelled"))};(null==t?void 0:t.signal.aborted)&&n(),null==t||t.signal.addEventListener("abort",n);const o=Fl.setTimeout(()=>{null==t||t.signal.removeEventListener("abort",n),r(_l.internal("could not establish pc connection"))},i);for(;this.state!==Qd.CONNECTED;)if(yield pu(50),null==t?void 0:t.signal.aborted)return void r(_l.cancelled("room connection has been cancelled"));Fl.clearTimeout(o),null==t||t.signal.removeEventListener("abort",n),e()}))}()})}}class Xd{static fetchRegionSettings(e,t,n){return rc(this,void 0,void 0,function*(){const i=yield Xd.fetchLock.lock();try{const i=yield fetch("".concat(function(e){return"".concat(e.protocol.replace("ws","http"),"//").concat(e.host,"/settings")}(e),"/regions"),{headers:{authorization:"Bearer ".concat(t)},signal:n});if(i.ok){const e=function(e){var t;const n=e.get("Cache-Control");if(n){const e=null===(t=n.match(/(?:^|[,\s])max-age=(\d+)/))||void 0===t?void 0:t[1];if(e)return parseInt(e,10)}}(i.headers),t=e?1e3*e:5e3;return{regionSettings:yield i.json(),updatedAtInMs:Date.now(),maxAgeInMs:t}}throw 401===i.status?_l.notAllowed("Could not fetch region settings: ".concat(i.statusText),i.status):_l.internal("Could not fetch region settings: ".concat(i.statusText))}catch(e){throw e instanceof _l?e:(null==n?void 0:n.aborted)?_l.cancelled("Region fetching was aborted"):_l.serverUnreachable("Could not fetch region settings, ".concat(e instanceof Error?"".concat(e.name,": ").concat(e.message):e))}finally{i()}})}static scheduleRefetch(e,t,n){return rc(this,void 0,void 0,function*(){const i=Xd.settingsTimeouts.get(e.hostname);clearTimeout(i),Xd.settingsTimeouts.set(e.hostname,setTimeout(()=>rc(this,void 0,void 0,function*(){try{const n=yield Xd.fetchRegionSettings(e,t);Xd.updateCachedRegionSettings(e,t,n)}catch(i){if(i instanceof _l&&i.reason===Sl.NotAllowed)return void Zs.debug("token is not valid, cancelling auto region refresh");Zs.debug("auto refetching of region settings failed",{error:i}),Xd.scheduleRefetch(e,t,n)}}),n))})}static updateCachedRegionSettings(e,t,n){Xd.cache.set(e.hostname,n),Xd.scheduleRefetch(e,t,n.maxAgeInMs)}static stopRefetch(e){const t=Xd.settingsTimeouts.get(e);t&&(clearTimeout(t),Xd.settingsTimeouts.delete(e))}static scheduleCleanup(e){let t=Xd.connectionTrackers.get(e);t&&(t.cleanupTimeout&&clearTimeout(t.cleanupTimeout),t.cleanupTimeout=setTimeout(()=>{const t=Xd.connectionTrackers.get(e);t&&0===t.connectionCount&&(Zs.debug("stopping region refetch after disconnect delay",{hostname:e}),Xd.stopRefetch(e)),t&&(t.cleanupTimeout=void 0)},3e4))}static cancelCleanup(e){const t=Xd.connectionTrackers.get(e);(null==t?void 0:t.cleanupTimeout)&&(clearTimeout(t.cleanupTimeout),t.cleanupTimeout=void 0)}notifyConnected(){const e=this.serverUrl.hostname;let t=Xd.connectionTrackers.get(e);t||(t={connectionCount:0},Xd.connectionTrackers.set(e,t)),t.connectionCount++,Xd.cancelCleanup(e)}notifyDisconnected(){const e=this.serverUrl.hostname,t=Xd.connectionTrackers.get(e);t&&(t.connectionCount=Math.max(0,t.connectionCount-1),0===t.connectionCount&&Xd.scheduleCleanup(e))}constructor(e,t){this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Eu(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(e){return rc(this,void 0,void 0,function*(){return Xd.fetchRegionSettings(this.serverUrl,this.token,e)})}getNextBestRegionUrl(e){return rc(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let t=Xd.cache.get(this.serverUrl.hostname);(!t||Date.now()-t.updatedAtInMs>t.maxAgeInMs)&&(t=yield this.fetchRegionSettings(e),Xd.updateCachedRegionSettings(this.serverUrl,this.token,t));const n=t.regionSettings.regions.filter(e=>!this.attemptedRegions.find(t=>t.url===e.url));if(n.length>0){const e=n[0];return this.attemptedRegions.push(e),Zs.debug("next region: ".concat(e.region)),e.url}return null})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(e){Xd.updateCachedRegionSettings(this.serverUrl,this.token,e)}}Xd.cache=new Map,Xd.settingsTimeouts=new Map,Xd.connectionTrackers=new Map,Xd.fetchLock=new pr;class Zd extends Error{constructor(e,t,n){super(t),this.code=e,this.message=th(t,Zd.MAX_MESSAGE_BYTES),this.data=n?th(n,Zd.MAX_DATA_BYTES):void 0}static fromProto(e){return new Zd(e.code,e.message,e.data)}toProto(){return new xa({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new Zd(Zd.ErrorCode[e],Zd.ErrorMessage[e],t)}}function eh(e){return(new TextEncoder).encode(e).length}function th(e,t){if(eh(e)<=t)return e;let n=0,i=e.length;const r=new TextEncoder;for(;n<i;){const o=Math.floor((n+i+1)/2);r.encode(e.slice(0,o)).length<=t?n=o:i=o-1}return e.slice(0,n)}Zd.MAX_MESSAGE_BYTES=256,Zd.MAX_DATA_BYTES=15360,Zd.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404},Zd.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const nh=2e3;function ih(e,t){if(!t)return 0;let n,i;return"bytesReceived"in e?(n=e.bytesReceived,i=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,i=t.bytesSent),void 0===n||void 0===i||void 0===e.timestamp||void 0===t.timestamp?0:8*(n-i)*1e3/(e.timestamp-t.timestamp)}const rh="undefined"!=typeof MediaRecorder,oh=rh?MediaRecorder:class{constructor(){throw new Error("MediaRecorder is not available in this environment")}};class ah extends oh{constructor(e,t){if(!rh)throw new Error("MediaRecorder is not available in this environment");let n,i;super(new MediaStream([e.mediaStreamTrack]),t);const r=()=>{this.removeEventListener("dataavailable",n),this.removeEventListener("stop",r),this.removeEventListener("error",o),null==i||i.close(),i=void 0},o=e=>{null==i||i.error(e),this.removeEventListener("dataavailable",n),this.removeEventListener("stop",r),this.removeEventListener("error",o),i=void 0};this.byteStream=new ReadableStream({start:e=>{i=e,n=t=>rc(this,void 0,void 0,function*(){let n;if(t.data.arrayBuffer){const e=yield t.data.arrayBuffer();n=new Uint8Array(e)}else{if(!t.data.byteArray)throw new Error("no data available!");n=t.data.byteArray}void 0!==i&&e.enqueue(n)}),this.addEventListener("dataavailable",n)},cancel:()=>{r()}}),this.addEventListener("stop",r),this.addEventListener("error",o)}}class sh extends lu{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(e,t,arguments.length>4?arguments[4]:void 0),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Md(()=>rc(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>rc(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(xl.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new pr,this.pauseUpstreamLock=new pr,this.trackChangeLock=new pr,this.trackChangeLock.lock().then(t=>rc(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{t()}})),this._constraints=e.getConstraints(),n&&(this._constraints=n)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==lu.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return null!==(t=null===(e=this.processor)||void 0===e?void 0:e.processedTrack)&&void 0!==t?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return rc(this,void 0,void 0,function*(){var n;if(e===this._mediaStreamTrack&&!t)return;let i;if(this._mediaStreamTrack&&(this.attachedElements.forEach(e=>{du(this._mediaStreamTrack,e)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints()),this.processor&&e){if(this.log.debug("restarting processor",this.logContext),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(uu(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}this.sender&&"closed"!==(null===(n=this.sender.transport)||void 0===n?void 0:n.state)&&(yield this.sender.replaceTrack(null!=i?i:e)),this.providedByUser||this._mediaStreamTrack===e||this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(t=>{uu(null!=i?i:e,t)}))})}waitForDimensions(){return rc(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return function*(){var n;if(e.kind===lu.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");"iOS"===(null===(n=vl())||void 0===n?void 0:n.os)&&(yield pu(10));const i=Date.now();for(;Date.now()-i<t;){const t=e.dimensions;if(t)return t;yield pu(50)}throw new Il("unable to get track dimensions after timeout")}()})}setDeviceId(e){return rc(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===zu(e)||(this._constraints.deviceId=e,!!this.isMuted||(yield this.restartTrack(),zu(e)===this._mediaStreamTrack.getSettings().deviceId))})}getDeviceId(){return rc(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){if(e.source===lu.Source.ScreenShare)return;const{deviceId:n,groupId:i}=e._mediaStreamTrack.getSettings(),r=e.kind===lu.Kind.Audio?"audioinput":"videoinput";return t?pd.getInstance().normalizeDeviceId(r,n,i):n}()})}mute(){return rc(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return rc(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return rc(this,void 0,void 0,function*(){const n=yield this.trackChangeLock.lock();try{if(!this.sender)throw new Il("unable to replace an unpublished track");let n,i;return"boolean"==typeof t?n=t:void 0!==t&&(n=t.userProvidedTrack,i=t.stopProcessor),this.providedByUser=null==n||n,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),i&&this.processor&&(yield this.internalStopProcessor()),this}finally{n()}})}restart(e){return rc(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:t,facingMode:n}=e,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const r={audio:!1,video:!1};this.kind===lu.Kind.Video?r.video=!t&&!n||{deviceId:t,facingMode:n}:r.audio=!t||Object.assign({deviceId:t},i),this.attachedElements.forEach(e=>{du(this.mediaStreamTrack,e)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const o=(yield navigator.mediaDevices.getUserMedia(r)).getTracks()[0];return this.kind===lu.Kind.Video&&(yield o.applyConstraints(i)),o.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(o),this._constraints=e,this.emit(xl.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),this.isMuted===e&&this._mediaStreamTrack.enabled!==e||(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?xl.Muted:xl.Unmuted,this))}get needsReAcquisition(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return rc(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Su()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted||(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),null===(e=this.processor)||void 0===e||e.destroy(),this.processor=void 0}pauseUpstream(){return rc(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!0===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to pause upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!0,this.emit(xl.UpstreamPaused,this);const t=vl();if("Safari"===(null==t?void 0:t.name)&&Ou(t.version,"12.0")<0)throw new Ol("pauseUpstream is not supported on Safari < 12.");"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return rc(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!1===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to resume upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!1,this.emit(xl.UpstreamResumed,this),"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return rc(this,void 0,void 0,function*(){var e;if(null===(e=this.sender)||void 0===e?void 0:e.getStats)return yield this.sender.getStats()})}setProcessor(e){return rc(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;const r=yield t.trackChangeLock.lock();try{t.log.debug("setting up processor",t.logContext);const r=document.createElement(t.kind),o={kind:t.kind,track:t._mediaStreamTrack,element:r,audioContext:t.audioContext};if(yield e.init(o),t.log.debug("processor initialized",t.logContext),t.processor&&(yield t.internalStopProcessor()),"unknown"===t.kind)throw TypeError("cannot set processor on track of unknown kind");if(uu(t._mediaStreamTrack,r),r.muted=!0,r.play().catch(e=>{e instanceof DOMException&&"AbortError"===e.name?(t.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},t.logContext),{error:e})),setTimeout(()=>{r.play().catch(e=>{t.log.error("failed to play processor element",Object.assign(Object.assign({},t.logContext),{err:e}))})},100)):t.log.error("failed to play processor element",Object.assign(Object.assign({},t.logContext),{error:e}))}),t.processor=e,t.processorElement=r,t.processor.processedTrack){for(const e of t.attachedElements)e!==t.processorElement&&n&&(du(t._mediaStreamTrack,e),uu(t.processor.processedTrack,e));yield null===(i=t.sender)||void 0===i?void 0:i.replaceTrack(t.processor.processedTrack)}t.emit(xl.TrackProcessorUpdate,t.processor)}finally{r()}}()})}getProcessor(){return this.processor}stopProcessor(){return rc(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){const n=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(t)}finally{n()}}()})}internalStopProcessor(){return rc(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i;e.processor&&(e.log.debug("stopping processor",e.logContext),null===(n=e.processor.processedTrack)||void 0===n||n.stop(),yield e.processor.destroy(),e.processor=void 0,t||(null===(i=e.processorElement)||void 0===i||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(xl.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(rh)if(this.localTrackRecorder)this.log.warn("preconnect buffer already started");else{{let e="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(e)||(e="video/mp4"),this.localTrackRecorder=new ah(this,{mimeType:e})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},1e4)}else this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return null===(e=this.localTrackRecorder)||void 0===e?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return null===(e=this.localTrackRecorder)||void 0===e?void 0:e.mimeType}}class ch extends sh{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;super(e,lu.Kind.Audio,t,n,r),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>rc(this,void 0,void 0,function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(e){return void this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:e}))}e&&this.prevStats&&(this._currentBitrate=ih(e,this.prevStats)),this.prevStats=e}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(xl.AudioTrackFeatureUpdate,this,ta.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(xl.AudioTrackFeatureUpdate,this,ta.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return rc(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===lu.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return rc(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const t=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==zu(this._constraints.deviceId);return this.source!==lu.Source.Microphone||!this.stopOnMute&&"ended"!==this._mediaStreamTrack.readyState&&!t||this.isUserProvided||(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return rc(this,void 0,void 0,function*(){let t;if(e){const n=Xl({audio:e});"boolean"!=typeof n.audio&&(t=n.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return rc(this,void 0,void 0,function*(){const n=yield t.restart.call(this,e);return this.checkForSilence(),n})}startMonitor(){Tu()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},nh)))}setProcessor(e){return rc(this,void 0,void 0,function*(){var t;const n=yield this.trackChangeLock.lock();try{if(!Cu()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const n={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(n),this.processor=e,this.processor.processedTrack&&(yield null===(t=this.sender)||void 0===t?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(xl.TrackProcessorUpdate,this.processor)}finally{n()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return rc(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;let t;return(yield this.sender.getStats()).forEach(e=>{"outbound-rtp"===e.type&&(t={type:"audio",streamId:e.id,packetsSent:e.packetsSent,packetsLost:e.packetsLost,bytesSent:e.bytesSent,timestamp:e.timestamp,roundTripTime:e.roundTripTime,jitter:e.jitter})}),t})}checkForSilence(){return rc(this,void 0,void 0,function*(){const e=yield function(e){return rc(this,arguments,void 0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return function*(){const n=Zl();if(n){const i=n.createAnalyser();i.fftSize=2048;const r=i.frequencyBinCount,o=new Uint8Array(r);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield pu(t),i.getByteTimeDomainData(o);const a=o.some(e=>128!==e&&0!==e);return n.close(),!a}return!1}()})}(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(xl.AudioSilenceDetected)),e})}}const lh=Object.values(Gl),uh=Object.values(Jl),dh=Object.values($l),hh=[Gl.h180,Gl.h360],ph=[Jl.h180,Jl.h360],fh=["q","h","f"];function mh(e,t,n,i){var r,o;let a=null==i?void 0:i.videoEncoding;e&&(a=null==i?void 0:i.screenShareEncoding);const s=null==i?void 0:i.simulcast,c=null==i?void 0:i.scalabilityMode,l=null==i?void 0:i.videoCodec;if(!a&&!s&&!c||!t||!n)return[{}];a||(a=function(e,t,n,i){const r=function(e,t,n){if(e)return dh;const i=t>n?t/n:n/t;return Math.abs(i-16/9)<Math.abs(i-4/3)?lh:uh}(e,t,n);let{encoding:o}=r[0];const a=Math.max(t,n);for(let e=0;e<r.length;e+=1){const t=r[e];if(o=t.encoding,t.width>=a)break}if(i)switch(i){case"av1":case"h265":o=Object.assign({},o),o.maxBitrate=.7*o.maxBitrate;break;case"vp9":o=Object.assign({},o),o.maxBitrate=.85*o.maxBitrate}return o}(e,t,n,l),Zs.debug("using video encoding",a));const u=a.maxFramerate,d=new zl(t,n,a.maxBitrate,a.maxFramerate,a.priority);if(c&&gu(l)){const e=new bh(c),t=[];if(e.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));const n=vl();if(wu()||Cu()||"Chrome"===(null==n?void 0:n.name)&&Ou(null==n?void 0:n.version,"113")<0){const i="h"==e.suffix?2:3,r=function(e){return e||(e=vl()),"Safari"===(null==e?void 0:e.name)&&Ou(e.version,"18.3")>0||"iOS"===(null==e?void 0:e.os)&&!!(null==e?void 0:e.osVersion)&&Ou(e.osVersion,"18.3")>0}(n);for(let n=0;n<e.spatial;n+=1)t.push({rid:fh[2-n],maxBitrate:a.maxBitrate/Math.pow(i,n),maxFramerate:d.encoding.maxFramerate,scaleResolutionDownBy:r?Math.pow(2,n):void 0});t[0].scalabilityMode=c}else t.push({maxBitrate:a.maxBitrate,maxFramerate:d.encoding.maxFramerate,scalabilityMode:c});return d.encoding.priority&&(t[0].priority=d.encoding.priority,t[0].networkPriority=d.encoding.priority),Zs.debug("using svc encoding",{encodings:t}),t}if(!s)return[a];let h,p=[];if(p=e?null!==(r=yh(null==i?void 0:i.screenShareSimulcastLayers))&&void 0!==r?r:gh(e,d):null!==(o=yh(null==i?void 0:i.videoSimulcastLayers))&&void 0!==o?o:gh(e,d),p.length>0){const e=p[0];p.length>1&&([,h]=p);const i=Math.max(t,n);if(i>=960&&h)return vh(t,n,[e,h,d],u);if(i>=480)return vh(t,n,[e,d],u)}return vh(t,n,[d])}function gh(e,t){if(e)return[{scaleResolutionDownBy:2,fps:(n=t).encoding.maxFramerate}].map(e=>{var t,i;return new zl(Math.floor(n.width/e.scaleResolutionDownBy),Math.floor(n.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*((null!==(t=n.encoding.maxFramerate)&&void 0!==t?t:30)/(null!==(i=e.fps)&&void 0!==i?i:30))))),e.fps,n.encoding.priority)});var n;const{width:i,height:r}=t,o=i>r?i/r:r/i;return Math.abs(o-16/9)<Math.abs(o-4/3)?hh:ph}function vh(e,t,n,i){const r=[];if(n.forEach((n,o)=>{if(o>=fh.length)return;const a=Math.min(e,t),s={rid:fh[o],scaleResolutionDownBy:Math.max(1,a/Math.min(n.width,n.height)),maxBitrate:n.encoding.maxBitrate},c=i&&n.encoding.maxFramerate?Math.min(i,n.encoding.maxFramerate):n.encoding.maxFramerate;c&&(s.maxFramerate=c);const l=yu()||0===o;n.encoding.priority&&l&&(s.priority=n.encoding.priority,s.networkPriority=n.encoding.priority),r.push(s)}),Cu()&&"ios"===xu()){let e;r.forEach(t=>{e?t.maxFramerate&&t.maxFramerate>e&&(e=t.maxFramerate):e=t.maxFramerate});let t=!0;r.forEach(n=>{var i;n.maxFramerate!=e&&(t&&(t=!1,Zs.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Zs.info('Setting framerate of encoding "'.concat(null!==(i=n.rid)&&void 0!==i?i:"",'" to ').concat(e)),n.maxFramerate=e)})}return r}function yh(e){if(e)return e.sort((e,t)=>{const{encoding:n}=e,{encoding:i}=t;return n.maxBitrate>i.maxBitrate?1:n.maxBitrate<i.maxBitrate?-1:n.maxBitrate===i.maxBitrate&&n.maxFramerate&&i.maxFramerate?n.maxFramerate>i.maxFramerate?1:-1:0})}class bh{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat(null!==(e=this.suffix)&&void 0!==e?e:"")}}class kh extends sh{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;super(e,lu.Kind.Video,t,n,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>rc(this,void 0,void 0,function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(e){return void this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:e}))}const t=new Map(e.map(e=>[e.rid,e])),n=e.some(e=>"cpu"===e.qualityLimitationReason);if(n!==this.isCpuConstrained&&(this.isCpuConstrained=n,this.isCpuConstrained&&this.emit(xl.CpuConstrained)),this.prevStats){let e=0;t.forEach((t,n)=>{var i;const r=null===(i=this.prevStats)||void 0===i?void 0:i.get(n);e+=ih(t,r)}),this._currentBitrate=e}this.prevStats=t}),this.senderLock=new pr}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!Tu())return;const n=null===(t=this.sender)||void 0===t?void 0:t.getParameters();n&&(this.encodings=n.encodings),this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},nh))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return rc(this,void 0,void 0,function*(){var t,n,i,r,o;yield e.pauseUpstream.call(this);try{for(var a,s=!0,c=oc(this.simulcastCodecs.values());!(t=(a=yield c.next()).done);s=!0){r=a.value,s=!1;const e=r;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(null)}}catch(e){n={error:e}}finally{try{s||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return rc(this,void 0,void 0,function*(){var t,n,i,r,o;yield e.resumeUpstream.call(this);try{for(var a,s=!0,c=oc(this.simulcastCodecs.values());!(t=(a=yield c.next()).done);s=!0){r=a.value,s=!1;const e=r;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(e.mediaStreamTrack)}}catch(e){n={error:e}}finally{try{s||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return rc(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source!==lu.Source.Camera||this.isUserProvided||(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return rc(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source!==lu.Source.Camera||this.isUserProvided||(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return rc(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return[];const t=[],n=yield this.sender.getStats();return n.forEach(e=>{var i;if("outbound-rtp"===e.type){const r={type:"video",streamId:e.id,frameHeight:e.frameHeight,frameWidth:e.frameWidth,framesPerSecond:e.framesPerSecond,framesSent:e.framesSent,firCount:e.firCount,pliCount:e.pliCount,nackCount:e.nackCount,packetsSent:e.packetsSent,bytesSent:e.bytesSent,qualityLimitationReason:e.qualityLimitationReason,qualityLimitationDurations:e.qualityLimitationDurations,qualityLimitationResolutionChanges:e.qualityLimitationResolutionChanges,rid:null!==(i=e.rid)&&void 0!==i?i:e.id,retransmittedPacketsSent:e.retransmittedPacketsSent,targetBitrate:e.targetBitrate,timestamp:e.timestamp},o=n.get(e.remoteId);o&&(r.jitter=o.jitter,r.packetsLost=o.packetsLost,r.roundTripTime=o.roundTripTime),t.push(r)}}),t.sort((e,t)=>{var n,i;return(null!==(n=t.frameWidth)&&void 0!==n?n:0)-(null!==(i=e.frameWidth)&&void 0!==i?i:0)}),t})}setPublishingQuality(e){const t=[];for(let n=cu.LOW;n<=cu.HIGH;n+=1)t.push(new ws({quality:n,enabled:n<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(gu(this.codec),t)}restartTrack(e){return rc(this,void 0,void 0,function*(){var t,n,i,r,o;let a;if(e){const t=Xl({video:e});"boolean"!=typeof t.video&&(a=t.video)}yield this.restart(a),this.isCpuConstrained=!1;try{for(var s,c=!0,l=oc(this.simulcastCodecs.values());!(t=(s=yield l.next()).done);c=!0){r=s.value,c=!1;const e=r;e.sender&&"closed"!==(null===(o=e.sender.transport)||void 0===o?void 0:o.state)&&(e.mediaStreamTrack=this.mediaStreamTrack.clone(),yield e.sender.replaceTrack(e.mediaStreamTrack))}}catch(e){n={error:e}}finally{try{c||t||!(i=l.return)||(yield i.call(l))}finally{if(n)throw n.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return rc(this,arguments,void 0,function(e){var n=this;let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var r,o,a,s,c,l;if(yield t.setProcessor.call(n,e,i),null===(c=n.processor)||void 0===c?void 0:c.processedTrack)try{for(var u,d=!0,h=oc(n.simulcastCodecs.values());!(r=(u=yield h.next()).done);d=!0){s=u.value,d=!1;const e=s;yield null===(l=e.sender)||void 0===l?void 0:l.replaceTrack(n.processor.processedTrack)}}catch(e){o={error:e}}finally{try{d||r||!(a=h.return)||(yield a.call(h))}finally{if(o)throw o.error}}}()})}setDegradationPreference(e){return rc(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(e){this.log.warn("failed to set degradationPreference",Object.assign({error:e},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))return void this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);const n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}setSimulcastTrackSender(e,t){const n=this.simulcastCodecs.get(e);n&&(n.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},5e3))}setPublishingCodecs(e){return rc(this,void 0,void 0,function*(){var t,n,i,r,o,a,s;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(gu(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(t=!0,n=oc(e);!(r=(i=yield n.next()).done);t=!0){s=i.value,t=!1;const e=s;if(this.codec&&this.codec!==e.codec){const t=this.simulcastCodecs.get(e.codec);if(this.log.debug("try setPublishingCodec for ".concat(e.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:t})),t&&t.sender)t.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(e.codec),this.logContext),yield wh(t.sender,t.encodings,e.qualities,this.senderLock,gu(e.codec),this.log,this.logContext));else for(const t of e.qualities)if(t.enabled){c.push(e.codec);break}}else yield this.setPublishingLayers(gu(e.codec),e.qualities)}}catch(e){o={error:e}}finally{try{t||r||!(a=n.return)||(yield a.call(n))}finally{if(o)throw o.error}}return c})}setPublishingLayers(e,t){return rc(this,void 0,void 0,function*(){this.optimizeForPerformance?this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t})):(this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),this.sender&&this.encodings&&(yield wh(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext)))})}prioritizePerformance(){return rc(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const e=this.sender.getParameters();e.encodings=e.encodings.map((e,t)=>{var n;return Object.assign(Object.assign({},e),{active:0===t,scaleResolutionDownBy:Math.max(1,Math.ceil((null!==(n=this.mediaStreamTrack.getSettings().height)&&void 0!==n?n:360)/360)),scalabilityMode:0===t&&gu(this.codec)?"L1T3":void 0,maxFramerate:0===t?15:0,maxBitrate:0===t?e.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:e.encodings})),this.encodings=e.encodings,yield this.sender.setParameters(e)}catch(e){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:e})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return rc(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Su()&&this.isInBackground&&this.source===lu.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function wh(e,t,n,i,r,o,a){return rc(this,void 0,void 0,function*(){const s=yield i.lock();o.debug("setPublishingLayersForSender",Object.assign(Object.assign({},a),{sender:e,qualities:n,senderEncodings:t}));try{const i=e.getParameters(),{encodings:s}=i;if(!s)return;if(s.length!==t.length)return void o.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},a),{encodings:s,senderEncodings:t}));let c=!1;if(r){n.some(e=>e.enabled)&&n.forEach(e=>e.enabled=!0)}s.forEach((e,i)=>{var r;let s=null!==(r=e.rid)&&void 0!==r?r:"";""===s&&(s="q");const l=Sh(s),u=n.find(e=>e.quality===l);u&&e.active!==u.enabled&&(c=!0,e.active=u.enabled,o.debug("setting layer ".concat(u.quality," to ").concat(e.active?"enabled":"disabled"),a),yu()&&(u.enabled?(e.scaleResolutionDownBy=t[i].scaleResolutionDownBy,e.maxBitrate=t[i].maxBitrate,e.maxFrameRate=t[i].maxFrameRate):(e.scaleResolutionDownBy=4,e.maxBitrate=10,e.maxFrameRate=2)))}),c&&(i.encodings=s,o.debug("setting encodings",Object.assign(Object.assign({},a),{encodings:i.encodings})),yield e.setParameters(i))}finally{s()}})}function Sh(e){switch(e){case"f":default:return cu.HIGH;case"h":return cu.MEDIUM;case"q":return cu.LOW}}function Th(e,t,n,i){if(!n)return[new ha({quality:cu.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(i){const i=n[0].scalabilityMode,r=new bh(i),o=[],a="h"==r.suffix?1.5:2,s="h"==r.suffix?2:3;for(let i=0;i<r.spatial;i+=1)o.push(new ha({quality:Math.min(cu.HIGH,r.spatial-1)-i,width:Math.ceil(e/Math.pow(a,i)),height:Math.ceil(t/Math.pow(a,i)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(s,i)):0,ssrc:0}));return o}return n.map(n=>{var i,r,o;const a=null!==(i=n.scaleResolutionDownBy)&&void 0!==i?i:1;let s=Sh(null!==(r=n.rid)&&void 0!==r?r:"");return new ha({quality:s,width:Math.ceil(e/a),height:Math.ceil(t/a),bitrate:null!==(o=n.maxBitrate)&&void 0!==o?o:0,ssrc:0})})}const Ch="_lossy",Eh="_reliable",Ph="leave-reconnect";var Rh,xh,_h,Oh;!function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"}(Rh||(Rh={}));class Ih extends cc.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=$d.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Rh.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Zs,this.reliableDataSequence=1,this.reliableMessageBuffer=new Sd,this.reliableReceivedState=new Td(3e4),this.lossyDataStatCurrentBytes=0,this.lossyDataStatByterate=0,this.lossyDataDropCount=0,this.midToTrackId={},this.isWaitingForNetworkReconnect=!1,this.handleDataChannel=e=>rc(this,[e],void 0,function(e){var t=this;let{channel:n}=e;return function*(){if(n){if(n.label===Eh)t.reliableDCSub=n;else{if(n.label!==Ch)return;t.lossyDCSub=n}t.log.debug("on data channel ".concat(n.id,", ").concat(n.label),t.logContext),n.onmessage=t.handleDataMessage}}()}),this.handleDataMessage=e=>rc(this,void 0,void 0,function*(){var t,n,i,r,o;const a=yield this.dataProcessLock.lock();try{let a;if(e.data instanceof ArrayBuffer)a=e.data;else{if(!(e.data instanceof Blob))return void this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:e.data}));a=yield e.data.arrayBuffer()}const s=fa.fromBinary(new Uint8Array(a));if(s.sequence>0&&""!==s.participantSid){const e=this.reliableReceivedState.get(s.participantSid);if(e&&s.sequence<=e)return;this.reliableReceivedState.set(s.participantSid,s.sequence)}if("speaker"===(null===(t=s.value)||void 0===t?void 0:t.case))this.emit(Rl.ActiveSpeakersUpdate,s.value.value.speakers);else if("encryptedPacket"===(null===(n=s.value)||void 0===n?void 0:n.case)){if(!this.e2eeManager)return void this.log.error("Received encrypted packet but E2EE not set up",this.logContext);const e=yield null===(i=this.e2eeManager)||void 0===i?void 0:i.handleEncryptedData(s.value.value.encryptedValue,s.value.value.iv,s.participantIdentity,s.value.value.keyIndex),t=va.fromBinary(e.payload),n=new fa({value:t.value,participantIdentity:s.participantIdentity,participantSid:s.participantSid});"user"===(null===(r=n.value)||void 0===r?void 0:r.case)&&Nh(n,n.value.value),this.emit(Rl.DataPacketReceived,n,s.value.value.encryptionType)}else"user"===(null===(o=s.value)||void 0===o?void 0:o.case)&&Nh(s,s.value.value),this.emit(Rl.DataPacketReceived,s,la.NONE)}finally{a()}}),this.handleDataError=e=>{const t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent&&e.error){const{error:n}=e.error;this.log.error("DataChannel error on ".concat(t,": ").concat(e.message),Object.assign(Object.assign({},this.logContext),{error:n}))}else this.log.error("Unknown DataChannel error on ".concat(t),Object.assign(Object.assign({},this.logContext),{event:e}))},this.handleBufferedAmountLow=e=>{const t=0===e.currentTarget.maxRetransmits?ma.LOSSY:ma.RELIABLE;this.updateAndEmitDCBufferStatus(t)},this.handleDisconnect=(e,t)=>{if(this._isClosed)return;this.log.warn("".concat(e," disconnected"),this.logContext),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());const n=Date.now()-this.reconnectStart;let i=this.getNextRetryDelay({elapsedMs:n,retryCount:this.reconnectAttempts});null!==i?(e===Ph&&(i=0),this.log.debug("reconnecting in ".concat(i,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Fl.setTimeout(()=>this.attemptReconnect(t).finally(()=>this.reconnectTimeout=void 0),i)):(e=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(e,"ms. giving up"),this.logContext),this.emit(Rl.Disconnected),this.close()})(n)},this.waitForRestarted=()=>new Promise((e,t)=>{this.pcState===Rh.Connected&&e();const n=()=>{this.off(Rl.Disconnected,i),e()},i=()=>{this.off(Rl.Restarted,n),t()};this.once(Rl.Restarted,n),this.once(Rl.Disconnected,i)}),this.updateAndEmitDCBufferStatus=e=>{if(e===ma.RELIABLE){const t=this.dataChannelForKind(e);t&&this.reliableMessageBuffer.alignBufferedAmount(t.bufferedAmount)}const t=this.isBufferStatusLow(e);void 0!==t&&t!==this.dcBufferStatus.get(e)&&(this.dcBufferStatus.set(e,t),this.emit(Rl.DCBufferStatusChanged,t,e))},this.isBufferStatusLow=e=>{const t=this.dataChannelForKind(e);if(t)return t.bufferedAmount<=t.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>rc(this,void 0,void 0,function*(){this.url&&(yield fetch(qu(this.url),{method:"HEAD"}).then(e=>e.ok).catch(()=>!1))&&(this.log.info("detected network reconnected"),(this.client.currentState===yd.RECONNECTING||this.isWaitingForNetworkReconnect&&this.client.currentState===yd.CONNECTED)&&(this.clearReconnectTimeout(),this.attemptReconnect(Zo.RR_SIGNAL_DISCONNECTED),this.isWaitingForNetworkReconnect=!1))}),this.handleBrowserOffline=()=>rc(this,void 0,void 0,function*(){if(this.url)try{yield Promise.race([fetch(qu(this.url),{method:"HEAD"}),pu(4e3).then(()=>Promise.reject())])}catch(e){!1===window.navigator.onLine&&(this.log.info("detected network interruption"),this.isWaitingForNetworkReconnect=!0)}}),this.log=ec(null!==(t=e.loggerName)&&void 0!==t?t:$s.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new bd(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new pr,this.dataProcessLock=new pr,this.dcBufferStatus=new Map([[ma.LOSSY,!0],[ma.RELIABLE,!0]]),this.client.onParticipantUpdate=e=>this.emit(Rl.ParticipantUpdate,e),this.client.onConnectionQuality=e=>this.emit(Rl.ConnectionQualityUpdate,e),this.client.onRoomUpdate=e=>this.emit(Rl.RoomUpdate,e),this.client.onSubscriptionError=e=>this.emit(Rl.SubscriptionError,e),this.client.onSubscriptionPermissionUpdate=e=>this.emit(Rl.SubscriptionPermissionUpdate,e),this.client.onSpeakersChanged=e=>this.emit(Rl.SpeakersChanged,e),this.client.onStreamStateUpdate=e=>this.emit(Rl.StreamStateChanged,e),this.client.onRequestResponse=e=>this.emit(Rl.SignalRequestResponse,e)}get logContext(){var e,t,n,i,r,o;return{room:null===(t=null===(e=this.latestJoinResponse)||void 0===e?void 0:e.room)||void 0===t?void 0:t.name,roomID:null===(i=null===(n=this.latestJoinResponse)||void 0===n?void 0:n.room)||void 0===i?void 0:i.sid,participant:null===(o=null===(r=this.latestJoinResponse)||void 0===r?void 0:r.participant)||void 0===o?void 0:o.identity,pID:this.participantSid}}join(e,t,n,i){return rc(this,arguments,void 0,function(e,t,n,i){var r=this;let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function*(){r.url=e,r.token=t,r.signalOpts=n,r.maxJoinAttempts=n.maxRetries;try{r.joinAttempts+=1,r.setupSignalClientCallbacks();const a=yield r.client.join(e,t,n,i,o);return r._isClosed=!1,r.latestJoinResponse=a,r.subscriberPrimary=a.subscriberPrimary,r.pcManager||(yield r.configure(a,!o)),r.subscriberPrimary&&!a.fastPublish||r.negotiate().catch(e=>{Zs.error(e,r.logContext)}),r.registerOnLineListener(),r.clientConfiguration=a.clientConfiguration,r.emit(Rl.SignalConnected,a),a}catch(a){if(a instanceof _l)if(a.reason===Sl.ServerUnreachable){if(r.log.warn("Couldn't connect to server, attempt ".concat(r.joinAttempts," of ").concat(r.maxJoinAttempts),r.logContext),r.joinAttempts<r.maxJoinAttempts)return r.join(e,t,n,i,o)}else if(a.reason===Sl.ServiceNotFound)return r.log.warn("Initial connection failed: ".concat(a.message,"  Retrying")),r.join(e,t,n,i,!0);throw a}}()})}close(){return rc(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed)e();else try{this._isClosed=!0,this.joinAttempts=0,this.emit(Rl.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.cleanupLossyDataStats(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return rc(this,void 0,void 0,function*(){var e;yield null===(e=this.pcManager)||void 0===e?void 0:e.close(),this.pcManager=void 0;const t=e=>{e&&(e.close(),e.onbufferedamountlow=null,e.onclose=null,e.onclosing=null,e.onerror=null,e.onmessage=null,e.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new Sd,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupLossyDataStats(){this.lossyDataStatByterate=0,this.lossyDataStatCurrentBytes=0,this.lossyDataStatInterval&&(clearInterval(this.lossyDataStatInterval),this.lossyDataStatInterval=void 0),this.lossyDataDropCount=0}cleanupClient(){return rc(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Il("a track with the same ID has already been published");return new Promise((t,n)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],n(_l.timeout("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:e=>{clearTimeout(i),t(e)},reject:()=>{clearTimeout(i),n(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(e){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:e}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}getConnectedServerAddress(){return rc(this,void 0,void 0,function*(){var e;return null===(e=this.pcManager)||void 0===e?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e,t){return rc(this,void 0,void 0,function*(){var n,i;if(this.pcManager&&this.pcManager.currentState!==Qd.NEW)return;this.participantSid=null===(n=e.participant)||void 0===n?void 0:n.sid;const r=this.makeRTCConfiguration(e);var o;this.pcManager=new Yd(r,t?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(Rl.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(e,t)=>{this.client.sendIceCandidate(e,t)},this.pcManager.onPublisherOffer=(e,t)=>{this.client.sendOffer(e,t)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(t,n,i)=>rc(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(t),this.logContext),["closed","disconnected","failed"].includes(n)&&(this.publisherConnectionPromise=void 0),t===Qd.CONNECTED){const t=this.pcState===Rh.New;this.pcState=Rh.Connected,t&&this.emit(Rl.Connected,e)}else t===Qd.FAILED&&(this.pcState!==Rh.Connected&&this.pcState!==Rh.Reconnecting||(this.pcState=Rh.Disconnected,this.handleDisconnect("peerconnection failed","failed"===i?Zo.RR_SUBSCRIBER_FAILED:Zo.RR_PUBLISHER_FAILED)));const r=this.client.isDisconnected||this.client.currentState===yd.RECONNECTING,o=[Qd.FAILED,Qd.CLOSING,Qd.CLOSED].includes(t);r&&o&&!this._isClosed&&this.emit(Rl.Offline)}),this.pcManager.onTrack=e=>{0!==e.streams.length&&this.emit(Rl.MediaTrackAdded,e.track,e.streams[0],e.receiver)},void 0!==(o=null===(i=e.serverInfo)||void 0===i?void 0:i.protocol)&&o>13||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,t,n)=>rc(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:n})),this.midToTrackId=n,yield this.pcManager.setPublisherAnswer(e,t))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t,n)=>rc(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;this.midToTrackId=n;const i=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);i&&this.client.sendAnswer(i,t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:null===(t=e.track)||void 0===t?void 0:t.sid})),!this.pendingTrackResolvers[e.cid])return void this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));const{resolve:n}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],n(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Rl.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(Rl.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{var t;this.token=e,null===(t=this.regionUrlProvider)||void 0===t||t.updateToken(e)},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(Rl.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Rl.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(Rl.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var t,n;const i={direction:"recvonly"};for(let n=0;n<e.numAudios;n++)null===(t=this.pcManager)||void 0===t||t.addPublisherTransceiverOfKind("audio",i);for(let t=0;t<e.numVideos;t++)null===(n=this.pcManager)||void 0===n||n.addPublisherTransceiverOfKind("video",i);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",Zo.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:null==e?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:5e3,regionSettings:e.regions})),e.action){case ds.DISCONNECT:this.emit(Rl.Disconnected,null==e?void 0:e.reason),this.close();break;case ds.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Ph);break;case ds.RESUME:this.handleDisconnect(Ph)}}}makeRTCConfiguration(e){var t;const n=Object.assign({},this.rtcConfig);if((null===(t=this.signalOpts)||void 0===t?void 0:t.e2eeEnabled)&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),n.encodedInsertableStreams=!0),e.iceServers&&!n.iceServers){const t=[];e.iceServers.forEach(e=>{const n={urls:e.urls};e.username&&(n.username=e.username),e.credential&&(n.credential=e.credential),t.push(n)}),n.iceServers=t}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Yo.ENABLED&&(n.iceTransportPolicy="relay"),n.sdpSemantics="unified-plan",n.continualGatheringPolicy="gather_continually",n}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(Ch,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Eh,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow,this.cleanupLossyDataStats(),this.lossyDataStatInterval=setInterval(()=>{this.lossyDataStatByterate=this.lossyDataStatCurrentBytes,this.lossyDataStatCurrentBytes=0;const e=this.dataChannelForKind(ma.LOSSY);if(e){const t=this.lossyDataStatByterate/10;e.bufferedAmountLowThreshold=Math.min(Math.max(t,8192),262144)}},1e3))}createSender(e,t,n){return rc(this,void 0,void 0,function*(){if(fu())return yield this.createTransceiverRTCRtpSender(e,t,n);if(mu())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Al("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,n,i){return rc(this,void 0,void 0,function*(){if(fu())return this.createSimulcastTransceiverSender(e,t,n,i);if(mu())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Al("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,n){return rc(this,void 0,void 0,function*(){if(!this.pcManager)throw new Al("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),Ju(e)&&(e.codec=t.videoCodec);const r={direction:"sendonly",streams:i};return n&&(r.sendEncodings=n),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,r)).sender})}createSimulcastTransceiverSender(e,t,n,i){return rc(this,void 0,void 0,function*(){if(!this.pcManager)throw new Al("publisher is closed");const r={direction:"sendonly"};i&&(r.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,r);if(n.videoCodec)return e.setSimulcastTrackSender(n.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return rc(this,void 0,void 0,function*(){if(!this.pcManager)throw new Al("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return rc(this,void 0,void 0,function*(){var t,n,i;if(!this._isClosed)if(this.attemptingReconnect)Zs.warn("already attempting reconnect, returning early",this.logContext);else{(null===(t=this.clientConfiguration)||void 0===t?void 0:t.resumeConnection)!==Yo.DISABLED&&(null!==(i=null===(n=this.pcManager)||void 0===n?void 0:n.currentState)&&void 0!==i?i:Qd.NEW)!==Qd.NEW||(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(e){this.reconnectAttempts+=1;let t=!0;e instanceof Al?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:e})),t=!1):e instanceof jl||(this.fullReconnectOnNext=!0),t?this.handleDisconnect("reconnect",Zo.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Rl.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(e){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:e}))}return null}restartConnection(e){return rc(this,void 0,void 0,function*(){var t,n,i;try{if(!this.url||!this.token)throw new Al("could not reconnect, url or token not saved");let n;this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Rl.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new jl;n=yield this.join(null!=e?e:this.url,this.token,this.signalOpts,void 0,!this.options.singlePeerConnection)}catch(e){if(e instanceof _l&&e.reason===Sl.NotAllowed)throw new Al("could not reconnect, token might be expired");throw new jl}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Rl.SignalRestarted,n),yield this.waitForPCReconnected(),this.client.currentState!==yd.CONNECTED)throw new jl("Signal connection got severed during reconnect");null===(t=this.regionUrlProvider)||void 0===t||t.resetAttempts(),this.emit(Rl.Restarted)}catch(e){const t=yield null===(n=this.regionUrlProvider)||void 0===n?void 0:n.getNextBestRegionUrl();if(t)return void(yield this.restartConnection(t));throw null===(i=this.regionUrlProvider)||void 0===i||i.resetAttempts(),e}})}resumeConnection(e){return rc(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new Al("could not reconnect, url or token not saved");if(!this.pcManager)throw new Al("publisher and subscriber connections unset");let n;this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Rl.Resuming);try{this.setupSignalClientCallbacks(),n=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(e){let t="";if(e instanceof Error&&(t=e.message,this.log.error(e.message,Object.assign(Object.assign({},this.logContext),{error:e}))),e instanceof _l&&e.reason===Sl.NotAllowed)throw new Al("could not reconnect, token might be expired");if(e instanceof _l&&e.reason===Sl.LeaveRequest)throw e;throw new jl(t)}if(this.emit(Rl.SignalResumed),n){const e=this.makeRTCConfiguration(n);this.pcManager.updateConfiguration(e),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=n.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==yd.CONNECTED)throw new jl("Signal connection got severed during reconnect");this.client.setReconnected(),"open"===(null===(t=this.reliableDC)||void 0===t?void 0:t.readyState)&&null===this.reliableDC.id&&this.createDataChannels(),(null==n?void 0:n.lastMessageSeq)&&this.resendReliableMessagesForResume(n.lastMessageSeq),this.emit(Rl.Resumed)})}waitForPCInitialConnection(e,t){return rc(this,void 0,void 0,function*(){if(!this.pcManager)throw new Al("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return rc(this,void 0,void 0,function*(){this.pcState=Rh.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield pu(2e3),!this.pcManager)throw new Al("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Rh.Connected}catch(e){throw this.pcState=Rh.Disconnected,_l.internal("could not establish PC connection, ".concat(e.message))}})}publishRpcResponse(e,t,n,i){return rc(this,void 0,void 0,function*(){const r=new fa({destinationIdentities:[e],kind:ma.RELIABLE,value:{case:"rpcResponse",value:new Ra({requestId:t,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:null!=n?n:""}})}});yield this.sendDataPacket(r,ma.RELIABLE)})}publishRpcAck(e,t){return rc(this,void 0,void 0,function*(){const n=new fa({destinationIdentities:[e],kind:ma.RELIABLE,value:{case:"rpcAck",value:new Pa({requestId:t})}});yield this.sendDataPacket(n,ma.RELIABLE)})}sendDataPacket(e,t){return rc(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(t),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const t=function(e){var t,n,i,r,o;if("sipDtmf"!==(null===(t=e.value)||void 0===t?void 0:t.case)&&"metrics"!==(null===(n=e.value)||void 0===n?void 0:n.case)&&"speaker"!==(null===(i=e.value)||void 0===i?void 0:i.case)&&"transcription"!==(null===(r=e.value)||void 0===r?void 0:r.case)&&"encryptedPacket"!==(null===(o=e.value)||void 0===o?void 0:o.case))return new va({value:e.value})}(e);if(t){const n=yield this.e2eeManager.encryptData(t.toBinary());e.value={case:"encryptedPacket",value:new ga({encryptedValue:n.payload,iv:n.iv,keyIndex:n.keyIndex})}}}t===ma.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const n=e.toBinary(),i=this.dataChannelForKind(t);if(i){if(t===ma.RELIABLE)yield this.waitForBufferStatusLow(t),this.reliableMessageBuffer.push({data:n,sequence:e.sequence});else{if(!this.isBufferStatusLow(t))return this.lossyDataDropCount+=1,void(this.lossyDataDropCount%100==0&&this.log.warn("dropping lossy data channel messages, total dropped: ".concat(this.lossyDataDropCount),this.logContext));this.lossyDataStatCurrentBytes+=n.byteLength}if(this.attemptingReconnect)return;i.send(n)}this.updateAndEmitDCBufferStatus(t)})}resendReliableMessagesForResume(e){return rc(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(ma.RELIABLE);const t=this.dataChannelForKind(ma.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(e=>{t.send(e.data)})),this.updateAndEmitDCBufferStatus(ma.RELIABLE)})}waitForBufferStatusLow(e){return new fl((t,n)=>rc(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const i=()=>n(new Al("engine closed"));for(this.once(Rl.Closing,i);!this.dcBufferStatus.get(e);)yield pu(10);this.off(Rl.Closing,i),t()}}))}ensureDataTransportConnected(e){return rc(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.subscriberPrimary;return function*(){var i;if(!t.pcManager)throw new Al("PC manager is closed");const r=n?t.pcManager.subscriber:t.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!r)throw _l.internal("".concat(o," connection not set"));let a=!1;n||t.dataChannelForKind(e,n)||(t.createDataChannels(),a=!0),a||n||t.pcManager.publisher.isICEConnected||"checking"===t.pcManager.publisher.getICEConnectionState()||(a=!0),a&&t.negotiate().catch(e=>{Zs.error(e,t.logContext)});const s=t.dataChannelForKind(e,n);if("open"===(null==s?void 0:s.readyState))return;const c=(new Date).getTime()+t.peerConnectionTimeout;for(;(new Date).getTime()<c;){if(r.isICEConnected&&"open"===(null===(i=t.dataChannelForKind(e,n))||void 0===i?void 0:i.readyState))return;yield pu(50)}throw _l.internal("could not establish ".concat(o," connection, state: ").concat(r.getICEConnectionState()))}()})}ensurePublisherConnected(e){return rc(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!!this.pcManager&&this.pcManager.currentState===Qd.CONNECTED&&!(!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return rc(this,void 0,void 0,function*(){return new fl((e,t)=>rc(this,void 0,void 0,function*(){if(!this.pcManager)return void t(new Dl("PC manager is closed"));this.pcManager.requirePublisher(),0!=this.pcManager.publisher.getTransceivers().length||this.lossyDC||this.reliableDC||this.createDataChannels();const n=new AbortController,i=()=>{n.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t(new Dl("cannot negotiate on closed engine")),this.on(Rl.Closing,i),this.pcManager.publisher.once(Fd,e=>{const t=new Map;e.forEach(e=>{const n=e.codec.toLowerCase();var i;i=n,Vl.includes(i)&&t.set(e.payload,n)}),this.emit(Rl.RTPVideoMapUpdate,t)});try{yield this.pcManager.negotiate(n),e()}catch(e){e instanceof Dl&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Zo.RR_UNKNOWN),e instanceof Error?t(e):t(new Error(String(e)))}finally{this.off(Rl.Closing,i)}}))})}dataChannelForKind(e,t){if(t){if(e===ma.LOSSY)return this.lossyDCSub;if(e===ma.RELIABLE)return this.reliableDCSub}else{if(e===ma.LOSSY)return this.lossyDC;if(e===ma.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var n,i,r,o;if(!this.pcManager)return void this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);const a=this.pcManager.publisher.getLocalDescription(),s=this.pcManager.publisher.getRemoteDescription(),c=null===(n=this.pcManager.subscriber)||void 0===n?void 0:n.getRemoteDescription(),l=null===(i=this.pcManager.subscriber)||void 0===i?void 0:i.getLocalDescription(),u=null===(o=null===(r=this.signalOpts)||void 0===r?void 0:r.autoSubscribe)||void 0===o||o,d=new Array,h=new Array;e.forEach(e=>{e.isDesired!==u&&d.push(e.trackSid),e.isEnabled||h.push(e.trackSid)}),this.client.sendSyncState(new _s({answer:"publisher-only"===this.pcManager.mode?s?wd({sdp:s.sdp,type:s.type}):void 0:l?wd({sdp:l.sdp,type:l.type}):void 0,offer:"publisher-only"===this.pcManager.mode?a?wd({sdp:a.sdp,type:a.type}):void 0:c?wd({sdp:c.sdp,type:c.type}):void 0,subscription:new as({trackSids:d,subscribe:!u,participantTracks:[]}),publishTracks:iu(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:h,datachannelReceiveStates:this.reliableReceivedState.map((e,t)=>new Os({publisherSid:t,lastSeq:e}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(t,n)=>{void 0!==(null==t?void 0:t.id)&&null!==t.id&&e.push(new Is({label:t.label,id:t.id,target:n}))};return t(this.dataChannelForKind(ma.LOSSY),Wa.PUBLISHER),t(this.dataChannelForKind(ma.RELIABLE),Wa.PUBLISHER),t(this.dataChannelForKind(ma.LOSSY,!0),Wa.SUBSCRIBER),t(this.dataChannelForKind(ma.RELIABLE,!0),Wa.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Fl.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Tu()&&(window.addEventListener("online",this.handleBrowserOnLine),window.addEventListener("offline",this.handleBrowserOffline))}deregisterOnLineListener(){Tu()&&(window.removeEventListener("online",this.handleBrowserOnLine),window.removeEventListener("offline",this.handleBrowserOffline))}getTrackIdForReceiver(e){var t;const n=null===(t=this.pcManager)||void 0===t?void 0:t.getMidForReceiver(e);if(n){const e=Object.entries(this.midToTrackId).find(e=>{let[t]=e;return t===n});if(e)return e[1]}}}function Nh(e,t){const n=e.participantIdentity?e.participantIdentity:t.participantIdentity;e.participantIdentity=n,t.participantIdentity=n;const i=0!==e.destinationIdentities.length?e.destinationIdentities:t.destinationIdentities;e.destinationIdentities=i,t.destinationIdentities=i}class Ah{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("number"==typeof this.totalByteSize&&0!==this.totalByteSize){if(e&&this.bytesReceived<this.totalByteSize)throw new Ul("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),Tl.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new Ul("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),Tl.LengthExceeded)}}constructor(e,t,n,i){this.reader=t,this.totalByteSize=n,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=i}}class Dh extends Ah{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const n=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,n)}[Symbol.asyncIterator](){const e=this.reader.getReader();let t=new Bu,n=null,i=null;if(this.signal){const e=this.signal;i=()=>{var n;null===(n=t.reject)||void 0===n||n.call(t,e.reason)},e.addEventListener("abort",i),n=e}const r=()=>{e.releaseLock(),n&&i&&n.removeEventListener("abort",i),this.signal=void 0};return{next:()=>rc(this,void 0,void 0,function*(){var n,i;try{const{done:r,value:o}=yield Promise.race([e.read(),t.promise,null!==(i=null===(n=this.outOfBandFailureRejectingFuture)||void 0===n?void 0:n.promise)&&void 0!==i?i:new Promise(()=>{})]);return r?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(o),{done:!1,value:o.content})}catch(e){throw r(),e}}),return(){return rc(this,void 0,void 0,function*(){return r(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return rc(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){var n,i,r,o;let a=new Set;const s=t.signal?e.withAbortSignal(t.signal):e;try{for(var c,l=!0,u=oc(s);!(n=(c=yield u.next()).done);l=!0){o=c.value,l=!1;const e=o;a.add(e)}}catch(e){i={error:e}}finally{try{l||n||!(r=u.return)||(yield r.call(u))}finally{if(i)throw i.error}}return Array.from(a)}()})}}class Lh extends Ah{constructor(e,t,n,i){super(e,t,n,i),this.receivedChunks=new Map}handleChunkReceived(e){var t;const n=Hu(e.chunkIndex),i=this.receivedChunks.get(n);if(i&&i.version>e.version)return;this.receivedChunks.set(n,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder("utf-8",{fatal:!0});let n=new Bu,i=null,r=null;if(this.signal){const e=this.signal;r=()=>{var t;null===(t=n.reject)||void 0===t||t.call(n,e.reason)},e.addEventListener("abort",r),i=e}const o=()=>{e.releaseLock(),i&&r&&i.removeEventListener("abort",r),this.signal=void 0};return{next:()=>rc(this,void 0,void 0,function*(){var i,r;try{const{done:o,value:a}=yield Promise.race([e.read(),n.promise,null!==(r=null===(i=this.outOfBandFailureRejectingFuture)||void 0===i?void 0:i.promise)&&void 0!==r?r:new Promise(()=>{})]);if(o)return this.validateBytesReceived(!0),{done:!0,value:void 0};{let e;this.handleChunkReceived(a);try{e=t.decode(a.content)}catch(e){throw new Ul("Cannot decode datastream chunk ".concat(a.chunkIndex," as text: ").concat(e),Tl.DecodeFailed)}return{done:!1,value:e}}}catch(e){throw o(),e}}),return(){return rc(this,void 0,void 0,function*(){return o(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return rc(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){var n,i,r,o;let a="";const s=t.signal?e.withAbortSignal(t.signal):e;try{for(var c,l=!0,u=oc(s);!(n=(c=yield u.next()).done);l=!0)o=c.value,l=!1,a+=o}catch(e){i={error:e}}finally{try{l||n||!(r=u.return)||(yield r.call(u))}finally{if(i)throw i.error}}return a}()})}}class Mh{constructor(){this.log=Zs,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new Ul('A text stream handler for topic "'.concat(e,'" has already been set.'),Tl.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new Ul('A byte stream handler for topic "'.concat(e,'" has already been set.'),Tl.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear()}validateParticipantHasNoActiveDataStreams(e){var t,n,i,r;const o=Array.from(this.textStreamControllers.entries()).filter(t=>t[1].sendingParticipantIdentity===e),a=Array.from(this.byteStreamControllers.entries()).filter(t=>t[1].sendingParticipantIdentity===e);if(o.length>0||a.length>0){const s=new Ul("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),Tl.AbnormalEnd);for(const[e,i]of a)null===(n=(t=i.outOfBandFailureRejectingFuture).reject)||void 0===n||n.call(t,s),this.byteStreamControllers.delete(e);for(const[e,t]of o)null===(r=(i=t.outOfBandFailureRejectingFuture).reject)||void 0===r||r.call(i,s),this.textStreamControllers.delete(e)}}handleDataStreamPacket(e,t){return rc(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,t);case"streamChunk":return this.handleStreamChunk(e.value.value,t);case"streamTrailer":return this.handleStreamTrailer(e.value.value,t);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,t,n){return rc(this,void 0,void 0,function*(){var i;if("byteHeader"===e.contentHeader.case){const r=this.byteStreamHandlers.get(e.topic);if(!r)return void this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);let o;const a=new Bu;a.promise.catch(e=>{this.log.error(e)});const s={id:e.streamId,name:null!==(i=e.contentHeader.value.name)&&void 0!==i?i:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Hu(e.timestamp),attributes:e.attributes,encryptionType:n},c=new ReadableStream({start:n=>{if(o=n,this.textStreamControllers.has(e.streamId))throw new Ul("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Tl.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:s,controller:o,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:a})}});r(new Dh(s,c,Hu(e.totalLength),a),{identity:t})}else if("textHeader"===e.contentHeader.case){const i=this.textStreamHandlers.get(e.topic);if(!i)return void this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);let r;const o=new Bu;o.promise.catch(e=>{this.log.error(e)});const a={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:n},s=new ReadableStream({start:n=>{if(r=n,this.textStreamControllers.has(e.streamId))throw new Ul("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Tl.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:a,controller:r,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:o})}});i(new Lh(a,s,Hu(e.totalLength),o),{identity:t})}})}handleStreamChunk(e,t){const n=this.byteStreamControllers.get(e.streamId);n&&(n.info.encryptionType!==t?(n.controller.error(new Ul("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(n.info.encryptionType),Tl.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&n.controller.enqueue(e));const i=this.textStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?(i.controller.error(new Ul("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Tl.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&i.controller.enqueue(e))}handleStreamTrailer(e,t){const n=this.textStreamControllers.get(e.streamId);n&&(n.info.encryptionType!==t?n.controller.error(new Ul("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(n.info.encryptionType),Tl.EncryptionTypeMismatch)):(n.info.attributes=Object.assign(Object.assign({},n.info.attributes),e.attributes),n.controller.close(),this.textStreamControllers.delete(e.streamId)));const i=this.byteStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?i.controller.error(new Ul("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Tl.EncryptionTypeMismatch)):(i.info.attributes=Object.assign(Object.assign({},i.info.attributes),e.attributes),i.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class Uh{constructor(e,t,n){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=n,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return rc(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),null===(e=this.onClose)||void 0===e||e.call(this)})}}class jh extends Uh{}class Fh extends Uh{}class Bh{constructor(e,t){this.engine=e,this.log=t}setupEngine(e){this.engine=e}sendText(e,t){return rc(this,void 0,void 0,function*(){var n;const i=crypto.randomUUID(),r=(new TextEncoder).encode(e).byteLength,o=null===(n=null==t?void 0:t.attachments)||void 0===n?void 0:n.map(()=>crypto.randomUUID()),a=new Array(o?o.length+1:1).fill(0),s=(e,n)=>{var i;a[n]=e;const r=a.reduce((e,t)=>e+t,0);null===(i=null==t?void 0:t.onProgress)||void 0===i||i.call(t,r)},c=yield this.streamText({streamId:i,totalSize:r,destinationIdentities:null==t?void 0:t.destinationIdentities,topic:null==t?void 0:t.topic,attachedStreamIds:o,attributes:null==t?void 0:t.attributes});return yield c.write(e),s(1,0),yield c.close(),(null==t?void 0:t.attachments)&&o&&(yield Promise.all(t.attachments.map((e,n)=>rc(this,void 0,void 0,function*(){return this._sendFile(o[n],e,{topic:t.topic,mimeType:e.type,onProgress:e=>{s(e,n+1)}})})))),c.info})}streamText(e){return rc(this,void 0,void 0,function*(){var t,n,i;const r=null!==(t=null==e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),o={id:r,mimeType:"text/plain",timestamp:Date.now(),topic:null!==(n=null==e?void 0:e.topic)&&void 0!==n?n:"",size:null==e?void 0:e.totalSize,attributes:null==e?void 0:e.attributes,encryptionType:(null===(i=this.engine.e2eeManager)||void 0===i?void 0:i.isDataChannelEncryptionEnabled)?la.GCM:la.NONE},a=new za({streamId:r,mimeType:o.mimeType,topic:o.topic,timestamp:Wu(o.timestamp),totalLength:Wu(null==e?void 0:e.totalSize),attributes:o.attributes,contentHeader:{case:"textHeader",value:new Fa({version:null==e?void 0:e.version,attachedStreamIds:null==e?void 0:e.attachedStreamIds,replyToStreamId:null==e?void 0:e.replyToStreamId,operationType:"update"===(null==e?void 0:e.type)?ja.UPDATE:ja.CREATE})}}),s=null==e?void 0:e.destinationIdentities,c=new fa({destinationIdentities:s,value:{case:"streamHeader",value:a}});yield this.engine.sendDataPacket(c,ma.RELIABLE);let l=0;const u=this.engine,d=new WritableStream({write(e){return rc(this,void 0,void 0,function*(){for(const t of function(e){const t=[];let n=(new TextEncoder).encode(e);for(;n.length>15e3;){let e=15e3;for(;e>0;){const t=n[e];if(void 0!==t&&128!=(192&t))break;e--}t.push(n.slice(0,e)),n=n.slice(e)}return n.length>0&&t.push(n),t}(e)){const e=new qa({content:t,streamId:r,chunkIndex:Wu(l)}),n=new fa({destinationIdentities:s,value:{case:"streamChunk",value:e}});yield u.sendDataPacket(n,ma.RELIABLE),l+=1}})},close(){return rc(this,void 0,void 0,function*(){const e=new Va({streamId:r}),t=new fa({destinationIdentities:s,value:{case:"streamTrailer",value:e}});yield u.sendDataPacket(t,ma.RELIABLE)})},abort(e){console.log("Sink error:",e)}});let h=()=>rc(this,void 0,void 0,function*(){yield p.close()});u.once(Rl.Closing,h);const p=new jh(d,o,()=>this.engine.off(Rl.Closing,h));return p})}sendFile(e,t){return rc(this,void 0,void 0,function*(){const n=crypto.randomUUID();return yield this._sendFile(n,e,t),{id:n}})}_sendFile(e,t,n){return rc(this,void 0,void 0,function*(){var i;const r=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:null!==(i=null==n?void 0:n.mimeType)&&void 0!==i?i:t.type,topic:null==n?void 0:n.topic,destinationIdentities:null==n?void 0:n.destinationIdentities}),o=t.stream().getReader();for(;;){const{done:e,value:t}=yield o.read();if(e)break;yield r.write(t)}return yield r.close(),r.info})}streamBytes(e){return rc(this,void 0,void 0,function*(){var t,n,i,r,o,a;const s=null!==(t=null==e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),c=null==e?void 0:e.destinationIdentities,l={id:s,mimeType:null!==(n=null==e?void 0:e.mimeType)&&void 0!==n?n:"application/octet-stream",topic:null!==(i=null==e?void 0:e.topic)&&void 0!==i?i:"",timestamp:Date.now(),attributes:null==e?void 0:e.attributes,size:null==e?void 0:e.totalSize,name:null!==(r=null==e?void 0:e.name)&&void 0!==r?r:"unknown",encryptionType:(null===(o=this.engine.e2eeManager)||void 0===o?void 0:o.isDataChannelEncryptionEnabled)?la.GCM:la.NONE},u=new za({totalLength:Wu(null!==(a=l.size)&&void 0!==a?a:0),mimeType:l.mimeType,streamId:s,topic:l.topic,timestamp:Wu(Date.now()),attributes:l.attributes,contentHeader:{case:"byteHeader",value:new Ba({name:l.name})}}),d=new fa({destinationIdentities:c,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(d,ma.RELIABLE);let h=0;const p=new pr,f=this.engine,m=this.log,g=new WritableStream({write(e){return rc(this,void 0,void 0,function*(){const t=yield p.lock();let n=0;try{for(;n<e.byteLength;){const t=e.slice(n,n+15e3),i=new fa({destinationIdentities:c,value:{case:"streamChunk",value:new qa({content:t,streamId:s,chunkIndex:Wu(h)})}});yield f.sendDataPacket(i,ma.RELIABLE),h+=1,n+=t.byteLength}}finally{t()}})},close(){return rc(this,void 0,void 0,function*(){const e=new Va({streamId:s}),t=new fa({destinationIdentities:c,value:{case:"streamTrailer",value:e}});yield f.sendDataPacket(t,ma.RELIABLE)})},abort(e){m.error("Sink error:",e)}});return new Fh(g,l)})}}class zh extends lu{constructor(e,t,n,i,r){super(e,n,r),this.sid=t,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?xl.Muted:xl.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=n=>{n.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(xl.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return rc(this,void 0,void 0,function*(){var e;if(null===(e=this.receiver)||void 0===e?void 0:e.getStats)return yield this.receiver.getStats()})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),nh)),"undefined"!=typeof RTCRtpReceiver&&"getSynchronizationSources"in RTCRtpReceiver&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const n=null===(t=this.receiver)||void 0===t?void 0:t.getSynchronizationSources()[0];if(n){const{timestamp:e,rtpTimestamp:t}=n;t&&this.rtpTimestamp!==t&&(this.emit(xl.TimeSyncUpdate,{timestamp:e,rtpTimestamp:t}),this.rtpTimestamp=t)}};e()}}class qh extends zh{constructor(e,t,n,i,r,o){super(e,t,lu.Kind.Audio,n,o),this.monitorReceiver=()=>rc(this,void 0,void 0,function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=ih(e,this.prevStats)),this.prevStats=e}),this.audioContext=i,this.webAudioPluginNodes=[],r&&(this.sinkId=r.deviceId)}setVolume(e){var t;for(const n of this.attachedElements)this.audioContext?null===(t=this.gainNode)||void 0===t||t.gain.setTargetAtTime(e,0,.1):n.volume=e;Cu()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Cu())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return rc(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(vu(t))return t.setSinkId(e)}))})}attach(e){const t=0===this.attachedElements.length;return e?super.attach(e):e=super.attach(),this.sinkId&&vu(e)&&e.setSinkId(this.sinkId).catch(e=>{this.log.error("Failed to set sink id on remote audio track",e,this.logContext)}),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let n=this.sourceNode;this.webAudioPluginNodes.forEach(e=>{n.connect(e),n=e}),this.gainNode=e.createGain(),n.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==e.state&&e.resume().then(()=>{"running"!==e.state&&this.emit(xl.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(e=>{this.emit(xl.AudioPlaybackFailed,e)})}disconnectWebAudio(){var e,t;null===(e=this.gainNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return rc(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach(t=>{"inbound-rtp"===t.type&&(e={type:"audio",streamId:t.id,timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})}),e})}}class Vh extends zh{constructor(e,t,n,i,r){super(e,t,lu.Kind.Video,n,r),this.elementInfos=[],this.monitorReceiver=()=>rc(this,void 0,void 0,function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=ih(e,this.prevStats)),this.prevStats=e}),this.debouncedHandleResize=Md(()=>{this.updateDimensions()},100),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}setStreamState(e){super.setStreamState(e),this.log.debug("setStreamState",e),this.isAdaptiveStream&&e===lu.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?du(this._mediaStreamTrack,t):uu(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find(t=>t.element===e)){const t=new Hh(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&void 0===this.elementInfos.find(t=>t===e)?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream)return void this.log.warn("stopObservingElementInfo ignored",this.logContext);const t=this.elementInfos.filter(t=>t===e);for(const e of t)e.stopObserving();this.elementInfos=this.elementInfos.filter(t=>t!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const e of t)this.stopObservingElement(e);return t}getDecoderImplementation(){var e;return null===(e=this.prevStats)||void 0===e?void 0:e.decoderImplementation}getReceiverStats(){return rc(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,n="",i=new Map;return e.forEach(e=>{"inbound-rtp"===e.type?(n=e.codecId,t={type:"video",streamId:e.id,framesDecoded:e.framesDecoded,framesDropped:e.framesDropped,framesReceived:e.framesReceived,packetsReceived:e.packetsReceived,packetsLost:e.packetsLost,frameWidth:e.frameWidth,frameHeight:e.frameHeight,pliCount:e.pliCount,firCount:e.firCount,nackCount:e.nackCount,jitter:e.jitter,timestamp:e.timestamp,bytesReceived:e.bytesReceived,decoderImplementation:e.decoderImplementation}):"codec"===e.type&&i.set(e.id,e)}),t&&""!==n&&i.get(n)&&(t.mimeType=i.get(n).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(t=>t.element===e);for(const e of t)this.stopObservingElementInfo(e)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return rc(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var t,n;const i=this.elementInfos.reduce((e,t)=>Math.max(e,t.visibilityChangedAt||0),0),r=!(null!==(n=null===(t=this.adaptiveStreamSettings)||void 0===t?void 0:t.pauseVideoInBackground)&&void 0!==n&&!n)&&this.isInBackground,o=this.elementInfos.some(e=>e.pictureInPicture),a=this.elementInfos.some(e=>e.visible)&&!r||o;(this.lastVisible!==a||e)&&(!a&&Date.now()-i<100?Fl.setTimeout(()=>{this.updateVisibility()},100):(this.lastVisible=a,this.emit(xl.VisibilityChanged,a,this)))}updateDimensions(){var e,t;let n=0,i=0;const r=this.getPixelDensity();for(const e of this.elementInfos){const t=e.width()*r,o=e.height()*r;t+o>n+i&&(n=t,i=o)}(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===n&&(null===(t=this.lastDimensions)||void 0===t?void 0:t.height)===i||(this.lastDimensions={width:n,height:i},this.emit(xl.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity;return"screen"===t?_u():t||(_u()>2?2:1)}}class Hh{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=e=>{var t;const{target:n,isIntersecting:i}=e;n===this.element&&(this.isIntersecting=i,this.isPiP=Wh(this.element),this.visibilityChangedAt=Date.now(),null===(t=this.handleVisibilityChanged)||void 0===t||t.call(this))},this.onEnterPiP=()=>{var e,t,n;null===(t=null===(e=window.documentPictureInPicture)||void 0===e?void 0:e.window)||void 0===t||t.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Wh(this.element),null===(n=this.handleVisibilityChanged)||void 0===n||n.call(this)},this.onLeavePiP=()=>{var e;this.isPiP=Wh(this.element),null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.element=e,this.isIntersecting=null!=t?t:Kh(e),this.isPiP=Tu()&&Wh(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,n;this.isIntersecting=Kh(this.element),this.isPiP=Wh(this.element),this.element.handleResize=()=>{var e;null===(e=this.handleResize)||void 0===e||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Mu().observe(this.element),Du().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),null===(e=window.documentPictureInPicture)||void 0===e||e.addEventListener("enter",this.onEnterPiP),null===(n=null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)||void 0===n||n.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,n,i,r;null===(e=Mu())||void 0===e||e.unobserve(this.element),null===(t=Du())||void 0===t||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),null===(n=window.documentPictureInPicture)||void 0===n||n.removeEventListener("enter",this.onEnterPiP),null===(r=null===(i=window.documentPictureInPicture)||void 0===i?void 0:i.window)||void 0===r||r.removeEventListener("pagehide",this.onLeavePiP)}}function Wh(e){var t,n;return document.pictureInPictureElement===e||!!(null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)&&Kh(e,null===(n=window.documentPictureInPicture)||void 0===n?void 0:n.window)}function Kh(e,t){const n=t||window;let i=e.offsetTop,r=e.offsetLeft;const o=e.offsetWidth,a=e.offsetHeight,{hidden:s}=e,{display:c}=getComputedStyle(e);for(;e.offsetParent;)i+=(e=e.offsetParent).offsetTop,r+=e.offsetLeft;return i<n.pageYOffset+n.innerHeight&&r<n.pageXOffset+n.innerWidth&&i+a>n.pageYOffset&&r+o>n.pageXOffset&&!s&&"none"!==c}class Gh extends cc.EventEmitter{constructor(e,t,n,i){var r;super(),this.metadataMuted=!1,this.encryption=la.NONE,this.log=Zs,this.handleMuted=()=>{this.emit(xl.Muted)},this.handleUnmuted=()=>{this.emit(xl.Unmuted)},this.log=ec(null!==(r=null==i?void 0:i.loggerName)&&void 0!==r?r:$s.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=n,this.source=lu.Source.Unknown}setTrack(e){this.track&&(this.track.off(xl.Muted,this.handleMuted),this.track.off(xl.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(xl.Muted,this.handleMuted),e.on(xl.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),ru(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get isEncrypted(){return this.encryption!==la.NONE}get audioTrack(){if(Gu(this.track))return this.track}get videoTrack(){if(Ju(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=lu.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===lu.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}!function(e){var t,n;(t=e.SubscriptionStatus||(e.SubscriptionStatus={})).Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",(n=e.PermissionStatus||(e.PermissionStatus={})).Allowed="allowed",n.NotAllowed="not_allowed"}(Gh||(Gh={}));class Jh extends Gh{get isUpstreamPaused(){var e;return null===(e=this.track)||void 0===e?void 0:e.isUpstreamPaused}constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(xl.Ended)},this.handleCpuConstrained=()=>{this.track&&Ju(this.track)&&this.emit(xl.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(n)}setTrack(e){this.track&&(this.track.off(xl.Ended,this.handleTrackEnded),this.track.off(xl.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(xl.Ended,this.handleTrackEnded),e.on(xl.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return rc(this,void 0,void 0,function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.mute()})}unmute(){return rc(this,void 0,void 0,function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.unmute()})}pauseUpstream(){return rc(this,void 0,void 0,function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.pauseUpstream()})}resumeUpstream(){return rc(this,void 0,void 0,function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Gu(this.track)){const t=this.track.getSourceTrackSettings(),n=new Set;return t.autoGainControl&&n.add(ta.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&n.add(ta.TF_ECHO_CANCELLATION),t.noiseSuppression&&n.add(ta.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&n.add(ta.TF_STEREO),(null===(e=this.options)||void 0===e?void 0:e.dtx)||n.add(ta.TF_NO_DTX),this.track.enhancedNoiseCancellation&&n.add(ta.TF_ENHANCED_NOISE_CANCELLATION),Array.from(n.values())}return[]}}function $h(e,t){return rc(this,void 0,void 0,function*(){null!=e||(e={});let n=!1;const{audioProcessor:i,videoProcessor:r,optionsWithoutProcessor:o}=ou(e);let a=o.audio,s=o.video;if(i&&"object"==typeof o.audio&&(o.audio.processor=i),r&&"object"==typeof o.video&&(o.video.processor=r),e.audio&&"object"==typeof o.audio&&"string"==typeof o.audio.deviceId){const e=o.audio.deviceId;o.audio.deviceId={exact:e},n=!0,a=Object.assign(Object.assign({},o.audio),{deviceId:{ideal:e}})}if(o.video&&"object"==typeof o.video&&"string"==typeof o.video.deviceId){const e=o.video.deviceId;o.video.deviceId={exact:e},n=!0,s=Object.assign(Object.assign({},o.video),{deviceId:{ideal:e}})}!0===o.audio?o.audio={deviceId:"default"}:"object"==typeof o.audio&&null!==o.audio&&(o.audio=Object.assign(Object.assign({},o.audio),{deviceId:o.audio.deviceId||"default"})),!0===o.video?o.video={deviceId:"default"}:"object"!=typeof o.video||o.video.deviceId||(o.video.deviceId="default");const c=Ql(o,Kd,Gd),l=Xl(c),u=navigator.mediaDevices.getUserMedia(l);o.audio&&(pd.userMediaPromiseMap.set("audioinput",u),u.catch(()=>pd.userMediaPromiseMap.delete("audioinput"))),o.video&&(pd.userMediaPromiseMap.set("videoinput",u),u.catch(()=>pd.userMediaPromiseMap.delete("videoinput")));try{const e=yield u;return yield Promise.all(e.getTracks().map(n=>rc(this,void 0,void 0,function*(){const o="audio"===n.kind;let a,s=o?c.audio:c.video;"boolean"!=typeof s&&s||(s={});const u=o?l.audio:l.video;"boolean"!=typeof u&&(a=u);const d=n.getSettings().deviceId;(null==a?void 0:a.deviceId)&&zu(a.deviceId)!==d?a.deviceId=d:a||(a={deviceId:d});const h=function(e,t,n){switch(e.kind){case"audio":return new ch(e,t,!1,void 0,n);case"video":return new kh(e,t,!1,n);default:throw new Il("unsupported track type: ".concat(e.kind))}}(n,a,t);return h.kind===lu.Kind.Video?h.source=lu.Source.Camera:h.kind===lu.Kind.Audio&&(h.source=lu.Source.Microphone),h.mediaStream=e,Gu(h)&&i?yield h.setProcessor(i):Ju(h)&&r&&(yield h.setProcessor(r)),h})))}catch(i){if(!n)throw i;return $h(Object.assign(Object.assign({},e),{audio:a,video:s}),t)}})}!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Lost="lost",e.Unknown="unknown"}(xh||(xh={}));class Qh extends cc.EventEmitter{get logContext(){var e,t;return Object.assign({},null===(t=null===(e=this.loggerOptions)||void 0===e?void 0:e.loggerContextCb)||void 0===t?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return(null===(e=this.permissions)||void 0===e?void 0:e.agent)||this.kind===sa.AGENT}get isActive(){var e;return(null===(e=this.participantInfo)||void 0===e?void 0:e.state)===aa.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,n,i,r,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:sa.STANDARD;var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=xh.Unknown,this.log=Zs,this.log=ec(null!==(s=null==o?void 0:o.loggerName)&&void 0!==s?s:$s.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=n,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=a,this._attributes=null!=r?r:{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():(this.activeFuture||(this.activeFuture=new Bu,this.once(Pl.Active,()=>{var e,t;null===(t=null===(e=this.activeFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.activeFuture=void 0})),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(lu.Source.Camera);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(lu.Source.Microphone);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(lu.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(1e3*Number.parseInt(this.participantInfo.joinedAt.toString())):new Date}updateInfo(e){var t;return!(this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version||(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===aa.ACTIVE&&(null===(t=this.participantInfo)||void 0===t?void 0:t.state)!==aa.ACTIVE&&this.emit(Pl.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,0))}_setMetadata(e){const t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(Pl.ParticipantMetadataChanged,n)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Pl.ParticipantNameChanged,e)}_setAttributes(e){const t=function(e,t){var n;void 0===e&&(e={}),void 0===t&&(t={});const i=[...Object.keys(t),...Object.keys(e)],r={};for(const o of i)e[o]!==t[o]&&(r[o]=null!==(n=t[o])&&void 0!==n?n:"");return r}(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(Pl.AttributesChanged,t)}setPermissions(e){var t,n,i,r,o,a;const s=this.permissions,c=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(n=this.permissions)||void 0===n?void 0:n.canSubscribe)||e.canPublishData!==(null===(i=this.permissions)||void 0===i?void 0:i.canPublishData)||e.hidden!==(null===(r=this.permissions)||void 0===r?void 0:r.hidden)||e.recorder!==(null===(o=this.permissions)||void 0===o?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((e,t)=>{var n;return e!==(null===(n=this.permissions)||void 0===n?void 0:n.canPublishSources[t])})||e.canSubscribeMetrics!==(null===(a=this.permissions)||void 0===a?void 0:a.canSubscribeMetrics);return this.permissions=e,c&&this.emit(Pl.ParticipantPermissionsChanged,s),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Pl.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function(e){switch(e){case Qo.EXCELLENT:return xh.Excellent;case Qo.GOOD:return xh.Good;case Qo.POOR:return xh.Poor;case Qo.LOST:return xh.Lost;default:return xh.Unknown}}(e),t!==this._connectionQuality&&this.emit(Pl.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&(null===(t=(e=this.activeFuture).reject)||void 0===t||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>Gu(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(xl.Muted,()=>{this.emit(Pl.TrackMuted,e)}),e.on(xl.Unmuted,()=>{this.emit(Pl.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case lu.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case lu.Kind.Video:this.videoTrackPublications.set(e.trackSid,e)}}}class Yh extends Qh{constructor(e,t,n,i,r,o){super(e,t,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=la.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Bu)},this.handleReconnected=()=>{var e,t;null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var e,t,n,i,r,o;this.reconnectFuture&&(this.reconnectFuture.promise.catch(e=>this.log.warn(e.message,this.logContext)),null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.reject)||void 0===t||t.call(e,new Error("Got disconnected during reconnection attempt")),this.reconnectFuture=void 0),this.signalConnectedFuture&&(null===(i=(n=this.signalConnectedFuture).reject)||void 0===i||i.call(n,new Error("Got disconnected without signal connected")),this.signalConnectedFuture=void 0),null===(o=null===(r=this.activeAgentFuture)||void 0===r?void 0:r.reject)||void 0===o||o.call(r,new Error("Got disconnected without active agent present")),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=e=>{var t,n;e.participant&&this.updateInfo(e.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Bu),null===(n=(t=this.signalConnectedFuture).resolve)||void 0===n||n.call(t)},this.handleSignalRequestResponse=e=>{const{requestId:t,reason:n,message:i}=e,r=this.pendingSignalRequests.get(t);r&&(n!==Fs.OK&&r.reject(new Ml(i,n)),this.pendingSignalRequests.delete(t))},this.handleDataPacket=e=>{switch(e.value.case){case"rpcResponse":let t=e.value.value,n=null,i=null;"payload"===t.value.case?n=t.value.value:"error"===t.value.case&&(i=Zd.fromProto(t.value.value)),this.handleIncomingRpcResponse(t.requestId,n,i);break;case"rpcAck":let r=e.value.value;this.handleIncomingRpcAck(r.requestId)}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(e=>function(e){var t,n,i;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Es({participantIdentity:null!==(t=e.participantIdentity)&&void 0!==t?t:"",participantSid:null!==(n=e.participantSid)&&void 0!==n?n:"",allTracks:null!==(i=e.allowAll)&&void 0!==i&&i,trackSids:e.allowedTrackSids||[]})}(e)))},this.onTrackUnmuted=e=>{this.onTrackMuted(e,e.isUpstreamPaused)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),ru(e)))},this.onTrackUpstreamPaused=e=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),ru(e))),this.onTrackMuted(e,!0)},this.onTrackUpstreamResumed=e=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),ru(e))),this.onTrackMuted(e,e.isMuted)},this.onTrackFeatureUpdate=e=>{const t=this.audioTrackPublications.get(e.sid);t?this.engine.client.sendUpdateLocalAudioTrack(t.trackSid,t.getTrackFeatures()):this.log.warn("Could not update local audio track settings, missing publication for track ".concat(e.sid),this.logContext)},this.onTrackCpuConstrained=(e,t)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),ru(t))),this.emit(Pl.LocalTrackCpuConstrained,e,t)},this.handleSubscribedQualityUpdate=e=>rc(this,void 0,void 0,function*(){var t,n,i,r,o;if(!(null===(o=this.roomOptions)||void 0===o?void 0:o.dynacast))return;const a=this.videoTrackPublications.get(e.trackSid);if(!a)return void this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}));if(!a.videoTrack)return;const s=yield a.videoTrack.setPublishingCodecs(e.subscribedCodecs);try{for(var c,l=!0,u=oc(s);!(t=(c=yield u.next()).done);l=!0){r=c.value,l=!1;const e=r;Hl(e)&&(this.log.debug("publish ".concat(e," for ").concat(a.videoTrack.sid),Object.assign(Object.assign({},this.logContext),ru(a))),yield this.publishAdditionalCodecForTrack(a.videoTrack,e,a.options))}}catch(e){n={error:e}}finally{try{l||t||!(i=u.return)||(yield i.call(u))}finally{if(n)throw n.error}}}),this.handleLocalTrackUnpublished=e=>{const t=this.trackPublications.get(e.trackSid);t?this.unpublishTrack(t.track):this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}))},this.handleTrackEnded=e=>rc(this,void 0,void 0,function*(){if(e.source===lu.Source.ScreenShare||e.source===lu.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),ru(e))),this.unpublishTrack(e);else if(e.isUserProvided)yield e.mute();else if(Qu(e)||$u(e))try{if(Tu())try{const t=yield null===navigator||void 0===navigator?void 0:navigator.permissions.query({name:e.source===lu.Source.Camera?"camera":"microphone"});if(t&&"denied"===t.state)throw this.log.warn("user has revoked access to ".concat(e.source),Object.assign(Object.assign({},this.logContext),ru(e))),t.onchange=()=>{"denied"!==t.state&&(e.isMuted||e.restartTrack(),t.onchange=null)},new Error("GetUserMedia Permission denied")}catch(e){}e.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),ru(e))),Qu(e)?yield e.restartTrack({deviceId:"default"}):yield e.restartTrack())}catch(t){this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),ru(e))),yield e.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=n,this.roomOptions=i,this.setupEngine(n),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=r,this.roomOutgoingDataStreamManager=o}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==la.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){var t;this.engine=e,this.engine.on(Rl.RemoteMute,(e,t)=>{const n=this.trackPublications.get(e);n&&n.track&&(t?n.mute():n.unmute())}),(null===(t=this.signalConnectedFuture)||void 0===t?void 0:t.isResolved)&&(this.signalConnectedFuture=void 0),this.engine.on(Rl.Connected,this.handleReconnected).on(Rl.SignalConnected,this.handleSignalConnected).on(Rl.SignalRestarted,this.handleReconnected).on(Rl.SignalResumed,this.handleReconnected).on(Rl.Restarting,this.handleReconnecting).on(Rl.Resuming,this.handleReconnecting).on(Rl.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Rl.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Rl.Closing,this.handleClosing).on(Rl.SignalRequestResponse,this.handleSignalRequestResponse).on(Rl.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return rc(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return rc(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return rc(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return rc(this,arguments,void 0,function(e){var t=this;let{metadata:n,name:i,attributes:r}=e;return function*(){return new fl((e,o)=>rc(t,void 0,void 0,function*(){var t,a;try{let s=!1;const c=yield this.engine.client.sendUpdateLocalMetadata(null!==(t=null!=n?n:this.metadata)&&void 0!==t?t:"",null!==(a=null!=i?i:this.name)&&void 0!==a?a:"",r),l=performance.now();for(this.pendingSignalRequests.set(c,{resolve:e,reject:e=>{o(e),s=!0},values:{name:i,metadata:n,attributes:r}});performance.now()-l<5e3&&!s;){if((!i||this.name===i)&&(!n||this.metadata===n)&&(!r||Object.entries(r).every(e=>{let[t,n]=e;return this.attributes[t]===n||""===n&&!this.attributes[t]})))return this.pendingSignalRequests.delete(c),void e();yield pu(50)}o(new Ml("Request to update local metadata timed out","TimeoutError"))}catch(e){e instanceof Error?o(e):o(new Error(String(e)))}}))}()})}setCameraEnabled(e,t,n){return this.setTrackEnabled(lu.Source.Camera,e,t,n)}setMicrophoneEnabled(e,t,n){return this.setTrackEnabled(lu.Source.Microphone,e,t,n)}setScreenShareEnabled(e,t,n){return this.setTrackEnabled(lu.Source.ScreenShare,e,t,n)}setE2EEEnabled(e){return rc(this,void 0,void 0,function*(){this.encryptionType=e?la.GCM:la.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,n,i){return rc(this,void 0,void 0,function*(){var r,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let a=this.getTrackPublication(e);if(t)if(a)yield a.unmute();else{let t;if(this.pendingPublishing.has(e)){const t=yield this.waitForPendingPublicationOfSource(e);return t||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield null==t?void 0:t.unmute(),t}this.pendingPublishing.add(e);try{switch(e){case lu.Source.Camera:t=yield this.createTracks({video:null===(r=n)||void 0===r||r});break;case lu.Source.Microphone:t=yield this.createTracks({audio:null===(o=n)||void 0===o||o});break;case lu.Source.ScreenShare:t=yield this.createScreenTracks(Object.assign({},n));break;default:throw new Il(e)}}catch(n){throw null==t||t.forEach(e=>{e.stop()}),n instanceof Error&&this.emit(Pl.MediaDevicesError,n,tu(e)),this.pendingPublishing.delete(e),n}for(const i of t){const t=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);e===lu.Source.Microphone&&Gu(i)&&t.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),i.startPreConnectBuffer())}try{const e=[];for(const n of t)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),ru(n))),e.push(this.publishTrack(n,i));const n=yield Promise.all(e);[a]=n}catch(e){throw null==t||t.forEach(e=>{e.stop()}),e}finally{this.pendingPublishing.delete(e)}}else if(!(null==a?void 0:a.track)&&this.pendingPublishing.has(e)&&(a=yield this.waitForPendingPublicationOfSource(e),a||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),a&&a.track)if(e===lu.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const e=this.getTrackPublication(lu.Source.ScreenShareAudio);e&&e.track&&this.unpublishTrack(e.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return rc(this,void 0,void 0,function*(){if(!this.pendingPublishing.has(lu.Source.Camera)&&!this.pendingPublishing.has(lu.Source.Microphone)){this.pendingPublishing.add(lu.Source.Camera),this.pendingPublishing.add(lu.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(e=>this.publishTrack(e)))}finally{this.pendingPublishing.delete(lu.Source.Camera),this.pendingPublishing.delete(lu.Source.Microphone)}}})}createTracks(e){return rc(this,void 0,void 0,function*(){var t,n;null!=e||(e={});const i=Ql(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(n=this.roomOptions)||void 0===n?void 0:n.videoCaptureDefaults);try{return(yield $h(i,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(e=>(Gu(e)&&(this.microphoneError=void 0,e.setAudioContext(this.audioContext),e.source=lu.Source.Microphone,this.emit(Pl.AudioStreamAcquired)),Ju(e)&&(this.cameraError=void 0,e.source=lu.Source.Camera),e))}catch(t){throw t instanceof Error&&(e.audio&&(this.microphoneError=t),e.video&&(this.cameraError=t)),t}})}createScreenTracks(e){return rc(this,void 0,void 0,function*(){if(void 0===e&&(e={}),void 0===navigator.mediaDevices.getDisplayMedia)throw new Ol("getDisplayMedia not supported");void 0!==e.resolution||function(){const e=vl();return"Safari"===(null==e?void 0:e.name)&&e.version.startsWith("17.")||"iOS"===(null==e?void 0:e.os)&&!!(null==e?void 0:e.osVersion)&&Ou(e.osVersion,"17")>=0}()||(e.resolution=$l.h1080fps30.resolution);const t=function(e){var t,n;let i=null===(t=e.video)||void 0===t||t;return e.resolution&&e.resolution.width>0&&e.resolution.height>0&&(i="boolean"==typeof i?{}:i,i=ku()?Object.assign(Object.assign({},i),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):Object.assign(Object.assign({},i),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:null!==(n=e.audio)&&void 0!==n&&n,video:i,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio,preferCurrentTab:e.preferCurrentTab}}(e),n=yield navigator.mediaDevices.getDisplayMedia(t),i=n.getVideoTracks();if(0===i.length)throw new Il("no video track found");const r=new kh(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});r.source=lu.Source.ScreenShare,e.contentHint&&(r.mediaStreamTrack.contentHint=e.contentHint);const o=[r];if(n.getAudioTracks().length>0){this.emit(Pl.AudioStreamAcquired);const e=new ch(n.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e.source=lu.Source.ScreenShareAudio,o.push(e)}return o})}publishTrack(e,t){return rc(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return rc(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){var r,o,a,s;let c,l;if(Qu(e)&&e.setAudioContext(n.audioContext),yield null===(r=n.reconnectFuture)||void 0===r?void 0:r.promise,n.republishPromise&&!i&&(yield n.republishPromise),Ku(e)&&n.pendingPublishPromises.has(e)&&(yield n.pendingPublishPromises.get(e)),e instanceof MediaStreamTrack)c=e.getConstraints();else{let t;switch(c=e.constraints,e.source){case lu.Source.Microphone:t="audioinput";break;case lu.Source.Camera:t="videoinput"}t&&n.activeDeviceMap.has(t)&&(c=Object.assign(Object.assign({},c),{deviceId:n.activeDeviceMap.get(t)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new ch(e,c,!0,n.audioContext,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;case"video":e=new kh(e,c,!0,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;default:throw new Il("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});if(n.trackPublications.forEach(t=>{t.track&&t.track===e&&(l=t)}),l)return n.log.warn("track has already been published, skipping",Object.assign(Object.assign({},n.logContext),ru(l))),l;const u=Object.assign(Object.assign({},n.roomOptions.publishDefaults),t),d="channelCount"in e.mediaStreamTrack.getSettings()&&2===e.mediaStreamTrack.getSettings().channelCount||2===e.mediaStreamTrack.getConstraints().channelCount,h=null!==(o=u.forceStereo)&&void 0!==o?o:d;h&&(void 0===u.dtx&&n.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},n.logContext),ru(e))),void 0===u.red&&n.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!==(a=u.dtx)&&void 0!==a||(u.dtx=!1),null!==(s=u.red)&&void 0!==s||(u.red=!1)),!function(){const e=vl(),t="17.2";if(e)return"Safari"!==e.name&&"iOS"!==e.os||!!("iOS"===e.os&&e.osVersion&&Ou(e.osVersion,t)>=0)||"Safari"===e.name&&Ou(e.version,t)>=0}()&&n.roomOptions.e2ee&&(n.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},n.logContext)),u.simulcast=!1),u.source&&(e.source=u.source);const p=new Promise((t,i)=>rc(n,void 0,void 0,function*(){try{if(this.engine.client.currentState!==yd.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:ru(e)}));let n=!1;const r=setTimeout(()=>{n=!0,e.stop(),i(new Ll("publishing rejected as engine not connected within timeout",408))},15e3);if(yield this.waitUntilEngineConnected(),clearTimeout(r),n)return;const o=yield this.publish(e,u,h);t(o)}else try{const n=yield this.publish(e,u,h);t(n)}catch(e){i(e)}}catch(e){i(e)}}));n.pendingPublishPromises.set(e,p);try{return yield p}catch(e){throw e}finally{n.pendingPublishPromises.delete(e)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Bu),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),ru(e))),!1;const{canPublish:t,canPublishSources:n}=this.permissions;return!(!t||0!==n.length&&!n.map(e=>function(e){switch(e){case Jo.CAMERA:return lu.Source.Camera;case Jo.MICROPHONE:return lu.Source.Microphone;case Jo.SCREEN_SHARE:return lu.Source.ScreenShare;case Jo.SCREEN_SHARE_AUDIO:return lu.Source.ScreenShareAudio;default:return lu.Source.Unknown}}(e)).includes(e.source))||(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),ru(e))),!1)}publish(e,t,n){return rc(this,void 0,void 0,function*(){var i,r,o,a,s,c,l,u,d,h;if(!this.hasPermissionsToPublish(e))throw new Ll("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(t=>Ku(e)&&t.source===e.source)&&e.source!==lu.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),ru(e))),t.stopMicTrackOnMute&&Gu(e)&&(e.stopOnMute=!0),e.source===lu.Source.ScreenShare&&yu()&&(t.simulcast=!1),"av1"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(ku()||yu())return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/av1"===n.mimeType.toLowerCase()){t=!0;break}return t}()||(t.videoCodec=void 0),"vp9"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(yu())return!1;if(ku()){const e=vl();if((null==e?void 0:e.version)&&Ou(e.version,"16")<0)return!1;if("iOS"===(null==e?void 0:e.os)&&(null==e?void 0:e.osVersion)&&Ou(e.osVersion,"16")<0)return!1}const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/vp9"===n.mimeType.toLowerCase()){t=!0;break}return t}()||(t.videoCodec=void 0),void 0===t.videoCodec&&(t.videoCodec=Hd),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(e=>t.videoCodec===nu(e.mime))||(t.videoCodec=nu(this.enabledPublishVideoCodecs[0].mime)));const p=t.videoCodec;e.on(xl.Muted,this.onTrackMuted),e.on(xl.Unmuted,this.onTrackUnmuted),e.on(xl.Ended,this.handleTrackEnded),e.on(xl.UpstreamPaused,this.onTrackUpstreamPaused),e.on(xl.UpstreamResumed,this.onTrackUpstreamResumed),e.on(xl.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const f=[],m=!(null===(i=t.dtx)||void 0===i||i),g=e.getSourceTrackSettings();g.autoGainControl&&f.push(ta.TF_AUTO_GAIN_CONTROL),g.echoCancellation&&f.push(ta.TF_ECHO_CANCELLATION),g.noiseSuppression&&f.push(ta.TF_NOISE_SUPPRESSION),g.channelCount&&g.channelCount>1&&f.push(ta.TF_STEREO),m&&f.push(ta.TF_NO_DTX),Qu(e)&&e.hasPreConnectBuffer&&f.push(ta.TF_PRECONNECT_BUFFER);const v=new Ya({cid:e.mediaStreamTrack.id,name:t.name,type:lu.kindToProto(e.kind),muted:e.isMuted,source:lu.sourceToProto(e.source),disableDtx:m,encryption:this.encryptionType,stereo:n,disableRed:this.isE2EEEnabled||!(null===(r=t.red)||void 0===r||r),stream:null==t?void 0:t.stream,backupCodecPolicy:null==t?void 0:t.backupCodecPolicy,audioFeatures:f});let y;if(e.kind===lu.Kind.Video){let n={width:0,height:0};try{n=yield e.waitForDimensions()}catch(t){const i=null!==(a=null===(o=this.roomOptions.videoCaptureDefaults)||void 0===o?void 0:o.resolution)&&void 0!==a?a:Gl.h720.resolution;n={width:i.width,height:i.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),ru(e)),{dims:n}))}v.width=n.width,v.height=n.height,$u(e)&&(gu(p)&&(e.source===lu.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),ru(e))))),t.scalabilityMode=null!==(s=t.scalabilityMode)&&void 0!==s?s:"L3T3_KEY"),v.simulcastCodecs=[new Qa({codec:p,cid:e.mediaStreamTrack.id})],!0===t.backupCodec&&(t.backupCodec={codec:Hd}),t.backupCodec&&p!==t.backupCodec.codec&&v.encryption===la.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),v.simulcastCodecs.push(new Qa({codec:t.backupCodec.codec,cid:""})))),y=mh(e.source===lu.Source.ScreenShare,v.width,v.height,t),v.layers=Th(v.width,v.height,y,gu(t.videoCodec))}else e.kind===lu.Kind.Audio&&(y=[{maxBitrate:null===(c=t.audioPreset)||void 0===c?void 0:c.maxBitrate,priority:null!==(u=null===(l=t.audioPreset)||void 0===l?void 0:l.priority)&&void 0!==u?u:"high",networkPriority:null!==(h=null===(d=t.audioPreset)||void 0===d?void 0:d.priority)&&void 0!==h?h:"high"}]);if(!this.engine||this.engine.isClosed)throw new Al("cannot publish track when not connected");const b=()=>rc(this,void 0,void 0,function*(){var n,i,r;if(!this.engine.pcManager)throw new Al("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,y),this.emit(Pl.LocalSenderCreated,e.sender,e),$u(e)&&(null!==(n=t.degradationPreference)&&void 0!==n||(t.degradationPreference=function(e){return e.source===lu.Source.ScreenShare||e.constraints.height&&zu(e.constraints.height)>=1080?"maintain-resolution":"balanced"}(e)),e.setDegradationPreference(t.degradationPreference)),y)if(yu()&&e.kind===lu.Kind.Audio){let t;for(const n of this.engine.pcManager.publisher.getTransceivers())if(n.sender===e.sender){t=n;break}t&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:t,codec:"opus",maxbr:(null===(i=y[0])||void 0===i?void 0:i.maxBitrate)?y[0].maxBitrate/1e3:0})}else e.codec&&gu(e.codec)&&(null===(r=y[0])||void 0===r?void 0:r.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:v.cid,codec:e.codec,maxbr:y[0].maxBitrate/1e3});yield this.engine.negotiate()});let k;const w=new Promise((t,n)=>rc(this,void 0,void 0,function*(){var i;try{k=yield this.engine.addTrack(v),t(k)}catch(t){e.sender&&(null===(i=this.engine.pcManager)||void 0===i?void 0:i.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(t=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),ru(e)),{error:t}))})),n(t)}}));if(this.enabledPublishVideoCodecs.length>0){const e=yield Promise.all([w,b()]);k=e[0]}else{let n;if(k=yield w,k.codecs.forEach(e=>{void 0===n&&(n=e.mimeType)}),n&&e.kind===lu.Kind.Video){const i=nu(n);i!==p&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),ru(e)),{codec:i})),t.videoCodec=i,y=mh(e.source===lu.Source.ScreenShare,v.width,v.height,t))}yield b()}const S=new Jh(e.kind,k,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(S.on(xl.CpuConstrained,e=>this.onTrackCpuConstrained(e,S)),S.options=t,e.sid=k.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:y,trackInfo:k})),$u(e)?e.startMonitor(this.engine.client):Qu(e)&&e.startMonitor(),this.addTrackPublication(S),this.emit(Pl.LocalTrackPublished,S),Qu(e)&&k.audioFeatures.includes(ta.TF_PRECONNECT_BUFFER)){const t=e.getPreConnectBuffer(),n=e.getPreConnectBufferMimeType();if(this.on(Pl.LocalTrackSubscribed,t=>{if(t.trackSid===k.sid){if(!e.hasPreConnectBuffer)return void this.log.warn("subscribe event came to late, buffer already closed",this.logContext);this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),ru(e))),e.stopPreConnectBuffer()}}),t){const i=new Promise((i,r)=>rc(this,void 0,void 0,function*(){var o,a,s,c,l,u;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),ru(e)));const f=setTimeout(()=>{r(new Error("agent not active within 10 seconds"))},1e4),m=yield this.waitUntilActiveAgentPresent();clearTimeout(f),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),ru(e)));const v=yield this.streamBytes({name:"preconnect-buffer",mimeType:n,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[m.identity],attributes:{trackId:S.trackSid,sampleRate:String(null!==(l=g.sampleRate)&&void 0!==l?l:"48000"),channels:String(null!==(u=g.channelCount)&&void 0!==u?u:"1")}});try{for(var d,h=!0,p=oc(t);!(o=(d=yield p.next()).done);h=!0){c=d.value,h=!1;const e=c;yield v.write(e)}}catch(e){a={error:e}}finally{try{h||o||!(s=p.return)||(yield s.call(p))}finally{if(a)throw a.error}}yield v.close(),i()}catch(e){r(e)}}));i.then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),ru(e)))}).catch(t=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),ru(e)),{error:t}))})}}return S})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,n){return rc(this,void 0,void 0,function*(){var i;if(this.encryptionType!==la.NONE)return;let r;if(this.trackPublications.forEach(t=>{t.track&&t.track===e&&(r=t)}),!r)throw new Il("track is not published");if(!$u(e))throw new Il("track is not a video track");const o=Object.assign(Object.assign({},null===(i=this.roomOptions)||void 0===i?void 0:i.publishDefaults),n),a=function(e,t,n){var i,r,o,a;if(!n.backupCodec||!0===n.backupCodec||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&Zs.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const s=e.mediaStreamTrack.getSettings(),c=null!==(i=s.width)&&void 0!==i?i:null===(r=e.dimensions)||void 0===r?void 0:r.width,l=null!==(o=s.height)&&void 0!==o?o:null===(a=e.dimensions)||void 0===a?void 0:a.height;return e.source===lu.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),mh(e.source===lu.Source.ScreenShare,c,l,n)}(e,t,o);if(!a)return void this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),ru(e)));const s=e.addSimulcastTrack(t,a);if(!s)return;const c=new Ya({cid:s.mediaStreamTrack.id,type:lu.kindToProto(e.kind),muted:e.isMuted,source:lu.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:s.mediaStreamTrack.id}]});if(c.layers=Th(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new Al("cannot publish track when not connected");const l=(yield Promise.all([this.engine.addTrack(c),(()=>rc(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,s,o,a),yield this.engine.negotiate()}))()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:l}))})}unpublishTrack(e,t){return rc(this,void 0,void 0,function*(){var n,i;if(Ku(e)){const t=this.pendingPublishPromises.get(e);t&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),ru(e))),yield t)}const r=this.getPublicationForTrack(e),o=r?ru(r):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!r||!r.track)return void this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));(e=r.track).off(xl.Muted,this.onTrackMuted),e.off(xl.Unmuted,this.onTrackUnmuted),e.off(xl.Ended,this.handleTrackEnded),e.off(xl.UpstreamPaused,this.onTrackUpstreamPaused),e.off(xl.UpstreamResumed,this.onTrackUpstreamResumed),e.off(xl.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),void 0===t&&(t=null===(i=null===(n=this.roomOptions)||void 0===n?void 0:n.stopLocalTrackOnUnpublish)||void 0===i||i),t?e.stop():e.stopMonitor();let a=!1;const s=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Qd.FAILED&&s)try{for(const e of this.engine.pcManager.publisher.getTransceivers())e.sender===s&&(e.direction="inactive",a=!0);if(this.engine.removeTrack(s)&&(a=!0),$u(e)){for(const[,t]of e.simulcastCodecs)t.sender&&(this.engine.removeTrack(t.sender)&&(a=!0),t.sender=void 0);e.simulcastCodecs.clear()}}catch(e){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:e}))}switch(this.trackPublications.delete(r.trackSid),r.kind){case lu.Kind.Audio:this.audioTrackPublications.delete(r.trackSid);break;case lu.Kind.Video:this.videoTrackPublications.delete(r.trackSid)}return this.emit(Pl.LocalTrackUnpublished,r),r.setTrack(void 0),a&&(yield this.engine.negotiate()),r})}unpublishTracks(e){return rc(this,void 0,void 0,function*(){return(yield Promise.all(e.map(e=>this.unpublishTrack(e)))).filter(e=>!!e)})}republishAllTracks(e){return rc(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){t.republishPromise&&(yield t.republishPromise),t.republishPromise=new fl((i,r)=>rc(t,void 0,void 0,function*(){try{const t=[];this.trackPublications.forEach(n=>{n.track&&(e&&(n.options=Object.assign(Object.assign({},n.options),e)),t.push(n))}),yield Promise.all(t.map(e=>rc(this,void 0,void 0,function*(){const t=e.track;yield this.unpublishTrack(t,!1),!n||t.isMuted||t.source===lu.Source.ScreenShare||t.source===lu.Source.ScreenShareAudio||!Qu(t)&&!$u(t)||t.isUserProvided||(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:e.trackSid})),yield t.restartTrack()),yield this.publishOrRepublishTrack(t,e.options,!0)}))),i()}catch(e){e instanceof Error?r(e):r(new Error(String(e)))}finally{this.republishPromise=void 0}})),yield t.republishPromise}()})}publishData(e){return rc(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const i=n.reliable?ma.RELIABLE:ma.LOSSY,r=n.destinationIdentities,o=n.topic;let a=new ka({participantIdentity:t.identity,payload:e,destinationIdentities:r,topic:o});const s=new fa({kind:i,value:{case:"user",value:a}});yield t.engine.sendDataPacket(s,i)}()})}publishDtmf(e,t){return rc(this,void 0,void 0,function*(){const n=new fa({kind:ma.RELIABLE,value:{case:"sipDtmf",value:new wa({code:e,digit:t})}});yield this.engine.sendDataPacket(n,ma.RELIABLE)})}sendChatMessage(e,t){return rc(this,void 0,void 0,function*(){const n={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:null==t?void 0:t.attachments},i=new fa({value:{case:"chatMessage",value:new Ca(Object.assign(Object.assign({},n),{timestamp:Ar.parse(n.timestamp)}))}});return yield this.engine.sendDataPacket(i,ma.RELIABLE),this.emit(Pl.ChatMessage,n),n})}editChatMessage(e,t){return rc(this,void 0,void 0,function*(){const n=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),i=new fa({value:{case:"chatMessage",value:new Ca(Object.assign(Object.assign({},n),{timestamp:Ar.parse(n.timestamp),editTimestamp:Ar.parse(n.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,ma.RELIABLE),this.emit(Pl.ChatMessage,n),n})}sendText(e,t){return rc(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,t)})}streamText(e){return rc(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,t){return rc(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,t)})}streamBytes(e){return rc(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){let{destinationIdentity:t,method:n,payload:i,responseTimeout:r=15e3}=e;return new fl((e,o)=>rc(this,void 0,void 0,function*(){var a,s,c,l;if(eh(i)>15360)return void o(Zd.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));if((null===(s=null===(a=this.engine.latestJoinResponse)||void 0===a?void 0:a.serverInfo)||void 0===s?void 0:s.version)&&Ou(null===(l=null===(c=this.engine.latestJoinResponse)||void 0===c?void 0:c.serverInfo)||void 0===l?void 0:l.version,"1.8.0")<0)return void o(Zd.builtIn("UNSUPPORTED_SERVER"));const u=Math.max(r,8e3),d=crypto.randomUUID();yield this.publishRpcRequest(t,d,n,i,u);const h=setTimeout(()=>{this.pendingAcks.delete(d),o(Zd.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(d),clearTimeout(p)},7e3);this.pendingAcks.set(d,{resolve:()=>{clearTimeout(h)},participantIdentity:t});const p=setTimeout(()=>{this.pendingResponses.delete(d),o(Zd.builtIn("RESPONSE_TIMEOUT"))},r);this.pendingResponses.set(d,{resolve:(t,n)=>{clearTimeout(p),this.pendingAcks.has(d)&&(this.log.warn("RPC response received before ack",d),this.pendingAcks.delete(d),clearTimeout(h)),n?o(n):e(null!=t?t:"")},participantIdentity:t})}))}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,n){const i=this.pendingResponses.get(e);i?(i.resolve(t,n),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,n,i,r){return rc(this,void 0,void 0,function*(){const o=new fa({destinationIdentities:[e],kind:ma.RELIABLE,value:{case:"rpcRequest",value:new Ea({id:t,method:n,payload:i,responseTimeoutMs:r,version:1})}});yield this.engine.sendDataPacket(o,ma.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:n}]of this.pendingAcks)n===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:n,resolve:i}]of this.pendingResponses)n===e&&(i(null,Zd.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(e=>"video"===e.mime.split("/")[0].toLowerCase())}updateInfo(e){return!!super.updateInfo(e)&&(e.tracks.forEach(e=>{var t,n;const i=this.trackPublications.get(e.sid);if(i){const r=i.isMuted||null!==(n=null===(t=i.track)||void 0===t?void 0:t.isUpstreamPaused)&&void 0!==n&&n;r!==e.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),ru(i)),{mutedOnServer:r})),this.engine.client.sendMuteTrack(e.sid,r))}}),!0)}setActiveAgent(e){var t,n,i,r;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?null===(n=null===(t=this.activeAgentFuture)||void 0===t?void 0:t.resolve)||void 0===n||n.call(t,e):null===(r=null===(i=this.activeAgentFuture)||void 0===i?void 0:i.reject)||void 0===r||r.call(i,new Error("Agent disconnected")),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Bu),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(n=>{const i=n.track;i&&(e instanceof MediaStreamTrack?(Qu(i)||$u(i))&&i.mediaStreamTrack===e&&(t=n):e===i&&(t=n))}),t}waitForPendingPublicationOfSource(e){return rc(this,void 0,void 0,function*(){const t=Date.now();for(;Date.now()<t+1e4;){const t=Array.from(this.pendingPublishPromises.entries()).find(t=>{let[n]=t;return n.source===e});if(t)return t[1];yield pu(20)}})}}class Xh extends Gh{constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=e=>{this.setTrack(void 0),this.emit(xl.Ended,e)},this.handleVisibilityChange=e=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(e),this.logContext),this.visible=e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{this.log.debug("adaptivestream video dimensions ".concat(e.width,"x").concat(e.height),this.logContext),this.videoDimensionsAdaptiveStream=e,this.emitTrackUpdate()},this.subscribed=n,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new as({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new _a({participantSid:"",trackSids:[this.trackSid]})]});this.emit(xl.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}get subscriptionStatus(){return!1===this.subscribed?Gh.SubscriptionStatus.Unsubscribed:super.isSubscribed?Gh.SubscriptionStatus.Subscribed:Gh.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Gh.PermissionStatus.Allowed:Gh.PermissionStatus.NotAllowed}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isDesired(){return!1!==this.subscribed}get isEnabled(){return void 0!==this.requestedDisabled?!this.requestedDisabled:!this.isAdaptiveStream||this.visible}get isLocal(){return!1}setEnabled(e){this.isManualOperationAllowed()&&this.requestedDisabled!==!e&&(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.requestedMaxQuality!==e&&(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,n;this.isManualOperationAllowed()&&((null===(t=this.requestedVideoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(n=this.requestedVideoDimensions)||void 0===n?void 0:n.height)===e.height||(Zu(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&Zu(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return null!==(e=this.requestedMaxQuality)&&void 0!==e?e:cu.HIGH}setTrack(e){const t=this.subscriptionStatus,n=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(xl.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(xl.VisibilityChanged,this.handleVisibilityChange),i.off(xl.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(xl.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(xl.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(xl.VisibilityChanged,this.handleVisibilityChange),e.on(xl.Ended,this.handleEnded),this.emit(xl.Subscribed,e)),this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(xl.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?xl.Muted:xl.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(xl.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(xl.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return!!this.isDesired||(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return Zu(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new ss({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===lu.Kind.Video){let r=this.requestedVideoDimensions;if(void 0!==this.videoDimensionsAdaptiveStream)if(r)au(this.videoDimensionsAdaptiveStream,r)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),r=this.videoDimensionsAdaptiveStream);else if(void 0!==this.requestedMaxQuality&&this.trackInfo){const e=(t=this.trackInfo,n=this.requestedMaxQuality,null===(i=t.layers)||void 0===i?void 0:i.find(e=>e.quality===n));e&&au(this.videoDimensionsAdaptiveStream,e)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),r=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),r=this.videoDimensionsAdaptiveStream;r?(e.width=Math.ceil(r.width),e.height=Math.ceil(r.height)):void 0!==this.requestedMaxQuality?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:cu.HIGH})),e.quality=cu.HIGH)}var t,n,i;this.emit(xl.UpdateSettings,e)}}class Zh extends Qh{static fromParticipantInfo(e,t,n){return new Zh(e,t.sid,t.identity,t.name,t.metadata,t.attributes,n,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,n,i,r,o,a){super(t,n||"",i,r,o,a,arguments.length>7&&void 0!==arguments[7]?arguments[7]:sa.STANDARD),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(xl.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),ru(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)}),e.on(xl.UpdateSubscription,e=>{e.participantTracks.forEach(e=>{e.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(e)}),e.on(xl.SubscriptionPermissionChanged,t=>{this.emit(Pl.TrackSubscriptionPermissionChanged,e,t)}),e.on(xl.SubscriptionStatusChanged,t=>{this.emit(Pl.TrackSubscriptionStatusChanged,e,t)}),e.on(xl.Subscribed,t=>{this.emit(Pl.TrackSubscribed,t,e)}),e.on(xl.Unsubscribed,t=>{this.emit(Pl.TrackUnsubscribed,t,e)}),e.on(xl.SubscriptionFailed,t=>{this.emit(Pl.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lu.Source.Microphone;this.volumeMap.set(t,e);const n=this.getTrackPublication(t);n&&n.track&&n.track.setVolume(e)}getVolume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lu.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,n,i,r,o){let a,s=this.getTrackPublicationBySid(t);return s||t.startsWith("TR")||this.trackPublications.forEach(t=>{s||e.kind!==t.kind.toString()||(s=t)}),s?"ended"===e.readyState?(this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),ru(s))),void this.emit(Pl.TrackSubscriptionFailed,t)):(a="video"===e.kind?new Vh(e,t,i,r):new qh(e,t,i,this.audioContext,this.audioOutput),a.source=s.source,a.isMuted=s.isMuted,a.setMediaStream(n),a.start(),s.setTrack(a),this.volumeMap.has(s.source)&&Yu(a)&&Gu(a)&&a.setVolume(this.volumeMap.get(s.source)),s):0===o?(this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),void this.emit(Pl.TrackSubscriptionFailed,t)):(void 0===o&&(o=20),void setTimeout(()=>{this.addSubscribedMediaTrack(e,t,n,i,r,o-1)},150))}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,n=new Map;return e.tracks.forEach(e=>{var i,r;let o=this.getTrackPublicationBySid(e.sid);if(o)o.updateInfo(e);else{const t=lu.kindFromProto(e.type);if(!t)return;o=new Xh(t,e,null===(i=this.signalClient.connectOptions)||void 0===i?void 0:i.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:null===(r=this.loggerOptions)||void 0===r?void 0:r.loggerName}),o.updateInfo(e),n.set(e.sid,o);const a=Array.from(this.trackPublications.values()).find(e=>e.source===(null==o?void 0:o.source));a&&o.source!==lu.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(o.source),Object.assign(Object.assign({},this.logContext),{oldTrack:ru(a),newTrack:ru(o)})),this.addTrackPublication(o)}t.set(e.sid,o)}),this.trackPublications.forEach(e=>{t.has(e.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),ru(e))),this.unpublishTrack(e.trackSid,!0))}),n.forEach(e=>{this.emit(Pl.TrackPublished,e)}),!0}unpublishTrack(e,t){const n=this.trackPublications.get(e);if(!n)return;const{track:i}=n;switch(i&&(i.stop(),n.setTrack(void 0)),this.trackPublications.delete(e),n.kind){case lu.Kind.Audio:this.audioTrackPublications.delete(e);break;case lu.Kind.Video:this.videoTrackPublications.delete(e)}t&&this.emit(Pl.TrackUnpublished,n)}setAudioOutput(e){return rc(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(n=>{var i;Gu(n.track)&&Yu(n.track)&&t.push(n.track.setSinkId(null!==(i=e.deviceId)&&void 0!==i?i:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:n})),super.emit(e,...n)}}!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting"}(_h||(_h={}));class ep extends cc.EventEmitter{get hasE2EESetup(){return void 0!==this.e2eeManager}constructor(e){var t,n,i,r,o;if(super(),t=this,this.state=_h.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Zs,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(e,t,n)=>rc(this,void 0,void 0,function*(){var i;if("undefined"==typeof RTCPeerConnection||!fu()&&!mu())throw Cu()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const r=yield this.disconnectLock.lock();if(this.state===_h.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),r(),Promise.resolve();if(this.connectFuture)return r(),this.connectFuture.promise;this.setAndEmitConnectionState(_h.Connecting),(null===(i=this.regionUrlProvider)||void 0===i?void 0:i.getServerUrl().toString())!==ed(e)&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Eu(new URL(e))&&(void 0===this.regionUrlProvider?this.regionUrlProvider=new Xd(e,t):this.regionUrlProvider.updateToken(t),this.regionUrlProvider.fetchRegionSettings().then(e=>{var t;null===(t=this.regionUrlProvider)||void 0===t||t.setServerReportedRegions(e)}).catch(e=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:e}))}));const o=(i,a,s)=>rc(this,void 0,void 0,function*(){var c,l;this.abortController&&this.abortController.abort();const u=new AbortController;this.abortController=u,null==r||r();try{if(yield dd.getInstance().getBackOffPromise(e),u.signal.aborted)throw _l.cancelled("Connection attempt aborted");yield this.attemptConnection(null!=s?s:e,t,n,u),this.abortController=void 0,i()}catch(t){if(this.regionUrlProvider&&t instanceof _l&&t.reason!==Sl.Cancelled&&t.reason!==Sl.NotAllowed){let n=null;try{this.log.debug("Fetching next region"),n=yield this.regionUrlProvider.getNextBestRegionUrl(null===(c=this.abortController)||void 0===c?void 0:c.signal)}catch(e){if(e instanceof _l&&(401===e.status||e.reason===Sl.Cancelled))return this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),void a(e)}[Sl.InternalError,Sl.ServerUnreachable,Sl.Timeout].includes(t.reason)&&(this.log.debug("Adding failed connection attempt to back off"),dd.getInstance().addFailedConnectionAttempt(e)),n&&!(null===(l=this.abortController)||void 0===l?void 0:l.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(t.message,". Retrying with another region: ").concat(n),this.logContext),this.recreateEngine(),yield o(i,a,n)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Vu(t)),a(t))}else{let e=Xo.UNKNOWN_REASON;t instanceof _l&&(e=Vu(t)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e),a(t)}}}),a=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Bu((e,t)=>{o(e,t,a)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(e,t,n,i,r,o)=>rc(this,void 0,void 0,function*(){var a,s,c;const l=yield n.join(e,t,{autoSubscribe:i.autoSubscribe,adaptiveStream:"object"==typeof r.adaptiveStream||r.adaptiveStream,maxRetries:i.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:i.websocketTimeout},o.signal,!r.singlePeerConnection);let u=l.serverInfo;if(u||(u={version:l.serverVersion,region:l.serverRegion}),this.serverInfo=u,this.log.debug("connected to Livekit Server ".concat(Object.entries(u).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join(", ")),{room:null===(a=l.room)||void 0===a?void 0:a.name,roomSid:null===(s=l.room)||void 0===s?void 0:s.sid,identity:null===(c=l.participant)||void 0===c?void 0:c.identity}),!u.version)throw new Nl("unknown server version");return"0.15.1"===u.version&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),r.dynacast=!1),l}),this.applyJoinResponse=e=>{const t=e.participant;if(this.localParticipant.sid=t.sid,this.localParticipant.identity=t.identity,this.localParticipant.setEnabledPublishCodecs(e.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(e.sifTrailer)}catch(e){this.log.error(e instanceof Error?e.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:e}))}this.handleParticipantUpdates([t,...e.otherParticipants]),e.room&&this.handleRoomUpdate(e.room)},this.attemptConnection=(e,t,n,i)=>rc(this,void 0,void 0,function*(){var r,o;this.state===_h.Reconnecting||this.isResuming||(null===(r=this.engine)||void 0===r?void 0:r.pendingReconnect)?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),(null===(o=this.regionUrlProvider)||void 0===o?void 0:o.isCloud())&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},$d),n),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const n=yield this.connectSignal(e,t,this.engine,this.connOptions,this.options,i);this.applyJoinResponse(n),this.setupLocalParticipantEvents(),this.emit(El.SignalConnected)}catch(e){yield this.engine.close(),this.recreateEngine();const t=i.signal.aborted?_l.cancelled("Signal connection aborted"):_l.serverUnreachable("could not establish signal connection");throw e instanceof Error&&(t.message="".concat(t.message,": ").concat(e.message)),e instanceof _l&&(t.reason=e.reason,t.status=e.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:e})),t}if(i.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),_l.cancelled("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,i)}catch(e){throw yield this.engine.close(),this.recreateEngine(),e}Tu()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Tu()&&window.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(_h.Connected),this.emit(El.Connected),dd.getInstance().resetFailedConnectionAttempts(e),this.registerConnectionReconcile(),this.regionUrlProvider&&this.regionUrlProvider.notifyConnected()}),this.disconnect=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return rc(t,[...n],void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i,r;const o=yield e.disconnectLock.lock();try{if(e.state===_h.Disconnected)return void e.log.debug("already disconnected",e.logContext);if(e.log.info("disconnect from room",Object.assign({},e.logContext)),e.state===_h.Connecting||e.state===_h.Reconnecting||e.isResuming){const t="Abort connection attempt due to user initiated disconnect";e.log.warn(t,e.logContext),null===(n=e.abortController)||void 0===n||n.abort(t),null===(r=null===(i=e.connectFuture)||void 0===i?void 0:i.reject)||void 0===r||r.call(i,_l.cancelled("Client initiated disconnect")),e.connectFuture=void 0}e.engine&&(e.engine.client.isDisconnected||(yield e.engine.client.sendLeave()),yield e.engine.close()),e.handleDisconnect(t,Xo.CLIENT_INITIATED),e.engine=void 0}finally{o()}}()})},this.onPageLeave=()=>rc(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>rc(this,void 0,void 0,function*(){const e=[],t=vl();if(t&&"iOS"===t.os){const t="livekit-dummy-audio-el";let n=document.getElementById(t);if(!n){n=document.createElement("audio"),n.id=t,n.autoplay=!0,n.hidden=!0;const e=Fu();e.enabled=!0;const i=new MediaStream([e]);n.srcObject=i,document.addEventListener("visibilitychange",()=>{n&&(n.srcObject=document.hidden?null:i,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(n),this.once(El.Disconnected,()=>{null==n||n.remove(),n=null})}e.push(n)}this.remoteParticipants.forEach(t=>{t.audioTrackPublications.forEach(t=>{t.track&&t.track.attachedElements.forEach(t=>{e.push(t)})})});try{yield Promise.all([this.acquireAudioContext(),...e.map(e=>(e.muted=!1,e.play()))]),this.handleAudioPlaybackStarted()}catch(e){throw this.handleAudioPlaybackFailed(e),e}}),this.startVideo=()=>rc(this,void 0,void 0,function*(){const e=[];for(const t of this.remoteParticipants.values())t.videoTrackPublications.forEach(t=>{var n;null===(n=t.track)||void 0===n||n.attachedElements.forEach(t=>{e.includes(t)||e.push(t)})});yield Promise.all(e.map(e=>e.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(e=>{"NotAllowedError"===e.name?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const e of this.remoteParticipants.values())this.handleParticipantDisconnected(e.identity,e);this.setAndEmitConnectionState(_h.Reconnecting)&&this.emit(El.Reconnecting)},this.handleSignalRestarted=e=>rc(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(e.serverRegion),Object.assign(Object.assign({},this.logContext),{region:e.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(e);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(e){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:e}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:e.serverRegion}))}catch(e){return}this.setAndEmitConnectionState(_h.Connected),this.emit(El.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=e=>{e.forEach(e=>{var t;if(e.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(e);""===e.identity&&(e.identity=null!==(t=this.sidToIdentity.get(e.sid))&&void 0!==t?t:"");let n=this.remoteParticipants.get(e.identity);e.state===aa.DISCONNECTED?this.handleParticipantDisconnected(e.identity,n):n=this.getOrCreateParticipant(e.identity,e)})},this.handleActiveSpeakersUpdate=e=>{const t=[],n={};e.forEach(e=>{if(n[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const n=this.getRemoteParticipantBySid(e.sid);n&&(n.audioLevel=e.level,n.setIsSpeaking(!0),t.push(n))}}),n[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(e=>{n[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))}),this.activeSpeakers=t,this.emitWhenConnected(El.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach(e=>{const n=this.remoteParticipants.get(e.identity);n&&n.sid!==e.sid||t.set(e.sid,e)}),e.forEach(e=>{let n=this.getRemoteParticipantBySid(e.sid);e.sid===this.localParticipant.sid&&(n=this.localParticipant),n&&(n.audioLevel=e.level,n.setIsSpeaking(e.active),e.active?t.set(e.sid,n):t.delete(e.sid))});const n=Array.from(t.values());n.sort((e,t)=>t.audioLevel-e.audioLevel),this.activeSpeakers=n,this.emitWhenConnected(El.ActiveSpeakersChanged,n)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach(e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);if(!n||!n.track)return;const i=lu.streamStateFromProto(e.state);n.track.setStreamState(i),i!==n.track.streamState&&(t.emit(Pl.TrackStreamStateChanged,n,n.track.streamState),this.emitWhenConnected(El.TrackStreamStateChanged,n,n.track.streamState,t))})},this.handleSubscriptionPermissionUpdate=e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setAllowed(e.allowed)},this.handleSubscriptionError=e=>{const t=Array.from(this.remoteParticipants.values()).find(t=>t.trackPublications.has(e.trackSid));if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setSubscriptionError(e.err)},this.handleDataPacket=(e,t)=>{const n=this.remoteParticipants.get(e.participantIdentity);if("user"===e.value.case)this.handleUserPacket(n,e.value.value,e.kind,t);else if("transcription"===e.value.case)this.handleTranscription(n,e.value.value);else if("sipDtmf"===e.value.case)this.handleSipDtmf(n,e.value.value);else if("chatMessage"===e.value.case)this.handleChatMessage(n,e.value.value);else if("metrics"===e.value.case)this.handleMetrics(e.value.value,n);else if("streamHeader"===e.value.case||"streamChunk"===e.value.case||"streamTrailer"===e.value.case)this.handleDataStream(e,t);else if("rpcRequest"===e.value.case){const t=e.value.value;this.handleIncomingRpcRequest(e.participantIdentity,t.id,t.method,t.payload,t.responseTimeoutMs,t.version)}},this.handleUserPacket=(e,t,n,i)=>{this.emit(El.DataReceived,t.payload,e,n,t.topic,i),null==e||e.emit(Pl.DataReceived,t.payload,n,i)},this.handleSipDtmf=(e,t)=>{this.emit(El.SipDTMFReceived,t,e),null==e||e.emit(Pl.SipDTMFReceived,t)},this.handleTranscription=(e,t)=>{const n=t.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(t.transcribedParticipantIdentity),i=null==n?void 0:n.trackPublications.get(t.trackId),r=function(e,t){return e.segments.map(e=>{let{id:n,text:i,language:r,startTime:o,endTime:a,final:s}=e;var c;const l=null!==(c=t.get(n))&&void 0!==c?c:Date.now(),u=Date.now();return s?t.delete(n):t.set(n,l),{id:n,text:i,startTime:Number.parseInt(o.toString()),endTime:Number.parseInt(a.toString()),final:s,language:r,firstReceivedTime:l,lastReceivedTime:u}})}(t,this.transcriptionReceivedTimes);null==i||i.emit(xl.TranscriptionReceived,r),null==n||n.emit(Pl.TranscriptionReceived,r,i),this.emit(El.TranscriptionReceived,r,n,i)},this.handleChatMessage=(e,t)=>{const n=function(e){const{id:t,timestamp:n,message:i,editTimestamp:r}=e;return{id:t,timestamp:Number.parseInt(n.toString()),editTimestamp:r?Number.parseInt(r.toString()):void 0,message:i}}(t);this.emit(El.ChatMessage,n,e)},this.handleMetrics=(e,t)=>{this.emit(El.MetricsReceived,e,t)},this.handleDataStream=(e,t)=>{this.incomingDataStreamManager.handleDataStreamPacket(e,t)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(El.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:e})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(El.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(El.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(El.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>rc(this,void 0,void 0,function*(){var e;"iOS"!==(null===(e=vl())||void 0===e?void 0:e.os)&&(yield this.selectDefaultDevices()),this.emit(El.MediaDevicesChanged)}),this.handleRoomUpdate=e=>{const t=this.roomInfo;this.roomInfo=e,t&&t.metadata!==e.metadata&&this.emitWhenConnected(El.RoomMetadataChanged,e.metadata),(null==t?void 0:t.activeRecording)!==e.activeRecording&&this.emitWhenConnected(El.RecordingStatusChanged,e.activeRecording)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach(e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.getRemoteParticipantBySid(e.participantSid);t&&t.setConnectionQuality(e.quality)})},this.onLocalParticipantMetadataChanged=e=>{this.emit(El.ParticipantMetadataChanged,e,this.localParticipant)},this.onLocalParticipantNameChanged=e=>{this.emit(El.ParticipantNameChanged,e,this.localParticipant)},this.onLocalAttributesChanged=e=>{this.emit(El.ParticipantAttributesChanged,e,this.localParticipant)},this.onLocalTrackMuted=e=>{this.emit(El.TrackMuted,e,this.localParticipant)},this.onLocalTrackUnmuted=e=>{this.emit(El.TrackUnmuted,e,this.localParticipant)},this.onTrackProcessorUpdate=e=>{var t;null===(t=null==e?void 0:e.onPublish)||void 0===t||t.call(e,this)},this.onLocalTrackPublished=e=>rc(this,void 0,void 0,function*(){var t,n,i,r,o,a;null===(t=e.track)||void 0===t||t.on(xl.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.on(xl.Restarted,this.onLocalTrackRestarted),null===(o=null===(r=null===(i=e.track)||void 0===i?void 0:i.getProcessor())||void 0===r?void 0:r.onPublish)||void 0===o||o.call(r,this),this.emit(El.LocalTrackPublished,e,this.localParticipant),Qu(e.track)&&(yield e.track.checkForSilence())&&this.emit(El.LocalAudioSilenceDetected,e);const s=yield null===(a=e.track)||void 0===a?void 0:a.getDeviceId(!1),c=tu(e.source);c&&s&&s!==this.localParticipant.activeDeviceMap.get(c)&&(this.localParticipant.activeDeviceMap.set(c,s),this.emit(El.ActiveDeviceChanged,c,s))}),this.onLocalTrackUnpublished=e=>{var t,n;null===(t=e.track)||void 0===t||t.off(xl.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.off(xl.Restarted,this.onLocalTrackRestarted),this.emit(El.LocalTrackUnpublished,e,this.localParticipant)},this.onLocalTrackRestarted=e=>rc(this,void 0,void 0,function*(){const t=yield e.getDeviceId(!1),n=tu(e.source);n&&t&&t!==this.localParticipant.activeDeviceMap.get(n)&&(this.log.debug("local track restarted, setting ".concat(n," ").concat(t," active"),this.logContext),this.localParticipant.activeDeviceMap.set(n,t),this.emit(El.ActiveDeviceChanged,n,t))}),this.onLocalConnectionQualityChanged=e=>{this.emit(El.ConnectionQualityChanged,e,this.localParticipant)},this.onMediaDevicesError=(e,t)=>{this.emit(El.MediaDevicesError,e,t)},this.onLocalParticipantPermissionsChanged=e=>{this.emit(El.ParticipantPermissionsChanged,e,this.localParticipant)},this.onLocalChatMessageSent=e=>{this.emit(El.ChatMessage,e,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},Jd),e),this.log=ec(null!==(n=this.options.loggerName)&&void 0!==n?n:$s.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},Kd),null==e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},Gd),null==e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Wd),null==e?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new Mh,this.outgoingDataStreamManager=new Bh(this.engine,this.log),this.disconnectLock=new pr,this.localParticipant=new Yh("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",zu(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",zu(this.options.audioCaptureDefaults.deviceId)),(null===(i=this.options.audioOutput)||void 0===i?void 0:i.deviceId)&&this.switchActiveDevice("audiooutput",zu(this.options.audioOutput.deviceId)).catch(e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext)),Tu()){const e=new AbortController;null===(o=null===(r=navigator.mediaDevices)||void 0===r?void 0:r.addEventListener)||void 0===o||o.call(r,"devicechange",this.handleDeviceChange,{signal:e.signal}),ep.cleanupRegistry&&ep.cleanupRegistry.register(this,()=>{e.abort()})}}registerTextStreamHandler(e,t){return this.incomingDataStreamManager.registerTextStreamHandler(e,t)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,t){return this.incomingDataStreamManager.registerByteStreamHandler(e,t)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return rc(this,void 0,void 0,function*(){if(!this.e2eeManager)throw Error("e2ee not configured, please set e2ee settings within the room options");yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),""!==this.localParticipant.identity&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity)})}setupE2EE(){var e;const t=!!this.options.encryption,n=this.options.encryption||this.options.e2ee;n&&("e2eeManager"in n?(this.e2eeManager=n.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=t):this.e2eeManager=new ud(n,t),this.e2eeManager.on(ad.ParticipantEncryptionStatusChanged,(e,t)=>{t.isLocal&&(this.isE2EEEnabled=e),this.emit(El.ParticipantEncryptionStatusChanged,e,t)}),this.e2eeManager.on(ad.EncryptionError,(e,t)=>{const n=t?this.getParticipantByIdentity(t):void 0;this.emit(El.EncryptionError,e,n)}),null===(e=this.e2eeManager)||void 0===e||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:null===(e=this.roomInfo)||void 0===e?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.activeRecording)&&void 0!==t&&t}getSid(){return this.state===_h.Disconnected?fl.resolve(""):this.roomInfo&&""!==this.roomInfo.sid?fl.resolve(this.roomInfo.sid):new fl((e,t)=>{const n=t=>{""!==t.sid&&(this.engine.off(Rl.RoomUpdate,n),e(t.sid))};this.engine.on(Rl.RoomUpdate,n),this.once(El.Disconnected,()=>{this.engine.off(Rl.RoomUpdate,n),t(new Al("Room disconnected before room server id was available"))})})}get name(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.name)&&void 0!==t?t:""}get metadata(){var e;return null===(e=this.roomInfo)||void 0===e?void 0:e.metadata}get numParticipants(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numParticipants)&&void 0!==t?t:0}get numPublishers(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numPublishers)&&void 0!==t?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new Ih(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(Rl.ParticipantUpdate,this.handleParticipantUpdates).on(Rl.RoomUpdate,this.handleRoomUpdate).on(Rl.SpeakersChanged,this.handleSpeakersChanged).on(Rl.StreamStateChanged,this.handleStreamStateUpdate).on(Rl.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Rl.SubscriptionError,this.handleSubscriptionError).on(Rl.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Rl.MediaTrackAdded,(e,t,n)=>{this.onTrackAdded(e,t,n)}).on(Rl.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Rl.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Rl.DataPacketReceived,this.handleDataPacket).on(Rl.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(_h.SignalReconnecting)&&this.emit(El.SignalReconnecting)}).on(Rl.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(_h.Connected)&&this.emit(El.Reconnected)}).on(Rl.SignalResumed,()=>{this.bufferedEvents=[],(this.state===_h.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(Rl.Restarting,this.handleRestarting).on(Rl.SignalRestarted,this.handleSignalRestarted).on(Rl.Offline,()=>{this.setAndEmitConnectionState(_h.Reconnecting)&&this.emit(El.Reconnecting)}).on(Rl.DCBufferStatusChanged,(e,t)=>{this.emit(El.DCBufferStatusChanged,e,t)}).on(Rl.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(t=>{let{trackSid:n}=t;return n===e});t?(this.localParticipant.emit(Pl.LocalTrackSubscribed,t),this.emitWhenConnected(El.LocalTrackSubscribed,t,this.localParticipant)):this.log.warn("could not find local track subscription for subscribed event",this.logContext)}).on(Rl.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((e,t)=>{this.handleParticipantDisconnected(t,e)}),this.emit(El.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return pd.getInstance().getDevices(e,t)}prepareConnection(e,t){return rc(this,void 0,void 0,function*(){if(this.state===_h.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Eu(new URL(e))&&t){this.regionUrlProvider=new Xd(e,t);const n=yield this.regionUrlProvider.getNextBestRegionUrl();n&&this.state===_h.Disconnected&&(this.regionUrl=n,yield fetch(qu(n),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(n),this.logContext))}else yield fetch(qu(e),{method:"HEAD"})}catch(e){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:e}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return rc(this,void 0,void 0,function*(){let n,i=()=>rc(this,void 0,void 0,function*(){});switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":n=new Ns({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":n=new Ns({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":n=new Ns({scenario:{case:"serverLeave",value:!0}});break;case"migration":n=new Ns({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>rc(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),n=new Ns({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>rc(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),n=new Ns({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":n=new Ns({scenario:{case:"switchCandidateProtocol",value:"force-tls"===e?2:1}}),i=()=>rc(this,void 0,void 0,function*(){const e=this.engine.client.onLeave;e&&e(new us({reason:Xo.CLIENT_INITIATED,action:ds.RECONNECT}))});break;case"subscriber-bandwidth":if(void 0===t||"number"!=typeof t)throw new Error("subscriber-bandwidth requires a number as argument");n=new Ns({scenario:{case:"subscriberBandwidth",value:Wu(t)}});break;case"leave-full-reconnect":n=new Ns({scenario:{case:"leaveRequestFullReconnect",value:!0}})}n&&(yield this.engine.client.sendSimulateScenario(n),yield i())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return rc(this,arguments,void 0,function(e,t){var n=this;let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function*(){var r,o,a,s,c,l,u;let d=!0,h=!1;const p=i?{exact:t}:t;if("audioinput"===e){h=0===n.localParticipant.audioTrackPublications.size;const t=null!==(r=n.getActiveDevice(e))&&void 0!==r?r:n.options.audioCaptureDefaults.deviceId;n.options.audioCaptureDefaults.deviceId=p;const i=Array.from(n.localParticipant.audioTrackPublications.values()).filter(e=>e.source===lu.Source.Microphone);try{d=(yield Promise.all(i.map(e=>{var t;return null===(t=e.audioTrack)||void 0===t?void 0:t.setDeviceId(p)}))).every(e=>!0===e)}catch(e){throw n.options.audioCaptureDefaults.deviceId=t,e}const o=i.some(e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n});d&&o&&(h=!0)}else if("videoinput"===e){h=0===n.localParticipant.videoTrackPublications.size;const t=null!==(o=n.getActiveDevice(e))&&void 0!==o?o:n.options.videoCaptureDefaults.deviceId;n.options.videoCaptureDefaults.deviceId=p;const i=Array.from(n.localParticipant.videoTrackPublications.values()).filter(e=>e.source===lu.Source.Camera);try{d=(yield Promise.all(i.map(e=>{var t;return null===(t=e.videoTrack)||void 0===t?void 0:t.setDeviceId(p)}))).every(e=>!0===e)}catch(e){throw n.options.videoCaptureDefaults.deviceId=t,e}const r=i.some(e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n});d&&r&&(h=!0)}else if("audiooutput"===e){if(h=!0,!vu()&&!n.options.webAudioMix||n.options.webAudioMix&&n.audioContext&&!("setSinkId"in n.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");n.options.webAudioMix&&(t=null!==(a=yield pd.getInstance().normalizeDeviceId("audiooutput",t))&&void 0!==a?a:""),null!==(s=(u=n.options).audioOutput)&&void 0!==s||(u.audioOutput={});const i=null!==(c=n.getActiveDevice(e))&&void 0!==c?c:n.options.audioOutput.deviceId;n.options.audioOutput.deviceId=t;try{n.options.webAudioMix&&(null===(l=n.audioContext)||void 0===l||l.setSinkId(t)),yield Promise.all(Array.from(n.remoteParticipants.values()).map(e=>e.setAudioOutput({deviceId:t})))}catch(e){throw n.options.audioOutput.deviceId=i,e}}return h&&(n.localParticipant.activeDeviceMap.set(e,t),n.emit(El.ActiveDeviceChanged,e,t)),d}()})}setupLocalParticipantEvents(){this.localParticipant.on(Pl.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Pl.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Pl.AttributesChanged,this.onLocalAttributesChanged).on(Pl.TrackMuted,this.onLocalTrackMuted).on(Pl.TrackUnmuted,this.onLocalTrackUnmuted).on(Pl.LocalTrackPublished,this.onLocalTrackPublished).on(Pl.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Pl.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Pl.MediaDevicesError,this.onMediaDevicesError).on(Pl.AudioStreamAcquired,this.startAudio).on(Pl.ChatMessage,this.onLocalChatMessageSent).on(Pl.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;null===(e=this.engine)||void 0===e||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,n){if(this.state===_h.Connecting||this.state===_h.Reconnecting){const i=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:t.id,tracksInStream:t.getTracks().map(e=>e.id)}),this.onTrackAdded(e,t,n),r()},r=()=>{this.off(El.Reconnected,i),this.off(El.Connected,i),this.off(El.Disconnected,r)};return this.once(El.Reconnected,i),this.once(El.Connected,i),void this.once(El.Disconnected,r)}if(this.state===_h.Disconnected)return void this.log.warn("skipping incoming track after Room disconnected",this.logContext);if("ended"===e.readyState)return void this.log.info("skipping incoming track as it already ended",this.logContext);const i=function(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}(t.id),r=i[0];let o=i[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),r===this.localParticipant.sid)return void this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);const s=Array.from(this.remoteParticipants.values()).find(e=>e.sid===r);if(!s)return void this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(r),this.logContext);if(!a.startsWith("TR")){const e=this.engine.getTrackIdForReceiver(n);if(!e)return void this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(r),this.logContext);a=e}let c;a.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(r,", streamId: ").concat(o,", trackId: ").concat(a),Object.assign(Object.assign({},this.logContext),{rpID:r,streamId:o,trackId:a})),this.options.adaptiveStream&&(c="object"==typeof this.options.adaptiveStream?this.options.adaptiveStream:{});const l=s.addSubscribedMediaTrack(e,a,t,n,c);(null==l?void 0:l.isEncrypted)&&!this.e2eeManager&&this.emit(El.EncryptionError,new Error("Encrypted ".concat(l.source," track received from participant ").concat(s.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;var n,i;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearControllers(),this.state!==_h.Disconnected){this.regionUrl=void 0,this.regionUrlProvider&&this.regionUrlProvider.notifyDisconnected();try{this.remoteParticipants.forEach(e=>{e.trackPublications.forEach(t=>{e.unpublishTrack(t.trackSid)})}),this.localParticipant.trackPublications.forEach(t=>{var n,i,r;t.track&&this.localParticipant.unpublishTrack(t.track,e),e?(null===(n=t.track)||void 0===n||n.detach(),null===(i=t.track)||void 0===i||i.stop()):null===(r=t.track)||void 0===r||r.stopMonitor()}),this.localParticipant.off(Pl.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Pl.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Pl.AttributesChanged,this.onLocalAttributesChanged).off(Pl.TrackMuted,this.onLocalTrackMuted).off(Pl.TrackUnmuted,this.onLocalTrackUnmuted).off(Pl.LocalTrackPublished,this.onLocalTrackPublished).off(Pl.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Pl.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Pl.MediaDevicesError,this.onMediaDevicesError).off(Pl.AudioStreamAcquired,this.startAudio).off(Pl.ChatMessage,this.onLocalChatMessageSent).off(Pl.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&"boolean"==typeof this.options.webAudioMix&&(this.audioContext.close(),this.audioContext=void 0),Tu()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),null===(i=null===(n=navigator.mediaDevices)||void 0===n?void 0:n.removeEventListener)||void 0===i||i.call(n,"devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(_h.Disconnected),this.emit(El.Disconnected,t)}}}handleParticipantDisconnected(e,t){var n;this.remoteParticipants.delete(e),t&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),t.trackPublications.forEach(e=>{t.unpublishTrack(e.trackSid,!0)}),this.emit(El.ParticipantDisconnected,t),t.setDisconnected(),null===(n=this.localParticipant)||void 0===n||n.handleParticipantDisconnected(t.identity))}handleIncomingRpcRequest(e,t,n,i,r,o){return rc(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),1!==o)return void(yield this.engine.publishRpcResponse(e,t,null,Zd.builtIn("UNSUPPORTED_VERSION")));const a=this.rpcHandlers.get(n);if(!a)return void(yield this.engine.publishRpcResponse(e,t,null,Zd.builtIn("UNSUPPORTED_METHOD")));let s=null,c=null;try{const o=yield a({requestId:t,callerIdentity:e,payload:i,responseTimeout:r});eh(o)>15360?(s=Zd.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),this.log.warn("RPC Response payload too large for ".concat(n))):c=o}catch(e){e instanceof Zd?s=e:(this.log.warn("Uncaught error returned by RPC handler for ".concat(n,". Returning APPLICATION_ERROR instead."),e),s=Zd.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,c,s)})}selectDefaultDevices(){return rc(this,void 0,void 0,function*(){var e,t,n;const i=pd.getInstance().previousDevices,r=yield pd.getInstance().getDevices(void 0,!1),o=vl();if("Chrome"===(null==o?void 0:o.name)&&"iOS"!==o.os)for(let e of r){const t=i.find(t=>t.deviceId===e.deviceId);t&&""!==t.label&&t.kind===e.kind&&t.label!==e.label&&"default"===this.getActiveDevice(e.kind)&&this.emit(El.ActiveDeviceChanged,e.kind,e.deviceId)}const a=["audiooutput","audioinput","videoinput"];for(let o of a){const a=eu(o),s=this.localParticipant.getTrackPublication(a);if(s&&(null===(e=s.track)||void 0===e?void 0:e.isUserProvided))continue;const c=r.filter(e=>e.kind===o),l=this.getActiveDevice(o);l===(null===(t=i.filter(e=>e.kind===o)[0])||void 0===t?void 0:t.deviceId)&&c.length>0&&(null===(n=c[0])||void 0===n?void 0:n.deviceId)!==l?yield this.switchActiveDevice(o,c[0].deviceId):"audioinput"===o&&!wu()||"videoinput"===o||!(c.length>0)||c.find(e=>e.deviceId===this.getActiveDevice(o))||"audiooutput"===o&&wu()||(yield this.switchActiveDevice(o,c[0].deviceId))}})}acquireAudioContext(){return rc(this,void 0,void 0,function*(){var e,t;if("boolean"!=typeof this.options.webAudioMix&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:this.audioContext&&"closed"!==this.audioContext.state||(this.audioContext=null!==(e=Zl())&&void 0!==e?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(e=>e.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&"suspended"===this.audioContext.state)try{yield Promise.race([this.audioContext.resume(),pu(200)])}catch(e){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:e}))}const n="running"===(null===(t=this.audioContext)||void 0===t?void 0:t.state);n!==this.canPlaybackAudio&&(this.audioEnabled=n,this.emit(El.AudioPlaybackStatusChanged,n))})}createParticipant(e,t){var n;let i;return i=t?Zh.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):new Zh(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),(null===(n=this.options.audioOutput)||void 0===n?void 0:n.deviceId)&&i.setAudioOutput(this.options.audioOutput).catch(e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext)),i}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const n=this.remoteParticipants.get(e);return t&&n.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity),n}const n=this.createParticipant(e,t);return this.remoteParticipants.set(e,n),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(El.ParticipantConnected,n),n.on(Pl.TrackPublished,e=>{this.emitWhenConnected(El.TrackPublished,e,n)}).on(Pl.TrackSubscribed,(e,t)=>{e.kind===lu.Kind.Audio?(e.on(xl.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(xl.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):e.kind===lu.Kind.Video&&(e.on(xl.VideoPlaybackFailed,this.handleVideoPlaybackFailed),e.on(xl.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(El.TrackSubscribed,e,t,n)}).on(Pl.TrackUnpublished,e=>{this.emit(El.TrackUnpublished,e,n)}).on(Pl.TrackUnsubscribed,(e,t)=>{this.emit(El.TrackUnsubscribed,e,t,n)}).on(Pl.TrackMuted,e=>{this.emitWhenConnected(El.TrackMuted,e,n)}).on(Pl.TrackUnmuted,e=>{this.emitWhenConnected(El.TrackUnmuted,e,n)}).on(Pl.ParticipantMetadataChanged,e=>{this.emitWhenConnected(El.ParticipantMetadataChanged,e,n)}).on(Pl.ParticipantNameChanged,e=>{this.emitWhenConnected(El.ParticipantNameChanged,e,n)}).on(Pl.AttributesChanged,e=>{this.emitWhenConnected(El.ParticipantAttributesChanged,e,n)}).on(Pl.ConnectionQualityChanged,e=>{this.emitWhenConnected(El.ConnectionQualityChanged,e,n)}).on(Pl.ParticipantPermissionsChanged,e=>{this.emitWhenConnected(El.ParticipantPermissionsChanged,e,n)}).on(Pl.TrackSubscriptionStatusChanged,(e,t)=>{this.emitWhenConnected(El.TrackSubscriptionStatusChanged,e,t,n)}).on(Pl.TrackSubscriptionFailed,(e,t)=>{this.emit(El.TrackSubscriptionFailed,e,n,t)}).on(Pl.TrackSubscriptionPermissionChanged,(e,t)=>{this.emitWhenConnected(El.TrackSubscriptionPermissionChanged,e,t,n)}).on(Pl.Active,()=>{this.emitWhenConnected(El.ParticipantActive,n),n.kind===sa.AGENT&&this.localParticipant.setActiveAgent(n)}),t&&n.updateInfo(t),n}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((e,t)=>(e.push(...t.getTrackPublications()),e),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&Xu(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Fl.setInterval(()=>{this.engine&&!this.engine.isClosed&&this.engine.verifyTransport()?e=0:(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Xo.STATE_MISMATCH)))},4e3)}clearConnectionReconcile(){this.connectionReconcileInterval&&Fl.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e!==this.state&&(this.state=e,this.emit(El.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,n]=e;this.emit(t,...n)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(this.state===_h.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,n]);else if(this.state===_h.Connected)return this.emit(e,...n);return!1}simulateParticipants(e){return rc(this,void 0,void 0,function*(){var t,n,i,r;const o=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),a=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new na({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ar.parse((new Date).getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new oa({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(El.SignalConnected),this.emit(El.Connected),this.setAndEmitConnectionState(_h.Connected),o.video){const e=new Jh(lu.Kind.Video,new da({source:Jo.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:Go.AUDIO,name:"video-dummy"}),new kh(o.useRealTracks&&(null===(t=window.navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia)?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:ju(160*(null!==(n=a.aspectRatios[0])&&void 0!==n?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Pl.LocalTrackPublished,e)}if(o.audio){const e=new Jh(lu.Kind.Audio,new da({source:Jo.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:Go.AUDIO}),new ch(o.useRealTracks&&(null===(i=navigator.mediaDevices)||void 0===i?void 0:i.getUserMedia)?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Fu(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Pl.LocalTrackPublished,e)}for(let e=0;e<a.count-1;e+=1){let t=new oa({sid:Math.floor(1e4*Math.random()).toString(),identity:"simulated-".concat(e),state:aa.ACTIVE,tracks:[],joinedAt:Ar.parse(Date.now())});const n=this.getOrCreateParticipant(t.identity,t);if(a.video){const i=ju(160*(null!==(r=a.aspectRatios[e%a.aspectRatios.length])&&void 0!==r?r:1),160,!1,!0),o=new da({source:Jo.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:Go.AUDIO});n.addSubscribedMediaTrack(i,o.sid,new MediaStream([i]),new RTCRtpReceiver),t.tracks=[...t.tracks,o]}if(a.audio){const e=Fu(),i=new da({source:Jo.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:Go.AUDIO});n.addSubscribedMediaTrack(e,i.sid,new MediaStream([e]),new RTCRtpReceiver),t.tracks=[...t.tracks,i]}n.updateInfo(t)}})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e!==El.ActiveSpeakersChanged&&e!==El.TranscriptionReceived){const t=tp(n).filter(e=>void 0!==e);e!==El.TrackSubscribed&&e!==El.TrackUnsubscribed||this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:t})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:t}))}return super.emit(e,...n)}}function tp(e){return e.map(e=>{if(e)return Array.isArray(e)?tp(e):"object"==typeof e?"logContext"in e?e.logContext:void 0:e})}function np(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ep.cleanupRegistry="undefined"!=typeof FinalizationRegistry&&new FinalizationRegistry(e=>{e()}),function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"}(Oh||(Oh={})),cc.EventEmitter,cc.EventEmitter,new TextEncoder,new TextDecoder;class ip extends Error{constructor(e,t){var n;super(e,t),np(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,null===(n=Error.captureStackTrace)||void 0===n||n.call(Error,this,this.constructor)}}np(ip,"code","ERR_JOSE_GENERIC"),np(class extends ip{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(e,{cause:{claim:n,reason:i,payload:t}}),np(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),np(this,"claim",void 0),np(this,"reason",void 0),np(this,"payload",void 0),this.claim=n,this.reason=i,this.payload=t}},"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),np(class extends ip{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(e,{cause:{claim:n,reason:i,payload:t}}),np(this,"code","ERR_JWT_EXPIRED"),np(this,"claim",void 0),np(this,"reason",void 0),np(this,"payload",void 0),this.claim=n,this.reason=i,this.payload=t}},"code","ERR_JWT_EXPIRED"),np(class extends ip{constructor(){super(...arguments),np(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}},"code","ERR_JOSE_ALG_NOT_ALLOWED"),np(class extends ip{constructor(){super(...arguments),np(this,"code","ERR_JOSE_NOT_SUPPORTED")}},"code","ERR_JOSE_NOT_SUPPORTED"),np(class extends ip{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"decryption operation failed",arguments.length>1?arguments[1]:void 0),np(this,"code","ERR_JWE_DECRYPTION_FAILED")}},"code","ERR_JWE_DECRYPTION_FAILED"),np(class extends ip{constructor(){super(...arguments),np(this,"code","ERR_JWE_INVALID")}},"code","ERR_JWE_INVALID"),np(class extends ip{constructor(){super(...arguments),np(this,"code","ERR_JWS_INVALID")}},"code","ERR_JWS_INVALID");np(class extends ip{constructor(){super(...arguments),np(this,"code","ERR_JWT_INVALID")}},"code","ERR_JWT_INVALID"),np(class extends ip{constructor(){super(...arguments),np(this,"code","ERR_JWK_INVALID")}},"code","ERR_JWK_INVALID"),np(class extends ip{constructor(){super(...arguments),np(this,"code","ERR_JWKS_INVALID")}},"code","ERR_JWKS_INVALID"),np(class extends ip{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no applicable key found in the JSON Web Key Set",arguments.length>1?arguments[1]:void 0),np(this,"code","ERR_JWKS_NO_MATCHING_KEY")}},"code","ERR_JWKS_NO_MATCHING_KEY"),np(class extends ip{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"multiple matching keys found in the JSON Web Key Set",arguments.length>1?arguments[1]:void 0),np(this,Symbol.asyncIterator,void 0),np(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}},"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS"),np(class extends ip{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"request timed out",arguments.length>1?arguments[1]:void 0),np(this,"code","ERR_JWKS_TIMEOUT")}},"code","ERR_JWKS_TIMEOUT"),np(class extends ip{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"signature verification failed",arguments.length>1?arguments[1]:void 0),np(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}},"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED"),new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]),Math.min,Math.max,Math.round,Math.floor;var rp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof n.g<"u"?n.g:typeof self<"u"?self:{};function op(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ap,sp={exports:{}},cp=sp.exports,lp=(ap||(ap=1,function(e){!function(t,n){e.exports?e.exports=n():t.log=n()}(cp,function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],r={},o=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch{return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(){for(var n=this.getLevel(),r=0;r<i.length;r++){var o=i[r];this[o]=r<n?e:this.methodFactory(o,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function l(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function u(i,r,o){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?s:void 0!==console[i]?a(console,i):void 0!==console.log?a(console,"log"):e)}(i)||l.apply(this,arguments)}function d(e,n){var a,s,l,d=this,h="loglevel";function p(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch{}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(h),r=n.indexOf(i+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+i.length+1))[1])}catch{}return void 0===d.levels[e]&&(e=void 0),e}}function f(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?h+=":"+e:"symbol"==typeof e&&(h=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){return l??s??a},d.setLevel=function(e,n){return l=f(e),!1!==n&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{return void(window.localStorage[h]=n)}catch{}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch{}}}(l),c.call(d)},d.setDefaultLevel=function(e){s=f(e),p()||d.setLevel(e,!1)},d.resetLevel=function(){l=null,function(){if(typeof window!==t&&h){try{window.localStorage.removeItem(h)}catch{}try{window.document.cookie=encodeURIComponent(h)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(o!==d&&(a=f(o.getLevel())),c.call(d),o===d)for(var e in r)r[e].rebuild()},a=f(o?o.getLevel():"WARN");var m=p();null!=m&&(l=f(m)),c.call(d)}(o=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=r[e];return t||(t=r[e]=new d(e,o.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=h),o},o.getLoggers=function(){return r},o.default=o,o})}(sp)),sp.exports);const up=op(lp);var dp=function(e,t){return dp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},dp(e,t)};function hp(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}dp(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function pp(e,t){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function fp(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function mp(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function gp(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function vp(e){return this instanceof vp?(this.v=e,this):new vp(e)}function yp(e){return"function"==typeof e}function bp(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var kp=bp(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}});function wp(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Sp=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,i,r;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=fp(o),s=a.next();!s.done;s=a.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else o.remove(this);var c=this.initialTeardown;if(yp(c))try{c()}catch(e){r=e instanceof kp?e.errors:[e]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var u=fp(l),d=u.next();!d.done;d=u.next()){var h=d.value;try{Ep(h)}catch(e){r=r??[],e instanceof kp?r=gp(gp([],mp(r)),mp(e.errors)):r.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}if(r)throw new kp(r)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Ep(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&wp(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&wp(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Tp=Sp.EMPTY;function Cp(e){return e instanceof Sp||e&&"closed"in e&&yp(e.remove)&&yp(e.add)&&yp(e.unsubscribe)}function Ep(e){yp(e)?e():e.unsubscribe()}function Pp(e){!function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];setTimeout.apply(void 0,gp([e,t],mp(n)))}(function(){throw e})}function Rp(){}function xp(e){e()}var _p=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Cp(t)&&t.add(n)):n.destination=Ap,n}return hp(t,e),t.create=function(e,t,n){return new Ip(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Sp),Op=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){Np(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){Np(e)}else Np(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){Np(e)}},e}(),Ip=function(e){function t(t,n,i){var r,o=e.call(this)||this;return r=yp(t)||!t?{next:t??void 0,error:n??void 0,complete:i??void 0}:t,o.destination=new Op(r),o}return hp(t,e),t}(_p);function Np(e){Pp(e)}var Ap={closed:!0,next:Rp,error:function(e){throw e},complete:Rp},Dp="function"==typeof Symbol&&Symbol.observable||"@@observable";function Lp(e){return e}var Mp=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var i=this,r=function(e){return e&&e instanceof _p||function(e){return e&&yp(e.next)&&yp(e.error)&&yp(e.complete)}(e)&&Cp(e)}(e)?e:new Ip(e,t,n);return xp(function(){var e=i,t=e.operator,n=e.source;r.add(t?t.call(r,n):n?i._subscribe(r):i._trySubscribe(r))}),r},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Up(t))(function(t,i){var r=new Ip({next:function(t){try{e(t)}catch(e){i(e),r.unsubscribe()}},error:i,complete:t});n.subscribe(r)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[Dp]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(e){return 0===e.length?Lp:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Up(e))(function(e,n){var i;t.subscribe(function(e){return i=e},function(e){return n(e)},function(){return e(i)})})},e.create=function(t){return new e(t)},e}();function Up(e){var t;return null!==(t=e??void 0)&&void 0!==t?t:Promise}function jp(e){return function(t){if(function(e){return yp(null==e?void 0:e.lift)}(t))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw new TypeError("Unable to lift unknown Observable type")}}function Fp(e,t,n,i,r){return new Bp(e,t,n,i,r)}var Bp=function(e){function t(t,n,i,r,o,a){var s=e.call(this,t)||this;return s.onFinalize=o,s.shouldUnsubscribe=a,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=r?function(e){try{r(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=i?function(){try{i()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return hp(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(_p),zp=bp(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),qp=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return hp(t,e),t.prototype.lift=function(e){var t=new Vp(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new zp},t.prototype.next=function(e){var t=this;xp(function(){var n,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var r=fp(t.currentObservers),o=r.next();!o.done;o=r.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}}})},t.prototype.error=function(e){var t=this;xp(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})},t.prototype.complete=function(){var e=this;xp(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,i=n.hasError,r=n.isStopped,o=n.observers;return i||r?Tp:(this.currentObservers=null,o.push(e),new Sp(function(){t.currentObservers=null,wp(o,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,i=t.thrownError,r=t.isStopped;n?e.error(i):r&&e.complete()},t.prototype.asObservable=function(){var e=new Mp;return e.source=this,e},t.create=function(e,t){return new Vp(e,t)},t}(Mp),Vp=function(e){function t(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return hp(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Tp},t}(qp),Hp=(function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}hp(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,i=e._value;if(t)throw n;return this._throwIfClosed(),i},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)}}(qp),function(){return Date.now()}),Wp=function(e){function t(t,n){return e.call(this)||this}return hp(t,e),t.prototype.schedule=function(e,t){return this},t}(Sp),Kp=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return hp(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setInterval.apply(void 0,gp([e,t],mp(n)))}(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&function(e){clearInterval(e)}(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,i=!1;try{this.work(e)}catch(e){i=!0,n=e||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,i=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,wp(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(Wp),Gp=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Hp,e}(),Jp=function(e){function t(t,n){void 0===n&&(n=Gp.now);var i=e.call(this,t,n)||this;return i.actions=[],i._active=!1,i}return hp(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Gp);function $p(e){return function(e){return e&&yp(e.schedule)}(function(e){return e[e.length-1]}(e))?e.pop():void 0}new Jp(Kp);var Qp=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Yp(e){return yp(null==e?void 0:e.then)}function Xp(e){return yp(e[Dp])}function Zp(e){return Symbol.asyncIterator&&yp(null==e?void 0:e[Symbol.asyncIterator])}function ef(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var tf="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function nf(e){return yp(null==e?void 0:e[tf])}function rf(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,l)}}),i[Symbol.asyncIterator]=function(){return this},i;function a(e,t){r[e]&&(i[e]=function(t){return new Promise(function(n,i){o.push([e,t,n,i])>1||s(e,t)})},t&&(i[e]=t(i[e])))}function s(e,t){try{!function(e){e.value instanceof vp?Promise.resolve(e.value.v).then(c,l):u(o[0][2],e)}(r[e](t))}catch(e){u(o[0][3],e)}}function c(e){s("next",e)}function l(e){s("throw",e)}function u(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}(this,arguments,function(){var t,n,i;return pp(this,function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,vp(t.read())];case 3:return n=r.sent(),i=n.value,n.done?[4,vp(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,vp(i)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function of(e){return yp(null==e?void 0:e.getReader)}function af(e){if(e instanceof Mp)return e;if(null!=e){if(Xp(e))return function(e){return new Mp(function(t){var n=e[Dp]();if(yp(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Qp(e))return function(e){return new Mp(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Yp(e))return function(e){return new Mp(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,Pp)})}(e);if(Zp(e))return sf(e);if(nf(e))return function(e){return new Mp(function(t){var n,i;try{for(var r=fp(e),o=r.next();!o.done;o=r.next()){var a=o.value;if(t.next(a),t.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}t.complete()})}(e);if(of(e))return function(e){return sf(rf(e))}(e)}throw ef(e)}function sf(e){return new Mp(function(t){(function(e,t){var n,i,r,o;return function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,s)}c((i=i.apply(e,t||[])).next())})}(this,void 0,void 0,function(){var a,s;return pp(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=fp(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,r){!function(e,t,n,i){Promise.resolve(i).then(function(t){e({value:t,done:n})},t)}(i,r,(t=e[n](t)).done,t.value)})}}}(e),c.label=1;case 1:return[4,n.next()];case 2:if((i=c.sent()).done)return[3,4];if(a=i.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=c.sent(),r={error:s},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}function cf(e,t,n,i,r){void 0===i&&(i=0),void 0===r&&(r=!1);var o=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(o),!r)return o}function lf(e,t){return void 0===t&&(t=0),jp(function(n,i){n.subscribe(Fp(i,function(n){return cf(i,e,function(){return i.next(n)},t)},function(){return cf(i,e,function(){return i.complete()},t)},function(n){return cf(i,e,function(){return i.error(n)},t)}))})}function uf(e,t){return void 0===t&&(t=0),jp(function(n,i){i.add(e.schedule(function(){return n.subscribe(i)},t))})}function df(e,t){if(!e)throw new Error("Iterable cannot be null");return new Mp(function(n){cf(n,t,function(){var i=e[Symbol.asyncIterator]();cf(n,t,function(){i.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function hf(e,t){return t?function(e,t){if(null!=e){if(Xp(e))return function(e,t){return af(e).pipe(uf(t),lf(t))}(e,t);if(Qp(e))return function(e,t){return new Mp(function(n){var i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}(e,t);if(Yp(e))return function(e,t){return af(e).pipe(uf(t),lf(t))}(e,t);if(Zp(e))return df(e,t);if(nf(e))return function(e,t){return new Mp(function(n){var i;return cf(n,t,function(){i=e[tf](),cf(n,t,function(){var e,t,r;try{t=(e=i.next()).value,r=e.done}catch(e){return void n.error(e)}r?n.complete():n.next(t)},0,!0)}),function(){return yp(null==i?void 0:i.return)&&i.return()}})}(e,t);if(of(e))return function(e,t){return df(rf(e),t)}(e,t)}throw ef(e)}(e,t):af(e)}function pf(e,t){return jp(function(n,i){var r=0;n.subscribe(Fp(i,function(n){i.next(e.call(t,n,r++))}))})}function ff(e,t,n){return void 0===n&&(n=1/0),yp(t)?ff(function(n,i){return pf(function(e,r){return t(n,e,i,r)})(af(e(n,i)))},n):("number"==typeof t&&(n=t),jp(function(t,i){return function(e,t,n,i){var r=[],o=0,a=0,s=!1,c=function(){s&&!r.length&&!o&&t.complete()},l=function(e){o++;var s=!1;af(n(e,a++)).subscribe(Fp(t,function(e){t.next(e)},function(){s=!0},void 0,function(){if(s)try{o--;for(var e=function(){var e=r.shift();l(e)};r.length&&o<i;)e();c()}catch(e){t.error(e)}}))};return e.subscribe(Fp(t,function(e){return o<i?l(e):r.push(e)},function(){s=!0,c()})),function(){}}(t,i,e,n)}))}function mf(){return ff(Lp,1)}function gf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return mf()(hf(e,$p(e)))}function vf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=$p(e);return jp(function(t,i){(n?gf(e,t,n):gf(e,t)).subscribe(i)})}function yf(e){return!(typeof e>"u")&&(function(e){var t;return!!e&&e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("track")&&typeof(null==(t=e.publication)?void 0:t.track)<"u"}(e)||function(e){return!!e&&e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&e.hasOwnProperty("publication")&&typeof e.publication<"u"}(e))}function bf(e){if("string"==typeof e||"number"==typeof e)return`${e}`;if(function(e){return!!e&&e.hasOwnProperty("participant")&&e.hasOwnProperty("source")&&typeof e.publication>"u"}(e))return`${e.participant.identity}_${e.source}_placeholder`;if(yf(e))return`${e.participant.identity}_${e.publication.source}_${e.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${e}`)}bp(function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}),Array.isArray,Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var kf=[El.ConnectionStateChanged,El.RoomMetadataChanged,El.ActiveSpeakersChanged,El.ConnectionQualityChanged,El.ParticipantConnected,El.ParticipantDisconnected,El.ParticipantPermissionsChanged,El.ParticipantMetadataChanged,El.ParticipantNameChanged,El.ParticipantAttributesChanged,El.TrackMuted,El.TrackUnmuted,El.TrackPublished,El.TrackUnpublished,El.TrackStreamStateChanged,El.TrackSubscriptionFailed,El.TrackSubscriptionPermissionChanged,El.TrackSubscriptionStatusChanged,El.LocalTrackPublished,El.LocalTrackUnpublished],wf=(Pl.TrackPublished,Pl.TrackUnpublished,Pl.TrackMuted,Pl.TrackUnmuted,Pl.TrackStreamStateChanged,Pl.TrackSubscribed,Pl.TrackUnsubscribed,Pl.TrackSubscriptionPermissionChanged,Pl.TrackSubscriptionFailed,Pl.LocalTrackPublished,Pl.LocalTrackUnpublished,Pl.ConnectionQualityChanged,Pl.IsSpeakingChanged,Pl.ParticipantMetadataChanged,Pl.ParticipantPermissionsChanged,Pl.TrackMuted,Pl.TrackUnmuted,Pl.TrackPublished,Pl.TrackUnpublished,Pl.TrackStreamStateChanged,Pl.TrackSubscriptionFailed,Pl.TrackSubscriptionPermissionChanged,Pl.TrackSubscriptionStatusChanged,Pl.LocalTrackPublished,Pl.LocalTrackUnpublished,up.getLogger("lk-components-js"));wf.setDefaultLevel("WARN");var Sf=(e=>(e.AgentState="lk.agent.state",e.PublishOnBehalf="lk.publish_on_behalf",e.TranscriptionFinal="lk.transcription_final",e.TranscriptionSegmentId="lk.segment_id",e.TranscribedTrackId="lk.transcribed_track_id",e))(Sf||{});function Tf(e){return"object"==typeof e}function Cf(e){return Array.isArray(e)&&e.filter(Tf).length>0}function Ef(e){return`lk-${e}`}function Pf(e){if(yf(e))return e.publication;{const{source:t,name:n,participant:i}=e;if(t&&n)return i.getTrackPublications().find(e=>e.source===t&&e.trackName===n);if(n)return i.getTrackPublicationByName(n);if(t)return i.getTrackPublication(t);throw new Error("At least one of source and name needs to be defined")}}function Rf(e,...t){return new Mp(n=>{const i=()=>{n.next(e)};return t.forEach(t=>{e.on(t,i)}),()=>{t.forEach(t=>{e.off(t,i)})}}).pipe(vf(e))}function xf(e){return function(e,...t){return new Mp(n=>{const i=()=>{n.next(e)};return t.forEach(t=>{e.on(t,i)}),()=>{t.forEach(t=>{e.off(t,i)})}}).pipe(vf(e))}(e,Pl.TrackMuted,Pl.TrackUnmuted,Pl.ParticipantPermissionsChanged,Pl.TrackPublished,Pl.TrackUnpublished,Pl.LocalTrackPublished,Pl.LocalTrackUnpublished,Pl.MediaDevicesError,Pl.TrackSubscriptionStatusChanged).pipe(pf(e=>{const{isMicrophoneEnabled:t,isCameraEnabled:n,isScreenShareEnabled:i}=e,r=e.getTrackPublication(lu.Source.Microphone);return{isCameraEnabled:n,isMicrophoneEnabled:t,isScreenShareEnabled:i,cameraTrack:e.getTrackPublication(lu.Source.Camera),microphoneTrack:r,participant:e}}))}function _f(e,t,n=!0){const i=[e.localParticipant,...Array.from(e.remoteParticipants.values())],r=[];return i.forEach(e=>{t.forEach(t=>{const i=Array.from(e.trackPublications.values()).filter(e=>e.source===t&&(!n||e.track)).map(t=>({participant:e,publication:t,source:t.source}));r.push(...i)})}),{trackReferences:r,participants:i}}var{load:Of,save:If}=function(e){return{load:()=>function(e){if(typeof localStorage>"u")wf.error("Local storage is not available.");else try{const t=localStorage.getItem(e);return t?JSON.parse(t):void wf.warn(`Item with key ${e} does not exist in local storage.`)}catch(e){return void wf.error(`Error getting item from local storage: ${e}`)}}(e),save:t=>function(e,t){if(typeof localStorage>"u")wf.error("Local storage is not available.");else try{if(t){const n=Object.fromEntries(Object.entries(t).filter(([,e])=>""!==e));localStorage.setItem(e,JSON.stringify(n))}}catch(e){wf.error(`Error setting item to local storage: ${e}`)}}(e,t)}}("lk-user-choices");a.createContext(void 0);const Nf=a.createContext(void 0);function Af(e){const t=a.useContext(Nf),n=e??t;if(!n)throw new Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return n}a.createContext(void 0);const Df=a.createContext(void 0);function Lf(e){const t=a.useContext(Df),n=e??t;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}a.createContext(void 0);const Mf=a.createContext(void 0);function Uf(e={}){const t=Lf(e.room),[n,i]=a.useState(t.localParticipant),[r,o]=a.useState(n.isMicrophoneEnabled),[s,c]=a.useState(n.isCameraEnabled),[l,u]=a.useState(n.isScreenShareEnabled),[d,h]=a.useState(n.lastMicrophoneError),[p,f]=a.useState(n.lastCameraError),[m,g]=a.useState(void 0),[v,y]=a.useState(void 0),b=e=>{c(e.isCameraEnabled),o(e.isMicrophoneEnabled),u(e.isScreenShareEnabled),y(e.cameraTrack),g(e.microphoneTrack),h(e.participant.lastMicrophoneError),f(e.participant.lastCameraError),i(e.participant)};return a.useEffect(()=>{const e=xf(t.localParticipant).subscribe(b);return()=>e.unsubscribe()},[t]),{isMicrophoneEnabled:r,isScreenShareEnabled:l,isCameraEnabled:s,microphoneTrack:m,cameraTrack:v,lastMicrophoneError:d,lastCameraError:p,localParticipant:n}}function jf(e={}){const t=function(e={}){const t=Lf(e.room),[n,i]=a.useState([]);return a.useEffect(()=>{const n=function(e,t={}){var n;let i;const r=new Mp(e=>(i=e,()=>a.unsubscribe())).pipe(vf(Array.from(e.remoteParticipants.values()))),o=null!=(n=t.additionalRoomEvents)?n:kf,a=Rf(e,...Array.from(new Set([El.ParticipantConnected,El.ParticipantDisconnected,El.ConnectionStateChanged,...o]))).subscribe(e=>null==i?void 0:i.next(Array.from(e.remoteParticipants.values())));return e.remoteParticipants.size>0&&(null==i||i.next(Array.from(e.remoteParticipants.values()))),r}(t,{additionalRoomEvents:e.updateOnlyOn}).subscribe(i);return()=>n.unsubscribe()},[t,JSON.stringify(e.updateOnlyOn)]),n}(e),{localParticipant:n}=Uf(e);return a.useMemo(()=>[n,...t],[n,t])}function Ff(e=[lu.Source.Camera,lu.Source.Microphone,lu.Source.ScreenShare,lu.Source.ScreenShareAudio,lu.Source.Unknown],t={}){const n=Lf(t.room),[i,r]=a.useState([]),[o,s]=a.useState([]),c=a.useMemo(()=>e.map(e=>Tf(e)?e.source:e),[JSON.stringify(e)]);return a.useEffect(()=>{const e=function(e,t,n){var i,r;const o=null!=(i=n.additionalRoomEvents)?i:kf,a=null==(r=n.onlySubscribed)||r;return Rf(e,...Array.from(new Set([El.ParticipantConnected,El.ParticipantDisconnected,El.ConnectionStateChanged,El.LocalTrackPublished,El.LocalTrackUnpublished,El.TrackPublished,El.TrackUnpublished,El.TrackSubscriptionStatusChanged,...o]).values())).pipe(pf(e=>{const n=_f(e,t,a);return wf.debug(`TrackReference[] was updated. (length ${n.trackReferences.length})`,n),n}),vf(_f(e,t,a)))}(n,c,{additionalRoomEvents:t.updateOnlyOn,onlySubscribed:t.onlySubscribed}).subscribe(({trackReferences:e,participants:t})=>{wf.debug("setting track bundles",e,t),r(e),s(t)});return()=>e.unsubscribe()},[n,JSON.stringify(t.onlySubscribed),JSON.stringify(t.updateOnlyOn),JSON.stringify(e)]),a.useMemo(()=>{if(Cf(e)){const t=function(e,t){const n=new Map;if(Cf(e)){const i=e.filter(e=>e.withPlaceholder).map(e=>e.source);t.forEach(e=>{const t=e.getTrackPublications().map(e=>{var t;return null==(t=e.track)?void 0:t.source}).filter(e=>void 0!==e),r=Array.from(function(e,t){const n=new Set(e);for(const e of t)n.delete(e);return n}(new Set(i),new Set(t)));r.length>0&&n.set(e.identity,r)})}return n}(e,o),n=Array.from(i);return o.forEach(e=>{t.has(e.identity)&&(t.get(e.identity)??[]).forEach(t=>{if(i.find(({participant:n,publication:i})=>e.identity===n.identity&&i.source===t))return;wf.debug(`Add ${t} placeholder for participant ${e.identity}.`);const r={participant:e,source:t};n.push(r)})}),n}return i},[i,o,e])}Sf.AgentState;var Bf,zf={exports:{}};function qf(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=qf(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function Vf(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=qf(e))&&(i&&(i+=" "),i+=t);return i}function Hf(...e){return(...t)=>{for(const n of e)if("function"==typeof n)try{n(...t)}catch(e){console.error(e)}}}function Wf(...e){const t={...e[0]};for(let n=1;n<e.length;n++){const i=e[n];for(const e in i){const n=t[e],r=i[e];"function"==typeof n&&"function"==typeof r&&"o"===e[0]&&"n"===e[1]&&e.charCodeAt(2)>=65&&e.charCodeAt(2)<=90?t[e]=Hf(n,r):t[e]="className"!==e&&"UNSAFE_className"!==e||"string"!=typeof n||"string"!=typeof r?void 0!==r?r:n:Vf(n,r)}}return t}function Kf(e){return void 0!==e}function Gf(...e){return Wf(...e.filter(Kf))}function Jf(e,t){return"processor"===e&&t&&"object"==typeof t&&"name"in t?t.name:"e2ee"===e&&t?"e2ee-enabled":t}!function(){if(Bf)return zf.exports;Bf=1;var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function r(){r.init.call(this)}zf.exports=r,zf.exports.once=function(e,t){return new Promise(function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}f(e,t,o,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&f(e,"error",t,{once:!0})}(e,r)})},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,o,c;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),c=o[t]),void 0===c)c=o[t]=n,++e._eventsCount;else if("function"==typeof c?c=o[t]=i?[n,c]:[c,n]:i?c.unshift(n):c.push(n),(r=s(e))>0&&c.length>r&&!c.warned){c.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=c.length,function(e){console&&console.warn&&console.warn(e)}(l)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=l.bind(i);return r.listener=n,i.wrapFn=r,r}function d(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function f(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function r(o){i.once&&e.removeEventListener(t,r),n(o)})}}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),r.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return s(this)},r.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var l=c.length,u=p(c,l);for(i=0;i<l;++i)n(u[i],this,t)}return!0},r.prototype.addListener=function(e,t){return c(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return c(this,e,t,!0)},r.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,i,r,o,s;if(a(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},r.prototype.listeners=function(e){return d(this,e,!0)},r.prototype.rawListeners=function(e){return d(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},r.prototype.listenerCount=h,r.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},zf.exports}();const $f={connect:!0,audio:!1,video:!1},Qf=a.forwardRef(function(e,t){const{room:n,htmlProps:i}=function(e){const{token:t,serverUrl:n,options:i,room:r,connectOptions:o,connect:s,audio:c,video:l,screen:u,onConnected:d,onDisconnected:h,onError:p,onMediaDeviceFailure:f,onEncryptionError:m,simulateParticipants:g,...v}={...$f,...e};i&&r&&wf.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[y,b]=a.useState(),k=a.useRef(s);a.useEffect(()=>{b(r??new ep(i))},[r,JSON.stringify(i,Jf)]);const w=a.useMemo(()=>{const{className:e}={className:"lk-room-container"};return Wf(v,{className:e})},[v]);return a.useEffect(()=>{if(!y)return;const e=()=>{const e=y.localParticipant;wf.debug("trying to publish local tracks"),Promise.all([e.setMicrophoneEnabled(!!c,"boolean"!=typeof c?c:void 0),e.setCameraEnabled(!!l,"boolean"!=typeof l?l:void 0),e.setScreenShareEnabled(!!u,"boolean"!=typeof u?u:void 0)]).catch(e=>{wf.warn(e),null==p||p(e)})},t=(e,t)=>{const n=Cl.getFailure(e);null==f||f(n,t)},n=e=>{null==m||m(e)},i=e=>{null==h||h(e)},r=()=>{null==d||d()};return y.on(El.SignalConnected,e).on(El.MediaDevicesError,t).on(El.EncryptionError,n).on(El.Disconnected,i).on(El.Connected,r),()=>{y.off(El.SignalConnected,e).off(El.MediaDevicesError,t).off(El.EncryptionError,n).off(El.Disconnected,i).off(El.Connected,r)}},[y,c,l,u,p,m,f,d,h]),a.useEffect(()=>{if(y){if(g)return void y.simulateParticipants({participants:{count:g},publish:{audio:!0,useRealTracks:!0}});if(s){if(k.current=!0,wf.debug("connecting"),!t)return void wf.debug("no token yet");if(!n)return wf.warn("no livekit url provided"),void(null==p||p(Error("no livekit url provided")));y.connect(n,t,o).catch(e=>{wf.warn(e),!0===k.current&&(null==p||p(e))})}else wf.debug("disconnecting because connect is false"),k.current=!1,y.disconnect()}},[s,t,JSON.stringify(o),y,p,n,g]),a.useEffect(()=>{if(y)return()=>{wf.info("disconnecting on onmount"),y.disconnect()}},[y]),{room:y,htmlProps:w}}(e);return a.createElement("div",{ref:t,...i},n&&a.createElement(Df.Provider,{value:n},a.createElement(Mf.Provider,{value:e.featureFlags},e.children)))});function Yf(e,t={}){const[n,i]=a.useState(Pf(e)),[r,o]=a.useState(null==n?void 0:n.isMuted),[s,c]=a.useState(null==n?void 0:n.isSubscribed),[l,u]=a.useState(null==n?void 0:n.track),[d,h]=a.useState("landscape"),p=a.useRef(),{className:f,trackObserver:m}=a.useMemo(()=>function(e){const t=Pf(e),n=xf(e.participant).pipe(pf(()=>Pf(e)),vf(t));return{className:Ef(e.source===lu.Source.Camera||e.source===lu.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}(e),[e.participant.sid??e.participant.identity,e.source,yf(e)&&e.publication.trackSid]);return a.useEffect(()=>{const e=m.subscribe(e=>{wf.debug("update track",e),i(e),o(null==e?void 0:e.isMuted),c(null==e?void 0:e.isSubscribed),u(null==e?void 0:e.track)});return()=>null==e?void 0:e.unsubscribe()},[m]),a.useEffect(()=>{var n,i;return l&&(p.current&&l.detach(p.current),null!=(n=t.element)&&n.current&&!(e.participant.isLocal&&"audio"===(null==l?void 0:l.kind))&&l.attach(t.element.current)),p.current=null==(i=t.element)?void 0:i.current,()=>{p.current&&(null==l||l.detach(p.current))}},[l,t.element]),a.useEffect(()=>{var e,t;if("number"==typeof(null==(e=null==n?void 0:n.dimensions)?void 0:e.width)&&"number"==typeof(null==(t=null==n?void 0:n.dimensions)?void 0:t.height)){const e=n.dimensions.width>n.dimensions.height?"landscape":"portrait";h(e)}},[n]),{publication:n,isMuted:r,isSubscribed:s,track:l,elementProps:Gf(t.props,{className:f,"data-lk-local-participant":e.participant.isLocal,"data-lk-source":null==n?void 0:n.source,..."video"===(null==n?void 0:n.kind)&&{"data-lk-orientation":d}})}}var Xf,Zf,em=function(){if(Zf)return Xf;Zf=1;var e=/^\s+|\s+$/g,t=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,i=/^0o[0-7]+$/i,r=parseInt,o="object"==typeof rp&&rp&&rp.Object===Object&&rp,a="object"==typeof self&&self&&self.Object===Object&&self,s=o||a||Function("return this")(),c=Object.prototype.toString,l=Math.max,u=Math.min,d=function(){return s.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function p(o){if("number"==typeof o)return o;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(o))return NaN;if(h(o)){var a="function"==typeof o.valueOf?o.valueOf():o;o=h(a)?a+"":a}if("string"!=typeof o)return 0===o?o:+o;o=o.replace(e,"");var s=n.test(o);return s||i.test(o)?r(o.slice(2),s?2:8):t.test(o)?NaN:+o}return Xf=function(e,t,n){var i,r,o,a,s,c,f=0,m=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=i,o=r;return i=r=void 0,f=t,a=e.apply(o,n)}function b(e){var n=e-c;return void 0===c||n>=t||n<0||g&&e-f>=o}function k(){var e=d();if(b(e))return w(e);s=setTimeout(k,function(e){var n=t-(e-c);return g?u(n,o-(e-f)):n}(e))}function w(e){return s=void 0,v&&i?y(e):(i=r=void 0,a)}function S(){var e=d(),n=b(e);if(i=arguments,r=this,c=e,n){if(void 0===s)return function(e){return f=e,s=setTimeout(k,t),m?y(e):a}(c);if(g)return s=setTimeout(k,t),y(c)}return void 0===s&&(s=setTimeout(k,t)),a}return t=p(t)||0,h(n)&&(m=!!n.leading,o=(g="maxWait"in n)?l(p(n.maxWait)||0,t):o,v="trailing"in n?!!n.trailing:v),S.cancel=function(){void 0!==s&&clearTimeout(s),f=0,i=c=r=s=void 0},S.flush=function(){return void 0===s?a:w(d())},S},Xf}();const tm=op(em);const nm=a.forwardRef(function({onTrackClick:e,onClick:t,onSubscriptionStatusChanged:n,trackRef:i,manageSubscription:r,...o},s){const c=Af(i),l=a.useRef(null);a.useImperativeHandle(s,()=>l.current);const u=function({threshold:e=0,root:t=null,rootMargin:n="0%",freezeOnceVisible:i=!1,initialIsIntersecting:r=!1,onChange:o}={}){var s;const[c,l]=(0,a.useState)(null),[u,d]=(0,a.useState)(()=>({isIntersecting:r,entry:void 0})),h=(0,a.useRef)();h.current=o;const p=(null==(s=u.entry)?void 0:s.isIntersecting)&&i;(0,a.useEffect)(()=>{if(!c||!("IntersectionObserver"in window)||p)return;const i=new IntersectionObserver(e=>{const t=Array.isArray(i.thresholds)?i.thresholds:[i.thresholds];e.forEach(e=>{const n=e.isIntersecting&&t.some(t=>e.intersectionRatio>=t);d({isIntersecting:n,entry:e}),h.current&&h.current(n,e)})},{threshold:e,root:t,rootMargin:n});return i.observe(c),()=>{i.disconnect()}},[c,JSON.stringify(e),t,n,p,i]);const f=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e;!c&&null!=(e=u.entry)&&e.target&&!i&&!p&&f.current!==u.entry.target&&(f.current=u.entry.target,d({isIntersecting:r,entry:void 0}))},[c,u.entry,i,p,r]);const m=[l,!!u.isIntersecting,u.entry];return m.ref=m[0],m.isIntersecting=m[1],m.entry=m[2],m}({root:l.current}),[d]=function(e){const t=e instanceof Function?e():e,[n,i]=(0,a.useState)(t),r=(0,a.useRef)(t),o=function(e,t=500,n){const i=(0,a.useRef)();!function(e){const t=(0,a.useRef)(e);t.current=e,(0,a.useEffect)(()=>()=>{t.current()},[])}(()=>{i.current&&i.current.cancel()});const r=(0,a.useMemo)(()=>{const r=tm(e,t,n),o=(...e)=>r(...e);return o.cancel=()=>{r.cancel()},o.isPending=()=>!!i.current,o.flush=()=>r.flush(),o},[e,t,n]);return(0,a.useEffect)(()=>{i.current=tm(e,t,n)},[e,t,n]),r}(i,3e3,void 0);return((e,t)=>e===t)(r.current,t)||(o(t),r.current=t),[n,o]}(u);a.useEffect(()=>{r&&c.publication instanceof Xh&&!1===(null==d?void 0:d.isIntersecting)&&!1===(null==u?void 0:u.isIntersecting)&&c.publication.setSubscribed(!1)},[d,c,r]),a.useEffect(()=>{r&&c.publication instanceof Xh&&!0===(null==u?void 0:u.isIntersecting)&&c.publication.setSubscribed(!0)},[u,c,r]);const{elementProps:h,publication:p,isSubscribed:f}=Yf(c,{element:l,props:o});return a.useEffect(()=>{null==n||n(!!f)},[f,n]),a.createElement("video",{ref:l,...h,muted:!0,onClick:n=>{null==t||t(n),null==e||e({participant:null==c?void 0:c.participant,track:p})}})}),im=a.forwardRef(function({trackRef:e,onSubscriptionStatusChanged:t,volume:n,...i},r){const o=Af(e),s=a.useRef(null);a.useImperativeHandle(r,()=>s.current);const{elementProps:c,isSubscribed:l,track:u,publication:d}=Yf(o,{element:s,props:i});return a.useEffect(()=>{null==t||t(!!l)},[l,t]),a.useEffect(()=>{void 0===u||void 0===n||(u instanceof qh?u.setVolume(n):wf.warn("Volume can only be set on remote audio tracks."))},[n,u]),a.useEffect(()=>{void 0===d||void 0===i.muted||(d instanceof Xh?d.setEnabled(!i.muted):wf.warn("Can only call setEnabled on remote track publications."))},[i.muted,d,u]),a.createElement("audio",{ref:s,...c})});function rm({room:e,volume:t,muted:n}){const i=Ff([lu.Source.Microphone,lu.Source.ScreenShareAudio,lu.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0,room:e}).filter(e=>!e.participant.isLocal&&e.publication.kind===lu.Kind.Audio);return a.createElement("div",{style:{display:"none"}},i.map(e=>a.createElement(im,{key:bf(e),trackRef:e,volume:t,muted:n})))}const om=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},am=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim(),sm=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var cm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const lm=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:o,iconNode:s,...c},l)=>(0,a.createElement)("svg",{ref:l,...cm,width:t,height:t,stroke:e,strokeWidth:i?24*Number(n)/Number(t):n,className:am("lucide",r),...!o&&!sm(c)&&{"aria-hidden":"true"},...c},[...s.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(o)?o:[o]])),um=(e,t)=>{const n=(0,a.forwardRef)(({className:n,...i},r)=>{return(0,a.createElement)(lm,{ref:r,iconNode:t,className:am(`lucide-${o=om(e),o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...i});var o});return n.displayName=om(e),n},dm=um("mic-off",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]]),hm=um("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]),pm=um("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),fm=um("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function mm(e){var t,n;let{participant:i}=e;const r=Ff([{source:lu.Source.Camera,withPlaceholder:!0},{source:lu.Source.ScreenShare,withPlaceholder:!1}],{onlySubscribed:!1}).filter(e=>e.participant.identity===i.identity),o=r.find(e=>{var t;return e.source===lu.Source.ScreenShare&&(null===(t=e.publication)||void 0===t?void 0:t.track)}),s=r.find(e=>{var t;return e.source===lu.Source.Camera&&(null===(t=e.publication)||void 0===t?void 0:t.track)}),c=o||s,l=i.isSpeaking,u=!i.isMicrophoneEnabled;return a.createElement("div",{className:"\n        vp-relative vp-overflow-hidden md:vp-rounded-lg vp-bg-gradient-to-br vp-from-slate-800 vp-to-slate-900 vp-transition-all vp-duration-300 vp-ease-out\n        ".concat(l&&"vp-ring-2 vp-ring-emerald-400 vp-ring-offset-2 vp-ring-offset-slate-950","\n      ")},null!=c&&null!==(t=c.publication)&&void 0!==t&&t.track?a.createElement(nm,{trackRef:c,className:"vp-w-full vp-h-full vp-object-cover"}):a.createElement("div",{className:"vp-w-full vp-h-full vp-flex vp-items-center vp-justify-center vp-bg-gradient-to-br vp-from-slate-700 vp-to-slate-800"},a.createElement("div",{className:"vp-w-20 vp-h-20 vp-rounded-full vp-bg-gradient-to-br vp-from-indigo-500 vp-to-purple-600 vp-flex vp-items-center vp-justify-center vp-text-white vp-text-2xl vp-font-semibold vp-shadow-xl"},(null===(n=i.identity)||void 0===n||null===(n=n.charAt(0))||void 0===n?void 0:n.toUpperCase())||"U")),a.createElement("div",{className:"vp-absolute vp-bottom-0 vp-left-0 vp-right-0 vp-p-2 vp-flex vp-items-center vp-justify-end"},u&&a.createElement("div",{className:"vp-p-1.5 vp-bg-red-500/80 vp-backdrop-blur-sm vp-rounded-lg"},a.createElement(dm,{size:14,className:"vp-text-white"})),l&&!u&&a.createElement("div",{className:"vp-p-1.5 vp-bg-emerald-500/80 vp-backdrop-blur-sm vp-rounded-lg vp-animate-pulse"},a.createElement(hm,{size:14,className:"vp-text-white"}))))}function gm(){const e=jf(),{localParticipant:t}=Uf(),n=e.filter(e=>e.identity!==(null==t?void 0:t.identity)),i=n.length<=2?"vp-grid-cols-1":n.length<=4?"vp-grid-cols-2":n.length<=6?"vp-grid-cols-3":"vp-grid-cols-4";return 0===n.length?a.createElement("div",{className:"vp-w-full vp-h-full vp-flex vp-items-center vp-justify-center vp-bg-black md:vp-rounded-lg md:vp-shadow-lg"},a.createElement("div",{className:"vp-relative vp-w-16 vp-h-16 vp-rounded-full vp-object-cover"},a.createElement("div",{className:"vp-absolute vp-inset-0 vp-animate-spin vp-rounded-full vp-border-4 vp-border-t-white vp-border-r-transparent vp-border-b-transparent vp-border-l-transparent"}))):a.createElement("div",{className:"vp-w-full vp-h-full vp-grid ".concat(i," vp-auto-rows-fr md:vp-rounded-lg md:vp-shadow-lg")},n.map(e=>a.createElement(mm,{key:e.identity,participant:e})))}function vm(e){let{onLeave:t}=e;const{isMuted:n,toggleMute:i}=function(){const{localParticipant:e}=Uf(),[t,n]=(0,a.useState)(!0),i=(0,a.useCallback)(async()=>{e&&(await e.setMicrophoneEnabled(t),n(!t))},[e,t]);return{isMuted:t,toggleMute:i}}();return a.createElement("div",{className:"vp-absolute vp-top-4 vp-left-0 vp-right-0 vp-w-full vp-flex vp-flex-row vp-items-center vp-justify-between vp-gap-2 vp-px-4 vp-z-10"},a.createElement("div",{className:"vp-w-full vp-flex vp-flex-row vp-items-center vp-gap-2"},a.createElement("img",{src:ar+"default.jpg",alt:"avatar",crossOrigin:"anonymous",className:"vp-w-10 vp-h-10 vp-rounded-full"}),a.createElement("span",{className:"vp-text-white vp-text-lg vp-font-bold"},"Agent")),a.createElement("div",{className:"vp-flex vp-flex-row vp-items-center vp-gap-4"},a.createElement("div",{className:"vp-text-white vp-text-base vp-font-bold vp-tracking-widest vp-bg-pink-500 vp-rounded-sm vp-px-2 vp-py-1"},"LIVE"),a.createElement(pm,{size:30,className:"vp-text-white vp-cursor-pointer",onClick:t}),a.createElement("div",{className:"vp-absolute vp-top-20 vp-right-4 vp-z-10"},n?a.createElement(dm,{size:30,onClick:i,className:"vp-text-white vp-cursor-pointer"}):a.createElement(hm,{size:30,onClick:i,className:"vp-text-white vp-cursor-pointer"}))))}function ym(e){let{message:t,setMessage:n,sendMessage:i}=e;return a.createElement("div",{className:"vp-absolute vp-bottom-10 vp-right-0 vp-w-full vp-flex vp-flex-row vp-items-center vp-justify-between vp-gap-2 vp-px-4"},a.createElement("input",{type:"text",value:t,onChange:e=>n(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),i())},placeholder:"Add a comment...",className:"vp-w-full vp-px-4 vp-py-2 vp-rounded-full vp-border vp-outline-none vp-text-base vp-text-white vp-bg-transparent"}),a.createElement(fm,{size:24,onClick:i,className:"vp-text-white vp-cursor-pointer"}))}function bm(e){let{messages:t,messagesRef:n,offset:i}=e;return a.createElement("div",{className:"vp-absolute vp-left-[16px] vp-right-0 vp-z-10 vp-flex vp-flex-col vp-justify-end vp-w-[calc(100%-70px)]",style:{bottom:"".concat(90+i,"px"),height:"calc(100% - ".concat(160+i,"px)")}},a.createElement("div",{className:"vp-w-full vp-flex vp-flex-col vp-items-start vp-gap-2 vp-overflow-y-auto vp-break-words vp-scrollbar-none"},t.map((e,t)=>a.createElement("div",{key:t,className:"vp-w-full vp-flex vp-flex-row vp-gap-2"},a.createElement("img",{src:e.username===sr?ar+"default.jpg":ar+e.avatar,alt:"avatar",crossOrigin:"anonymous",className:"vp-w-10 vp-h-10 vp-rounded-full"}),a.createElement("div",{className:"vp-flex vp-flex-col"},a.createElement("span",{className:"vp-text-white vp-text-sm vp-font-bold"},e.username),a.createElement("span",{className:"vp-inline-block vp-text-white vp-text-base vp-break-all"},e.text)))),a.createElement("div",{ref:n})))}function km(e){let{onLeave:t}=e;const n=function(){const e=a.useContext(Df);if(!e)throw Error("tried to access room context outside of livekit room component");return e}(),i=jf(),{localParticipant:r}=Uf(),[o,s]=(0,a.useState)(0),[c,l]=(0,a.useState)(""),[u,d]=(0,a.useState)([]),h=(0,a.useRef)(null),p=(0,a.useRef)(!1);(0,a.useEffect)(()=>{const e=i.filter(e=>e.identity!==(null==r?void 0:r.identity));e.length>0&&(p.current=!0),p.current&&0===e.length&&t()},[i,r,t]),(0,a.useEffect)(()=>{if(navigator.virtualKeyboard){navigator.virtualKeyboard.overlaysContent=!0;const e=e=>{const t=e.targetRect||e.target&&e.target.boundingRect;if(t){const{x:e,y:n,width:i,height:r}=t;console.log(e,n,i,r),s(r>0?r:0)}};return navigator.virtualKeyboard.addEventListener("geometrychange",e),()=>{navigator.virtualKeyboard.removeEventListener("geometrychange",e)}}if(window.visualViewport){const e=()=>{setTimeout(()=>{window.scrollTo(0,0)},100),s(window.innerHeight-window.visualViewport.height)};return window.visualViewport.addEventListener("resize",e),e(),()=>{window.visualViewport.removeEventListener("resize",e)}}},[]),(0,a.useEffect)(()=>{f()},[u]),(0,a.useEffect)(()=>{if(!n)return;const e=(e,t,n)=>{try{const t=(new TextDecoder).decode(e),n=JSON.parse(t);"chat"===n.type&&d(e=>[...e,{username:n.username||"Anonymous",avatar:n.avatar||"default.jpg",text:n.text}])}catch(e){console.error("Failed to parse chat message",e)}};return n.on("dataReceived",e),()=>{n.off("dataReceived",e)}},[n]);const f=()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},m=(0,a.useCallback)(async()=>{if(!c.trim()||!n)return;const e={type:"chat",username:sr,avatar:"default.jpg",text:c.trim()},t=(new TextEncoder).encode(JSON.stringify(e));try{await n.localParticipant.publishData(t,ma.RELIABLE),d(e=>[...e,{username:sr,avatar:"default.jpg",text:c.trim()}]),l("")}catch(e){console.error("Failed to send message",e),$.error("Failed to send message")}},[c,n]);return a.createElement(a.Fragment,null,a.createElement(rm,null),a.createElement(gm,null),a.createElement(vm,{onLeave:t}),a.createElement(ym,{message:c,setMessage:l,sendMessage:m}),a.createElement(bm,{messages:u,messagesRef:h,offset:o}))}function wm(e){let{token:t,onLeave:n}=e;const i={audioCaptureDefaults:{noiseSuppression:!0,echoCancellation:!0,autoGainControl:!0,sampleRate:48e3,channelCount:1},videoCaptureDefaults:{resolution:{width:1280,height:720,frameRate:30}},adaptiveStream:!0,dynacast:!0,publishDefaults:{audioPreset:Kl.speech,dtx:!0,red:!0}};return a.createElement("div",{className:"vp-fixed vp-bottom-0 md:vp-bottom-5 vp-right-0 md:vp-right-5 vp-z-[9999] vp-w-full md:vp-w-[360px] vp-h-full md:vp-h-[812px] vp-flex vp-flex-col"},a.createElement(Qf,{serverUrl:"wss://viewpro-uk61riwz.livekit.cloud",token:t,connect:!0,video:!1,audio:!1,options:i,className:"vp-relative vp-w-full vp-h-full md:vp-h-[720px]"},a.createElement(km,{onLeave:n})),a.createElement("div",{className:"vp-h-[92px] vp-hidden md:vp-flex vp-items-center vp-justify-center vp-self-end"},a.createElement("div",{onClick:n,className:"vp-w-16 vp-h-16 vp-flex vp-items-center vp-justify-center vp-bg-black vp-rounded-full vp-shadow-lg vp-cursor-pointer"},a.createElement(pm,{size:30,className:"vp-text-white"}))))}function Sm(){const[e,t]=(0,a.useState)(!1),[n,i]=(0,a.useState)(null);return e?a.createElement(wm,{token:n,onLeave:()=>{i(null),t(!1)}}):a.createElement(lr,{onJoin:async()=>{const e="viewpro-room-"+Date.now().toString();try{t(!0);const{data:n}=await cr.get("/livekit/token",{params:{room:e,username:sr}});i(n.token),await cr.post("/call/request",{callerName:sr,roomName:e})}catch(e){console.error("Failed to fetch token"),$.error("Failed to fetch token")}}})}var Tm=n(697),Cm={};Cm.styleTagTransform=b(),Cm.setAttributes=m(),Cm.insert=p().bind(null,"head"),Cm.domAPI=d(),Cm.insertStyleElement=v(),l()(Tm.A,Cm),Tm.A&&Tm.A.locals&&Tm.A.locals;const Em=function(){return a.createElement("main",null,a.createElement(Sm,null),a.createElement(ye,null))},Pm=()=>{let e;try{e=window.top&&window.top!==window?window.top.document:document}catch(t){e=document}let t=e.getElementById("viewpro-widget");if(!t){if(!e.body)return void console.warn("ViewProWidget: Document body not ready yet");t=e.createElement("div"),t.id="viewpro-widget",e.body.appendChild(t)}t?(0,s.createRoot)(t).render(a.createElement(Em,null)):console.error("ViewProWidget element not found")},Rm=()=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Pm):Pm()};Rm();const xm={render:Rm};return i})());